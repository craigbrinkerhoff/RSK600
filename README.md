# Developing and validating the BIKER algorithm

This repo is for developing and validating a model to remotely sense the gas exchange velocity via satellite observations made by the NASA/CNES/UKSA/CSA SWOT satellite. The model is called BIKER, or the 'Bayesian Inference/Inversion of the k600 Rate' algorithm. This project is a work in progress but is completely reproducible and will generate all results (and the manuscript) by following the directions below. The manuscript generated by this repo is currently in preperation for submission.

Note that the actual algorithm is written as an R package and available at https://github.com/craigbrinkerhoff/BIKER. It is called directly in this project's validation workflow.

## Notes
- This workflow is optimized for running parallel processes on an HPC cluster. If you run into problems running it on a local machine, don't say I didn't warn you! <br>
- You need to have the R library 'ProjectTemplate' already installed to run this code. Also check out the other required libraries at '~/config/global.dcf' <br>
- User specific inputs are at '~/lib/inputs.R'. Here is where you can change the number of cores requested to run the parallel processes on.

## To run validation
- The gas exchange model is developed and validated via the '~src/swot_k_model.R'. This script is run independently of the algorithm validation (detailed next) and is not optimized for an HPC cluster. To run this script, simply set the working directory at the top of the file to this repo and execute it. Note that the 'Brinkerhoff etal 2019' dataset needed to run some of this analysis is not included here as it is too large to store on Git. See that study, and then specify the correct file paths for these two files. All other file paths are relative to this repo and should not need to be changed. <br>
- To run the algorithm validation, set working directory to '~/RSK600/'. Then, execute 'run.sh' as a bash script. Options for how this job is submitted are stored in that file as well and are up to the user.

## To generate manuscript
The manuscript for this project is under development and written in RMarkdown. The most recent version is stored in the main directory, while old versions are stored in '~/docs/'. To generate the manuscript, just run 'generateMS.R'. This will draw all figures and results from the analysis outputs in order to have 100% reproducibility. Note that it can only be generated on an HPC if pandoc is installed.

## Questions
Feel free to reach out at cbrinkerhoff[at]umass[dot]edu!