---
title: "Potential for remotely sensing riverine gas exchange and carbon efflux from SWOT observations"
author: 'CB Brinkerhoff, CJ Gleason, PA Raymond, MH Harlan'
date: "`r Sys.Date()`"
bibliography: References.bib
csl: rse_citation_style.csl
output:
  word_document: 
      reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Highlights (3-5 points, 85 characters each w/ spaces)
- The SWOT satellite should be able to indirectly remotely sense riverine gas exchange velocity
- The BIKER algorithm predicts $CO_2$ fluxes when coupled with in situ gas concentration data
- Predicted BIKER $CO_2$ fluxes compare well with in-situ methods
- Expected SWOT measurement errors exert a marginal influence on BIKER's estimates
- Errors are dominated by process-level uncertainties, not parameter inversion

##Keywords
gas exchange, SWOT, remote sensing, carbon, ungauged basin, biogeochemistry

##Abstract
Go BIKER!!
max 400 words
x
x
x
x
x
x
x
x
x

##1 Introduction
Inland waters transport and transform various constiutents as they move from the landscape to the ocean [@colePlumbingGlobalCarbon2007a]. **Too big a jump. What is the journal? ‘constituents’ will need to be defined, as will ‘processes’**As a result some of these processes, rivers and lakes are usually supersaturated with dissolved greenhouse gases (GHGs) and thus present a significant flux of these gases from water to air [@raymondGlobalCarbonDioxide2013a]. This flux $[M/L^2T]$ is expressed as equation 1 given the gas concentration gradient between the water $C_{water} [M/L^3]$ and the air $C_{air} [M/L^3]$ and the gas exchange velocity $k [L/T]$. Note that *k* is generally studied as normalized by a Schmidt number of 600 ($k_{600}$) to be gas and temperature agnostic [see @hallGasExchangeStreams2020 for a thorough review of gas exchange in rivers].

$$Flux=k(C_{water}-C_{air}) \mathbf{(1)}$$

To directly measure $k_{600}$ in a given stream, scientists use a range of methods mostly involving floating domes or eddy covariance towers to measure at a point in the river, or using injections of tracer gases to estimate reach-scale gas exchange [again, see @hallGasExchangeStreams2020]. Obiously, these types of of measuremnets are preferred but are infeasible when working at the network-scale across potentially tens of thousands of rivers, and so upscaling functions are used to predict $k_{600}$ from readily available river geomorphology parameters [e.g. @oconnorMechanismReaerationNatural1958; @palumboAssessingPerformanceReaeration2014; @raymondScalingGasTransfer2012a]. Many upscaling functions are based on the basic theory that *k* is empirically correlated with the turbulent energy dissipation *e* at the air-water interface [@zappaEnvironmentalTurbulentMixing2007]. This is convenient for upscaling because in rivers and streams *e* can be equated to the turbulent energy dissipation rate *eD* $[L^2/T^3]$ [@ulsethDistinctAirWater2019a; @raymondScalingGasTransfer2012a], which is estimated using easily calculated hydraulic parameters: $eD \approx gSV$ where *g* is gravitational acceleration $[L/T^2]$, *S* is channel slope $[L/L]$, and *V* is average flow velocity $[L/T]$ [@tsivoglouTracerMeasurementReaeration1976]. Because channel slope is readily available in any hydrographic data product, most efforts to upscale $k_{600}$ to drainage networks are thereby limited by the quality of the final parameter *V*. Since *V* must be measured in the field or itself estimated by other models/empirical methods, uncertainty in *V* must dominates errors in $k_{600}$ estimates. This is exacerbated in ungauged basins that cover large sections of the earth system, especially in the carbon-rich Arctic inland waters, as no in situ hydraulic information is available and fieldwork is impractical [@gleasonRemoteSensingRiver2020].

To circumvent this problem in ungauged basins and at network-scales, researchers have used ‘global-scope’ hydraulic geometry (HG) models: simple power law relations between in this case *V* and discharge that are trained on extensive hydraulics datasets [@leopoldHydraulicGeometryStream1953a; @borgesVariabilityGasTransfer2004; @horgbyUnexpectedLargeEvasion2019; @lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013a]. However, it has long been established that HG parameters are highly variable across landscapes and from river to river [@gleasonHydraulicGeometryNatural2015; @parkWorldwideVariationsHydraulic1977; @rhodesBfmDiagramGraphical1977]. Because of this, a large body of geomorphology work has attempted to parse out process-based explanations for HG parameters [e.g. @dingmanAnalyticalDerivationAtastation2007b; @parkerPhysicalBasisQuasiuniversal2007b; @singhTHEORIESHYDRAULICGEOMETRY2003a; @fergusonHydraulicsHydraulicGeometry1986a] and an open research question is how to best prescribe a set of HG parameters to a given river (particularly at the global scale). **Xxx give me a sentence or two on the problems with this is approach here. You bury the problem with the sentence “however, it has long” but then cover it up. The transition doesn’t work without closing this paragraph with a supported (i.e. with citations) statement explicitly defining why we can’t do the global scope HG approach. xxx **

A potential alternative to this ‘global-scope’ HG approach is to directly estimate a river’s hydraulic properties (e.g. V) from remote sensing (RS) data. Remote sensing of river hydraulics is a burgeoning subfield within remote sensing of hydrology, typically in service of remote sensing of river discharge (RSQ- see @gleasonRemoteSensingRiver2020 for a thorough review). There are many ways to perform RSQ, from calibrating RS data to local channel hydraulics [e.g. @brakenridgeOrbitalMicrowaveMeasurement2007; @pavelskyUsingWidthbasedRating2014; @pavelskyRemoteSensingSuspended2009; @tarpanelliEstimationRiverDischarge2013] to calibrating hydraulic/hydrologic models with both in situ and RS data [e.g. @bjerklieEstimatingDischargeRivers2005; @chandanpurkarSatelliteReanalysisBasedMass2017; @linGlobalReconstructionNaturalized2019a; @nealDataAssimilationApproach2009] to methods that use no in situ information in their hydraulic/hydrologic models (termed 'ungauged approaches'). Many, but not all, of these ungauged approaches were developed in the context of the upcoming NASA/CNES/UKSA/CSA Surface Water and Ocean Topography (SWOT) satellite mission. **CRAIG: might need to add unaguged citations here or rewrite perspective**

SWOT is expected to launch in 2022 and provide the world’s first global measurements of water surface extent and elevation at novel temporal resolutions. SWOT is a wide swath Ka-band radar interferometer and will sample rivers every 1 to 7 days per 21 day repeat cycle that will measure rivers wider than 100m with a goal of expanding this to rivers at least 50m wide [@biancamariaSWOTMissionIts2016]. A decade of SWOT work has explored the multi-parameter problem of estimating the river hydraulic parameters of roughness and bathymetry from remote sensing to produce the SWOT discharge product [e.g. @andreadisConstrainingAssimilationSWOT2020d; @brinkerhoffConstrainingRemoteRiver2020; @durandEstimatingReachaveragedDischarge2014a; @garamboisInferenceEffectiveRiver2015; @gleasonRetrievalRiverDischarge2014a; @garamboisVariationalEstimationEffective2020; @hagemannBAMBayesianAMHGManning2017a; @larnierRiverDischargeBathymetry2020a; @oubanasDischargeEstimationUngauged2018]. A specific subset of these ungauged methods are termed ‘McFLIs’ or ‘Mass Conserved Flow Law Inversion’ algorithms [e.g. @andreadisConstrainingAssimilationSWOT2020d; @brinkerhoffConstrainingRemoteRiver2020; @hagemannBAMBayesianAMHGManning2017a; @durandEstimatingReachaveragedDischarge2014a]. These use basic geomorphic theories and the concept of ‘prior river knowledge’ to estimate discharge from RS data where not all hydraulic terms are RS-able [@gleasonRemoteSensingRiver2020; @gleasonTrackingRiverFlows2017]. McFLIs are globally flexible, easily implementable in any river that SWOT can sample, and improve our hydrological understandings of ungauged rivers when little to no information was previously available [@brinkerhoffConstrainingRemoteRiver2020; @durandIntercomparisonRemoteSensing2016b]. Recently, McFLIs have also shown promise in providing additional and beneficial information to traditional hydrologic modeling via data assimilation [@ishitsukaCombiningOpticalRemote2020].

While all McFLIs to date have been developed in the context of RSQ, there is no reason their logic cannot be used to estimate $k_{600}$, particularly as McFLIs often employ Bayesian inference for equifinal inverse problems. Equifinality refers to an under-constrained mathematical system that have essentially infinite parameter combinations that can produce the same result: there are in essence more unknowns than equations [@garamboisInferenceEffectiveRiver2015], and this problem is common to both RSQ and $K_{600}$ estimation. Bayesian techniques have been previously used to estimate $k_{600}$ concurrently with stream metabolism from dissolved oxygen ($O_2$) datasets [@applingOvercomingEquifinalityLeveraging2018; @graceFastProcessingDiel2015; @holtgrieveSimultaneousQuantificationAquatic2010]. While these studies are field based and are not applicable to $k_{600}$ estimation in ungauged rivers, they suggest that Bayesian techniques could be useful for remotely sensing $k_{600}$ when parameter equifinality is a problem, which matches McFLI logic precisely [@andreadisConstrainingAssimilationSWOT2020d].

In this context, we hypothesize that a combination of SWOT data, a Bayesian McFLI paradigm, and gas exchange theory can successfully estimate $K_{600}$. This would in turn improve our understanding of riverine GHG fluxes in ungauged basins. Therefore, we developed a method to estimate $k_{600}$ solely from SWOT measurements, using hydrologic model data to produce SWOT-like data as SWOT has not yet launched [standard practice in the SWOT community- e,g, @durandIntercomparisonRemoteSensing2016b]. We hypothesize that remote sensing $k_{600}$ is possible by coupling Bayesian remote sensing techniques (in a manner similar to McFLI) and SWOT data with hydraulic geometry and gas exchange theory. More specifically, this manuscript aims to answer two questions:

- Is ungauged RS of the gas exchange velocity ($K_{600}$) possible using soon-to-be-available SWOT river measurements?
- If possible, how will this RS method change estimates of riverine carbon efflux at network scales?

To answer these questions, we developed a new McFLI algorithm that ingests SWOT data and produces $k_{600}$ estimates and its explicit Bayesian uncertainity that requires no in situ inputs of any kind (although in situ data can be ingested and will improve results). We name the RS of $k_{600}$ algorithm BIKER, or the ‘Bayesian Inversion of the $k_{600}$ Rate’. We validate BIKER on simulated SWOT data for 22 rivers. We also quantify BIKER's sensitivity to the expected SWOT measurement errors: while SWOT data represent a sea change in inland water monitoring, SWOT is expected to have an approximately 10cm error in water surface elevation [@biancamariaSWOTMissionIts2016]. Finally, we use previously published dissolved $CO_2$ data to compare the bulk carbon efflux (via $CO_2$ evasion) from the 22 rivers as calculated using BIKER and previously published in situ techniques to show how BIKER’s $k_{600}$ estimates translate into carbon efflux.

##2 Methods
To build BIKER, we join a process-based model for $k_{o2}$ with a McFLI framework for inverting SWOT measurements (section 2.1). Following the description of that process, we describe the validation (section 2.3) and the workflow for comparing estimated bulk carbon effluxes from a suite of hydraulic geometry models (section 2.4). A flowchart detailing the entire study is given as Figure 1.

![Figure 1. Flowchart of methodology used in this study. We begin by deriving a process-based model for ko2 that uses only river width and slope to assign its parameters (section 2.1). Then, we implement this model within a McFLI ('BIKER') to estimate ko2 solely from river width and water surface slope (section 2.2). Finally, we couple BIKER with in situ CO2 data to compare BIKER-estimated gas fluxes with established in situ methods (section 2.4). See section 2.3 for the validation setup.](cache/flowchart.jpg)

###2.1 Developing BIKER
To use the McFLI framework, a physical model for the parameter of interest is necessary. In this case we need a physical model for *k*. First, we detail which model for *k* we chose to implement, and then we explain how the implementation works.

There is a long tradition of water quality engineers and biogeochemists developing predictive models for different forms of *k*, going back to at least the 1950s [@wangPhysicallyBasedScaling2021]. The goals of these models vary, from predicting oxygen reaeration coefficients to predicting $CO_2$ gas transfer velocities. Most of these models operate under the basic assumption that river channel hydraulics govern gas exchange and so simple statisical relationships can be generated between forms of *k* and hydraulic properties. However, many of them are not rooted in process-based mass transport theory and rather are simply empirical relations. This means that many of these models exist at the mercy of the limited training data available to fit said models and are highly sensitive to which data are used.

Recently, many of these models were rexplored in rivers and streams by @wangPhysicallyBasedScaling2021. They significantly expanded training datasets of field-measured $k_{o_2}$ (*k* for dissolved oxygen DO at 20 degrees Celsius) by using inverse modeling of DO timeseries. This apprroach was briefly mentioned in the introduction of this manuscript. These methods calibrate $k_{o_2}$, along with respiration and primary production, to high-fidelity, in situ datasets of DO with the goal of minimizing the difference between the observed DO and the mass-balance DO [e.g. @applingOvercomingEquifinalityLeveraging2018; @chapraDeltaMethodEstimating1991]. @wangPhysicallyBasedScaling2021 used this technique at 35 rivers across the United States and showed that $k_{o_2}$ models deduced from the classic, process-based 'thin-film' and 'surface renewal' theories yield approximately identical parameters when fit to field measurements or this new dataset of simulated $k_{o_2}$. This suggests that there are uniform scaling realtionships between certain hydraulic properties and $k_{o_2}$ that exist regardless of the training data used. See [@hallGasExchangeStreams2020 and @wangPhysicallyBasedScaling2021] for more in-depth explanations of the thin-film and surface renewal theories with respect to rivers. These are the standard models for understanding gas exchange in many aquatic environments from lakes to esutraries to rivers. The better fit, and more parsimonious, of these two models is reprinted as equations 2 and 3 where $U_\star$ is the shear velocity of the river channel [L/T] ($U_\star = \sqrt{gR_hS_h}$). Equation 2 was fit to field measurements of $k_{o_2}$ while equation 3 was fit to the simulated $k_{o_2}$ for 35 rivers.
$$k_{o2} = 47.67U_\star \mathbf{(2)}$$
$$k_{o2} = 49.71U_\star \mathbf{(3)}$$

This model was implemented in BIKER (using 48 as the approximate parameter across equations 2 and 3) for a few reasons. First, the analysis performed by [@wangPhysicallyBasedScaling2021] provides compelling evidence that a statistical parameter of approximately 48 is uniform across rivers and streams, regardless of the training data used. This is encouraging for use within BIKER as BIKER is specifically designed to be as river-agnostic as possible. Second, it yields a simple linear relationship across all rivers, regardless of their size or steepeness. This is not necessairly true of *k* models based on the turbulent dissipation rate *eD* ($eD=gS_hV$), which is another common approach [@hallGasExchangeStreams2020; e.g. @raymondScalingGasTransfer2012a; @oconnorMechanismReaerationNatural1958; @tsivoglouTracerMeasurementReaeration1976], where recent work has shown that *k* does not scale with $eD$ via the same statistical parameters across all rivers [@ulsethDistinctAirWater2019a]. We further explored the relationship presented in that paper and found that the $k~eD$ relationship fundamentally breaks down in rivers with low *eD*, which corresponds to nearly all rivers that SWOT will observe (**supp figure**). Therefore, an $eD$ based predictive model is of little use in SWOT rivers. Third, we sought to explicitly predict the gas transfer velocity for DO, as its use extends beyond constraining GHG fluxes from rivers. For example **stuff here**. To convert from $k_o2$ to *k* for any other GHG (as will be done later in this manuscript to calculate $CO_2$ evasion fluxes), we use the Schmidt number to convert between water temperatures and gases of interest following equation 4. 530 is the Schmidt number for oxygen at 20 degrees Celsius and *Sc* is the Schmidt number at one's desired temperature for some dissolved gas.
$$k_{GHG, temp}=k_{02}*(Sc/530)^{-1/2} \mathbf{(4)}$$

We stress that most other predictive models for *k* could be implemented within BIKER. However, our goal of using BIKER on any river that is observable by SWOT necessitates that we pick an equation that is applicable across as many rivers as possible. Future work should look at using a river-specific *k* equation to 'calibrate' BIKER to a specific river of interest.

With a predictive model for $k_{o2}$ chosen, we now implement it within a McFLI framework. The approach used here is strongly informed by the @hagemannBAMBayesianAMHGManning2017a McFLI algorithm for ungauged RSQ, further explored in more recent work [@brinkerhoffConstrainingRemoteRiver2020]. These papers conceptualize discharge as a Bayesian remote sensing problem, which we largely follow here to conceptualize $k_{o2}$ as a Bayesian remote sensing problem that can be solved using SWOT data.

First, the model needs to be rewritten as a function of SWOT-observables river width *W* and height (and thus water surface slope $S_h$). SWOT will measure these at approximately 200m intervals in pre-defined mass-conserved river reaches (**What is the PDD?**; SWORD). To do this, we follow @hagemannBAMBayesianAMHGManning2017a to formulate depth via river width and area. Area is further split into the SWOT-observable portion *dA* and the unobservable portion $A_0$ following @durandEstimatingReachaveragedDischarge2014a. $A_0$ is the median channel area and *dA* is the change in channel area. We estimate *dA* by assuming a rectangular river channel so that $dA \approx \delta H*W$ and is also solely a function of SWOT-observables *W* and $S_h$.

**COLIN ABOUT DA: sensitivity analysis? "We investigated the sensitivity of BIKER to this rectangular assumption and found it negligible (xxx section x.x if appropriate xxx)".**

$$k_{o2} = 48*U_\star=48\sqrt{gR_hS_h}=48g^{1/2}S_h^{1/2}(\frac{A_0+dA}{W})^{1/2} \mathbf{(5)}$$
Next, we rework equation 5 into a Bayesian sampling model to have all of the observations (*W* and $S_h$) on the left-hand side sampled from all of the unknown model parameters ($A_0$ and $k_{o_2}$) on the right-hand side. This is equation 6, where *x* are SWOT observables given $\Theta$, a set of statistical parameters. Note that in this formal likelihood specification both sides of equation 6 are log-transformed (natural log) to produce the normal sampling model presented here, however they are written in equation 6 without that transformation for succinctness. The $\sigma_{k_{o2}}^2$ parameter refers to the uncertainty inherent in equation 6's estimates. This will be explained in detail below.

$$f(x|\Theta) = \left[48^{-1}(\frac{W}{gS_h})^{1/2}\right] \sim normal\left(\left[k_{o2}^{-1}(A_0+dA)^{1/2}\right], \sigma^2_{k_{o2}}\right)  \mathbf{(6)}$$

Equation six necessitates that Bayesian priors be assigned to parameters $A_0$ and $k_{o_2}$. Bayesian priors formalize the a priori estimates (and uncertainties) for the non-remotely-sensed parameters. To state that more intuitively for these physical quantities, priors represent our prior river knowledge of what $A_0$ and $k_{o_2}$ probably are for some river given that they cannot be remotely sensed. All priors are formalized within the model as truncated normal distributions of the log-transformed terms such that $log(X) \sim N(\mu, \sigma^2)$ for $\lambda < X < \epsilon$, using prior hyperparameters mean ($\mu$), standard deviation ($\sigma$), and upper ($\epsilon$) and lower bounds ($\lambda$) for parameter *X*. In order to avoid relying on in situ information, we assign prior hyperparameters using SWOT data only. $A_0$ prior hyperparameters were assigned following the method developed by @brinkerhoffConstrainingRemoteRiver2020. They developed a set of river channel prior hyperparameters for McFLI algorithms that are entirely RS-able and reflect differential channel hydraulics as a function of river geomorphology. They used an extensive database of field measurements and machine learning to identify patterns that associate the river width with river geomorphic properties, so these non-remotely sensible properties may be assigned to rivers using only the existing remotely sensed data. This leaves the $k_{o_2}$ hyperparameters to be defined. We assigned the $k_{o_2}$ prior hyperparameters using a simple slope regression model trained on the @raymondScalingGasTransfer2012a dataset to assign $\mu$ (equation 7). $\sigma^2$ was set to the standard error of equation 7: 0.77. $\lambda$ and $\epsilon$ were set to log(0.0001) and log(60), respectively.

$$\mu_{k_{o_2}}=3.3492 +0.3661ln(S_h)   \mathbf{(7)}$$

**FIGURE OUT Finally, we estimate $σ_{k600}^2$ using Monte Carlo (MC) methods to approximate total uncertainty from equation 3. Uncertainty in equation 3 can stem from 1) $a_i$ and $b_i$ parameter uncertainty, 2) error in Manning’s approximation of the average flow velocity, and 3) measurement error. Total equation 3 uncertainty is a function of all three uncertainity sources, so we need to propogate the three uncertanties through the algebra of equation 3. Here, we use MC simulations to do this. MC simulations repeately sample from parameter distributions defined by their individual expectations and uncertainities to produce a distribution of model estimates from which an overall uncertainity term can be extracted. Here, we run 5,000 unique MC simulations on 5,000 sets of field measurements of river channel hydraulics from @brinkerhoffReconcilingAtaStationAtManyStations2019 and use the median uncertainity term across those 5,000 distributions as $\sigma_{k600}$. Each MC simulation is itself 10,000 runs, sampling from the normal distributions for $a_i$, $b_i$, the log-transformed flow velocity, and $S_h$. Uncertainty for velocity followed @hagemannBAMBayesianAMHGManning2017a, who estimated ln-transformed Manning’s equation error in discharge to be 0.25 (we assume that the 0.25 value is due soley from Manning's equation and not measurements of cross-sectional area in order to use here as the velocity error). The slope-error model that we used is explained in detail in Section 2.3 and relies on a recent analysis of expected errors in SWOT $S_h$ measurements [@durandHowWillRadar2020a].**

With the sampling model (equation 4), prior distributions, and the $\sigma_{k_{o_2}}^2$ parameter described, a joint posterior distribution conditional on the SWOT data is obtained. To approximate this distribution, we use a Markov Chain Monte Carlo (MCMC) algorithm. Because it is written in the Stan probabilistic programming language, we use a Hamiltonian Monte Carlo which reduces computation time relative to other sampling algorithms [again following @hagemannBAMBayesianAMHGManning2017a].

###2.3 BIKER validation setup
We validated BIKER on 50 rivers using observed $R_h$ and observed $S_h$ First, we detail the 50 rivers, and then we detail how observed $k_{o_2}$ is calculated.

Because SWOT has yet to launch, it is standard practice to benchmark SWOT-related algorithms on SWOT-like data. There are three current types of SWOT-like data: 1) AirSWOT, which is an airborne Ka-band inSAR currently limited to five rivers globally, 2) simulated rivers that mimic the type of data SWOT will provide, and 3) the SWOT simulator, which introduces measurement errors to these simulated rivers. Because we are principally interested in algorithm performance, we limit our validation setup to simulated rivers in order to benchmark across as many rivers as possible. These simulated rivers are simply reach-averaged hydraulic model outputs where the water surface heights and widths are labelled as RS observations and are used as the sole inputs to the BIKER algorithm. Simulated rivers mimic perfect measurement conditions (i.e. no measurement errors). Here, we use the 50 rivers developed by @frassonExploringFactorsControlling and @durandIntercomparisonRemoteSensing2016b. These are the two benchmarking studies that have explored RSQ algorithm performance for the SWOT mission. Consult both of those papers for maps of the river's locations, though the 50 rivers are spread across the United States, Canada, France, Italy, United Kingdom, India, and Bangladesh. We omitted the Arial Khan river in Bangladesh due to known problems with that hydraulic model **is that sufficient to say?**.

We also assess the influence of measurement error on BIKER's performance. Error in SWOT measurements will come from both the error tolerances intrinsic in the satellite data product as well as radar layover error and width measurement error. Layover error is the phenomenon when radar returns from different places arrive at the sensor at the same time, leading to taller landscape features appearing closer to the sensor than shorter landscape features that are the same horizontal distance from the sensor. This will occur when the landscape slope is steeper than the radar's incidence angle [@durandHowWillRadar2020a] and so generally occurs in areas of high topographic variation [@reesPhysicalPrinciplesRemote2013].

For river heights and slopes, we use the SWOT error model devolped by @durandHowWillRadar2020a and implemented on 16 of the rivers in this study by @frassonExploringFactorsControlling. Systematic height errors are assumed constant across the river but variable in time. Width errors were derived using a model built by @frassonExploringFactorsControlling based on SWOT-simulator runs for the Sacramento and Po rivers. Width errors due to poor water classification are ignored here. Please consult @frassonExploringFactorsControlling for the specifics of how these realistic errors were incorporated into the hydraulic models. Ultimately, we reran BIKER on these 16 rivers with the SWOT error model corrupting the SWOT-observables *W* and *S_h*.

Regardless of the validation data or SWOT error budget used, we do not have observed $k_{o_2}$ data for these rivers, and to our knowledge no field dataset of $k_{o_2}$ exists in the type of temporal and spatial frequency that SWOT (and therefore the BIKER algorithm) provides. Further, we are principally interested in BIKER's ability to reproduce $k_{o_2}$ from SWOT observations and are less concerned with the actual accuracy of the predictive model itself [which can be validated using existing datasets like previously done by @wangPhysicallyBasedScaling2021]. Therefore, we take the model outlined in section 2.1 and use that to calculate the observed $k_{o_2}$ that BIKER is validated against. This is done using equation 8, where $R_{h, obs} [L/T]$ is observed river channel area divided by observed channel width. With this setup, we can directly explore BIKER's ability to infer observed $U_\star$ and $k_{o_2}$ from *W* and $S_h$ alone. It also means that, for a fair validation scheme, $\sigma_{upscale}^2$ must be set to reflect only error from Manning's equation (and not the parameter 48 in equation 8). Thus, $\sigma_{upscale}^2$ is set to 0.25 for this validation. However in practice, it should reflect the total uncertainty calculated in section 2.2 from all three sources.

$$k_{o_2, obs}=48\sqrt{gS_hR_{h, obs}} \mathbf{(8)}$$

Validation metrics take two forms (and are detailed in Table 1). To validate across all rivers and timesteps, we used the coefficient of determination $r^2$ and the root mean square error RMSE. Four normalized metrics were used for by-river validation: RRMSE and NRMSE are normalized root mean square errors that have been normalized by the observed value and the mean observed value (respectively). rBIAS is a measure of prediction bias that is normalized by the mean observed value. KGE is a standard metric used in streamflow prediction with an intuitive basis: a value greater than 0 is often interpreted as a useful prediction in ungauged settings, and a value greater than -0.41 indicates a model outperforms a uniform prediction of the mean observed value [@knobenTechnicalNoteInherent2019a].

*Table 1: Validation metrics used in this study, where r is the correlation coefficient, Nt is number of observations and i is the specific observation. σ refers to the variance of the sample and μ refers to the mean of the sample. As is standard, a carrot accent indicates the predicted value.*

|**Description**|**Acronym**|**Definition**|**Ideal Score**|**Possible Range**|**Validation Scheme**|
|-----------|-------|----------|-----------|--------------|-----------------|
|Coefficient of determination|$r^2$| $1-(\frac{\sum\limits_{i=1}^{N_t}{(k_{600, i}-\hat{k_{600}})^2}}{\sum{(k_{600, i}-\bar{k_{600}})^2}})$ |1|0 to 1|	All rivers and all timesteps|
|Root-mean-square-error|RMSE| $\sqrt{\frac{1}{N_t}\sum\limits_{i=1}^{N_t}(\hat{k_{600, i}}-k_{600, i})^2}$ |0|0 to ∞|All rivers and all timesteps|
|Relative root-mean-square error|RRMSE| $\sqrt{\frac{1}{N_t}\sum\limits_{i=1}^{N_t}(\frac{\hat{k_{600, i}}-k_{600, i}}{k_{600, i}})^2}$ |0|0 to ∞|By river|
|Normalized root-mean-square error|NRMSE| $\sqrt{\frac{1}{N_t}\sum\limits_{i=1}^{N_t}(\frac{\hat{k_{600, i}}-k_{600, i}}{\bar{k_{600, i}}})^2}$ |0|0 to ∞|By river|
|Relative bias|rBIAS| $\frac{1}{N_t}\sum\limits_{i=1}^{N_t}(\frac{\hat{k_{600, i}}-k_{600, i}}{\bar{k_{600, i}}})$ |0|-∞ to ∞|By river|
|Kling-Gupta efficiency|KGE| $1-\sqrt{(r-1)^2 + (\frac{\hat{\sigma_{k600}}}{\sigma_{k600}}-1)^2 + (\frac{\hat{\mu_{k600}}}{\mu_{k600}}-1)^2}$ |1|-∞ to 1|	By river|

###2.4 Upscaling to CO2 evasion and bulk carbon efflux
It is one thing to to predict $k_{o_2}$, but researchers are usually more interested in the gas fluxes from rivers and ultimately the bulk carbon efflux from river to atmosphere. Therefore, we explored 1) the ability of BIKER to reproduce hypothetical carbon dioxide evasion fluxes ($FCO_2$ $[M/L^2T]$) from these 22 rivers, and 2) the sensitivity of the estimated bulk carbon efflux $[M/T]$ via $CO_2$ evasion to the method used to estimate reach averaged flow velocity.

First, we calculated $FCO_2$. To do this, we paired the modeled $k_{CO2}$ values (obtained from $k_{600}$) with field-measurements of water-side $CO_2$ concentrations and water temperatures. 26 bi-weekly samples were made by @beaulieuControlsGasTransfer2012a- Figure S1) at one location in the Ohio River for one calender year from 2008-2009. We paired these 26 values with each 11-day-repeat set of SWOT observations by date, ignoring the timesteps beyond 26 (only ~15% of the SWOT observations were ignored here and we deemed this acceptable). Not all of the SWOT rivers have observations for a full year, and when simulation dates were not available they were assumed to start on January 1st. Note that this $CO_2$ data is for the Ohio River only but was applied to all 22 rivers (which includes multiple sections of the Ohio River- @frassonCompilationHydraulicModels2019a). Because we are exclusively interested in the relative differences between $FCO_2$ estimates and not the raw fluxes themselves, any $CO_2$ data representative of SWOT-observable rivers was deemed acceptable. Atmospheric $CO_2$ was assumed 390 uatm. The Schmidt number, used to backcalculate $k_{CO2}$ from $k_{600}$, was calculated following @raymondScalingGasTransfer2012a and @wanninkhofRelationshipWindSpeed1992a.

Then, we estimated bulk carbon efflux using four models for average flow velocity:  BIKER and three gauge-based HG models previously used for $CO_2$ upscaling [@lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013a; @raymondScalingGasTransfer2012a]. See Table S1 for their definitions. It is worth stressing that the @lauerwaldSpatialPatternsCO22015 model was developed as one of two components of the @raymondGlobalCarbonDioxide2013a model, and so was actually developed by the latter’s authors. The names used here refer to the specific implementation used in each study. For this study, all HG methods use the in-situ discharge record while BIKER does not. This allows us to explore the relative differences in bulk carbon efflux estimates if implementing a wholly ungauged method (BIKER) versus gauged methods (all three HG models). Finally, we express the bulk carbon efflux as the average mass flow rate of carbon (via $CO_2$ evasion) per year from the 22 rivers after accounting for total river surface area.

##3 Results
First, we present the results from the $k_{600}$ upscaling experiment (section 3.1). We then take the best performing upscaling function, implement it within BIKER, and validate it on the 22 SWOT rivers (section 3.2). Finally, we use $k_{600}$ as modeled by both BIKER and gauge-based HG models to compare $FCO_2$ and bulk carbon efflux estimates made using gauged and ungauged methods (section 3.3).

###3.2 Validating the BIKER algorithm
Figure 5a plots the validation results for $k_{600}$ (with no SWOT measurement error) across all 22 rivers and all timesteps. For BIKER, the points are the posterior means while the black lines are the 95% confidence intervals (CIs) for the predictions. $k_{600}$ is strongly correlated with the $k_{600}$ predicted by BIKER. BIKER captures the general magnitude of the predictions and most points fall on or near the 1:1 line. However, the 95% prediction intervals (dashed grey lines) highlight reasonably large residuals for many predictions. Regardless, the RMSE for the BIKER predictions is only `r round(results_3_2_all$rmse,2)` in log10 space (~`r round(10^results_3_2_all$rmse,2)` m/day) across all predictions. Again, this is substantially less than the RMSEs for the upscaling models (Figure 3) and the MC-propogated uncertainties (Figure 4).

![Figure 5. a: Validation of BIKER for 22 SWOT rivers. Black bars are 95% CIs for the modeled values. Grey line is linear regression (and 95% prediction intervals are dashed) and dashed black line is 1:1 line. b: Cumulative density functions (CDFs) of the same results: dashed black line are observed values, green line are BIKER posterior means, and blue lines are BIKER 95% CIs.](cache/validation/validation.jpg)

Figure 5a suggests a flip in the bias of the $k_{600}$ predictions, which is confirmed in Figure 5b. Figure 5b plots the cumulative density functions (CDFs) of observed and predicted $k_{600}$ where the green line is the CDF of the BIKER posterior means and the blue lines are the CDFs of the BIKER posterior 95% CIs. We see, more clearly than in Figure 5a, that the posterior mean is systematically underestimated for values less than the median $k_{600}$ and systemically overestimated for values above the median $k_{600}$. However, the uncertainty in these estimates captures $k_{600}$ very well: nearly the entire observed CDF falls between, on, or just outside of the 95% CIs (Figure 5b). This highlights one benefit of using Bayesian inference to fully propagate all prior uncertainties through to the posterior. In summary, Figure 5 confirms that we improve upon our baseline understanding of $k_{600}$ in these rivers. Put another way, we reasonably capture $k_{600}$ with no in situ information about the river while simultaneously and explicitly accounting for the reasonably large uncertainties inherent in our $k_{600}$ estimates.

Figure 6a plots validation metrics calculated for each river with and without SWOT measurement error. The boxplots are composed of scores for the 22 rivers- see Table 1 for metric definitions. SWOT measurement uncertainties slightly degrade performance in KGE, neglibily degrade rBIAS and RRMSE, and actually improve performance in NRMSE (Figure 6a). Aside from the modest decrease in KGE, we deem that SWOT measurement error does not exert a significant influence on BIKER and so the results presented for the rest of the manuscript assume no measurement error. Median rBIAS is `r round(median(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`, indicating nearly no bias in most rivers’ predictions. However, some rivers are substantially biased in both directions, further supporting the visual evidence in Figure 5 that sometimes BIKER is substantially under/overestimating the magnitude of $k_{600}$ and that this is river-specific. Median KGE is `r round(median(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$kge, na.rm=T),2)`, which is excellent given that absolutely no in situ information is being used to predict $k_{600}$. NRMSE and RMSE have median scores of `r round(median(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$nrmse, na.rm=T),2)` and `r round(median(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$rrmse, na.rm=T),2)`, respectively. While median KGE and rBIAS scores were strong, the ranges of these scores were somewhat large (standard deviation for KGE of `r round(sd(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$kge, na.rm=T),2)` and for rBIAS of `r round(sd(results_3_2_rivs[results_3_2_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`).

![Figure 6. a: Performance metrics by river. See Table 1 for metric definitions. Dashed lines denote scores of 1, 0, and -0.41 for KGE (section 3.2). b-d: validation timeseries for three rivers representative of good, reasonable, and poor performance. b) was randomly selected from the upper tertile of KGE scores, c) was randomly selected from the middle tertile, and d) from the worst tertile. Model results include the posterior means and 95% CIs.](cache/validation/validation_by_river.jpg)

Figure 6b-d are representative timeseries plots of predicted and observed $k_{600}$ for three rivers chosen randomly from those with ‘good’ KGE scores (b), ‘okay’ KGE scores (c), and ‘bad’ KGE scores (d). See the Figure 6 caption for how this was calculated. For the Kanawha River, the entire timeseries of $k_{600}$ is correctly predicted, while in the Ohio Section 2 River there is a negative bias in the estimates. However, temporal dynamics are still correctly recovered. In the downstream Mississippi River, there is significant bias in the estimates as well as significant uncertainty (per the 95% CIs). The temporal dynamics are also incorrectly predicted at times.

###3.3 Influences on carbon efflux estimates
Finally, we explore our ability to 1) use BIKER-produced $k_{600}$ to estimate $FCO_2$ and 2) estimate bulk carbon efflux from $CO_2$ evasion (section 2.4).

In Figure 7a, there is a strong fit to the observed $FCO_2$ data, with an RMSE of `r round(10^results_3_3_all$rmse,2)` $g/m^2dy$. The $r^2$ is slightly higher than $k_{600}$ (Figure 7a). There is also less underestimation bias for the smallest of the observed $FCO_2$ than in the $k_{600}$ predictions (Figure 5a). This is presumably due to the structure of the $FCO_2$ equation, which reduces the relative importance of errors in the gas exchange values given that the $CO_2$ data is measured in situ. $FCO_2$ prediction intervals also have a similar relative magnitude to those presented in Figure 5. Figure 7b-d includes subplots for the same rivers as Figure 4b-d, however with $FCO_2$ plotted instead of $k_{600}$. There is functionally perfect recovery of $FCO_2$ in the Kanawha River, very good recovery (with some positive bias in peak evasion events) for the Ohio Section 2 River, and far less negative bias in the Downstream Mississippi river than is present in the $k_{600}$ estimates (Figure 5b). Again, the temporal dynamics are accurately modeled in the Kanawha and Ohio Rivers, however there is some bias in the magnitude of the predictions. This suggests that the BIKER model can easily estimate the changing dynamics of gas exchange but is at the mercy of the prior on $k_{600}$ to accurately estimate the magnitude of the evasion.

![Figure 7. a: FCO2 from BIKER versus using observed average flow velocity for all timesteps for 22 SWOT rivers (grey lines are linear regression and 95% prediction intervals, while black dashed line is the 1:1 line). b-d: timeseries plots for the three example rivers from Figure 5.6.](cache/FCO2/FCO2_plot.jpg)

We then compare the $FCO_2$ and bulk carbon efflux (via $CO_2$ evasion) from the 22 rivers using BIKER posterior means and three gauge-based HG models (Figure 8). Figure 8a are barplots of the bulk carbon efflux (via $CO_2$ evasion) across all rivers in gigagrams of carbon per year. The BIKER bulk carbon efflux (`r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_BIKER',]$sumFCO2, 0)` gG-C/yr) is slightly overestimated relative to to the bulk carbon efflux calculated using observed velocity (`r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_ulset',]$sumFCO2, 0)` gG-C/yr). However, it is a better estimate than those using a streamgauge and HG (`r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_raymond2012',]$sumFCO2, 0)`, `r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_raymond2013',]$sumFCO2, 0)`, and `r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_Lauerwald2015',]$sumFCO2, 0)` gG-C/yr for ‘Raymond 2012’, ‘Raymond 2013’, and ‘Lauerwald 2015’, respectively). Thus, BIKER reasonably captures the estimated efflux from these rivers purely from RS data, and surprisingly outperforms the gauge-based approaches when assessing this bulk flux property (Figure 8a).

![Figure 8. a: Bulk carbon efflux, per year, from the 22 SWOT rivers as calculated using four different average flow velocity estimates: 1) BIKER, 2) through 4) average flow velocity as calculated using HG models from the literature. b: Histograms of by-river performance in estimating FCO2 across all timesteps and rivers for the same four velocity models. Dashed lines are identical to Figure 6a.](cache/FCO2/FCO2_models.jpg)

Figure 8b plots the by-river performance scores for $FCO_2$. For KGE, 'Lauerwald 2015' is the best performing (median KGE: `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_Lauerwald2015',]$kge, na.rm=T),2)`) while BIKER (median KGE: `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_BIKER',]$kge, na.rm=T),2)`) slightly outperforms the other two gauge-based methods (median KGEs: `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_raymond2013',]$kge, na.rm=T),2)` and `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_raymond2012',]$kge, na.rm=T),2)` for 'Raymond 2013' and 'Raymond 2012', respectively). However, all four scores are very similar. For rBIAS, BIKER indicates the least bias in some rivers and similar bias to the other models in other rivers, as indicated by the scores' inter-quartile range (`r round(IQR(results_3_3_rivs[results_3_3_rivs$key=='FCO2_BIKER',]$rBIAS, na.rm=T),2)`) and median (`r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_BIKER',]$rBIAS, na.rm=T),2)`). Meanwhile, all three HG models uniformly produce significant negative bias in their estimates (median scores of `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_Lauerwald2015',]$rBIAS, na.rm=T),2)`, `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_raymond2013',]$rBIAS, na.rm=T),2)`, and `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_raymond2012',]$rBIAS, na.rm=T),2)` for 'Lauerwald 2015', 'Raymond 2013', and 'Raymond 2012', respectively). BIKER has similar performance for NRMSE and RRMSE, which is generally worse than the HG models. But, BIKER NRMSE is only slightly worse than 'Raymond 2013 and 'Raymond 2012' while BIKER RRMSE (median RRMSE: `r round(median(results_3_3_rivs[results_3_3_rivs$key=='FCO2_BIKER',]$rrmse, na.rm=T),2)`) is significantly worse than the gauge-based approaches. RRMSE is highly sensitive to prediction errors in small values and so this suggests that BIKER performs poorly when predicting small $CO_2$ fluxes. In summary, BIKER performance for KGE, NRMSE, and rBIAS is either similar or negligibly worse than the gauge-based upscaling approaches tested here and notably worse for RRMSE. This is despite relying on absolutely no in situ information like all three other models do.

##4 Discussion
###4.1 Towards remote sensing global spatiotemporal dynamics of $k_{600}$
To date, most field-scale studies of riverine gas exchange have focused on 1) its relationship with wind speed [e.g @beaulieuControlsGasTransfer2012a; @borgesVariabilityGasTransfer2004; @zappaEnvironmentalTurbulentMixing2007], 2) average flow velocity [e.g. @alinPhysicalControlsCarbon2011; @beaulieuControlsGasTransfer2012a; @schelkerCO2EvasionSteep2016a], or 3) discharge [e.g. @robertsMultipleScalesTemporal2007; @uehlingerEcosystemMetabolismDisturbance1998]. However, the spatiotemporal dynamics of riverine gas exchange are still weakly constrained. A few studies have investigated these dynamics, but they have been limited to individual rivers and/or limited field seasons [@hallAirWaterOxygen2012; @sand-jensenCO2DynamicsDanish2012]. @wallinSpatiotemporalVariabilityGas2011 performed a preliminary analysis in northern Sweden relating river specific (‘at-a-station’) temporal variability in gas exchange with channel slope, but they were limited to an average of only 8 measurements per river in a single watershed. This limited knowledge of large-scale $k_{600}$ spatiotemporal dynamics is due both to a lack of process-level understanding [@hallGasExchangeStreams2020] but also a lack of measurements. Authors have argued that the key to explaining the large residual variation in upscaling models is to explore at-a-station temporal variability in $k_{600}$ [@hallGasExchangeStreams2020].

Therefore, estimating $k_{600}$ from SWOT data is an attractive option for exploring the spatiotemporal dynamics of $k_{600}$ at fine temporal resolution and at the global-scale. SWOT will provide daily hydraulic measurements for a 3 month fast sampling period for calibration and validation and sampling thereafter between 1 and 7 days per 21 day repeat cycle [@biancamariaSWOTMissionIts2016]. BIKER's success in 1) infering $k_{600}$ using simulated SWOT data over a wide range of rivers (Figures 5 and 6) and 2) being robust to measurement errors internal to the SWOT data (Figures 4 and 6a) bode well for BIKER's eventual implementation on real SWOT observations.  The results presented here suggest that daily estimation of riverine gas exchange globally could be possible once SWOT launches.

###4.2 Estimating bulk carbon efflux using the SWOT satellite
Section 3.3 confirms that BIKER is successful at two things without any in situ information for $k_{600}$: 1) reproducing $FCO_2$ (Figure 7) and 2) reproducing the bulk carbon efflux (Figure 5.8). This encouraging result has two main implications for future work. First, section 3.3 confirms that we can couple BIKER and SWOT with in situ gas concentration loggers to produce $FCO_2$ estimates at novel temporal resolution in SWOT-observable rivers. This is particualry useful given recent advances in high temporal resolution in situ gas concentration measurements **get citations from Kelly**. BIKER can likely also be ran at the field scale using arrays of pressure transducers to estimate water surface slope following recent work doing the same using the @hagemannBAMBayesianAMHGManning2017a RSQ algorithm [@harlanDischargeEstimationDense].

Secondly, it is important to stress that unlike BIKER, the HG models in Figure 8 rely on an in situ streamgauge. This means that Figure 8 represents the best performance that those models could ever have; if ran using modeled discharge their accuracy would necessarily decrease, though this decrease would not be too much due to the generally good performance of those data. Thus, these results suggest that BIKER will be useful in two settings: 1) upscaling in ungauged rivers as hypothesized, but also in 2) potentially improving our bulk efflux understandings at gauged sites. Future work should systematically quantify prediction error from coupling global-scope HG models with modeled discharge, as is the default workflow used in recent upscaling studies [e.g. @lauerwaldSpatialPatternsCO22015; @horgbyUnexpectedLargeEvasion2019]. **I assume Shaoda's paper will still be in review and can't cite here but this is exactly what they do...**

Figure 8 also confirms that the training data used for HG models exerts a significant influence on upscaled carbon emissions from rivers. The 'Lauerwald 2015' model, which was trained on larger rivers than the data used in either the 'Raymond 2013' or 'Raymond 2012' models, should perform best on SWOT-observable rivers (which are greater than 50m wide). Figure 8 confirms this. Meanwhile, BIKER has no similar reliance on hydraulic parameters trained on different river sizes and only assumes that Manning's equation is viable in the river at hand [which is generally the case in rivers large enough to be SWOT-observable- @fergusonTimeAbandonManning2010]. Upon SWOT's launch, the BIKER approach to estimating gas exchange could be coupled with existing upscaling workflows to improve riverine gas flux predictions where gauges are unavailable but SWOT measurements are.

###4.2 Sources of BIKER uncertainty: process-level or remote sensing?
Throughout the BIKER validation, we have assumed no parameter uncertainity in the upscaling parameters $a_i$ and $b_i$. We have shown that BIKER estimate uncertainty is significantly less than $a_i$ and $b_i$ uncertainity (Figures 4 and 5). BIKER provides similar estimates of $k_{600}$ to those produced by current upscaling models and most of the total uncertainity stems from the upscaling model itself (Figure 4). We argue that BIKER's estimate uncertainity is therefore limited by our current process-level understanding of $k_{600}$ upscaling and not by BIKER or SWOT, suggesting that BIKER's predictive performance can only improve from advancing our understandings of the physical processes governing gas exchange from SWOT-observable rivers. Developing and validating the BIKER algorithm has provided a unique lense through which we can discuss riverine gas exchange theory. In that context, we next explore some considerations for future work on $k_{600}$ upscaling in SWOT-observable rivers.

####4.2.1 Gas exchange under uniform and non-uniform flow conditions
Section 2.2 highlights that most upscaling studies to date have assumed uniform flow conditions (i.e. $S_h \neq S_0$) in order to train upscaling models using readily available slope data. However, the first-principles model previously used by @ulsethDistinctAirWater2019a and @raymondScalingGasTransfer2012a to define *eD* [@tsivoglouTracerMeasurementReaeration1976] does not make this simplifying assumption. Therefore, it is an open research question whether parameterizing $k_{600}$ upscaling models via $S_h$ can account for some of the unexplained residual variation in current upscaling models [@hallGasExchangeStreams2020]. Conveniently, SWOT will explicitly measure $S_h$ at unprecendeted spatial and temporal resolutions and will be spatially joined to hydrography that provides $S_0$. Thus, future researchers can use BIKER and SWOT in conjunction to directly answer this question.

####4.2.2 Bed roughness and gas exchange in SWOT rivers
Channel bed roughness affects riverine gas exchange mostly in high energy streams where slope is sufficiently steep for bubble-induced gas exchange to occur [@hallGasExchangeStreams2020]. @ulsethDistinctAirWater2019a showed bed roughness loosely scales with $k_{600}$ in steep Alpine streams. However, they coarsely estimated bed roughness from arial imagery and to date most similar work has focused on labratory exercises [e.g. @chansonStreamReaerationNonuniform; @moogStreamReaerationNonuniform]. We argue that bed roughness is not controlling gas exchange in SWOT-observable rivers because they are so large and therefore flat. Instead, gas exchange in SWOT-observable rivers is presumably dominated by water-column, rather than bed friction, turbulence. We show in Figure S2 with the @ulsethDistinctAirWater2019a data that the 'effective bed roughness height' scales with $k_{600}$ only in extremely steep streams (see Text S2 for the calculation of this bed roughness term). This relationship fundamentally breaks down in less steep rivers, and such steep slopes are functionally impossible in SWOT-observable rivers that are over 50m wide. This promising initial result indicates bed roughness controls some aspects of gas exchange and should be explicitly explored in future work, but is less relevant for BIKER's application to SWOT data. This is particularly important because small, steep rivers dominate global river networks and their GHG evasion [@horgbyUnexpectedLargeEvasion2019] due to the fractal nature of river systems [@tarbotonFractalNatureRiver1988].

####4.2.3 Wind-driven gas exchange in SWOT rivers
In wide rivers like those that SWOT will observe, wind begins to exert a non-trivial influence on gas exchange. It is well established that in lakes and the ocean, wind controls near-surface turbulence and thus gas exchange [@beaulieuControlsGasTransfer2012a; @readLakesizeDependencyWind2012]. Authors have argued that large rivers are a hybrid of the hydraulics-driven turbulence in small rivers and the wind-driven turbulence in lakes [@beaulieuControlsGasTransfer2012a]. As SWOT will measure only rivers wider than 50m, it follows that wind is likely exerting some influence on gas exchange in SWOT-observable reaches. Here, we opted to ignore wind effects in our upscaling model and in BIKER to favor global scalability and implementability for two reasons: 1) current upscaling efforts do not account for wind in their estimation of $k_{600}$ either and 2) it is infeasible to parameterize every set of SWOT measurements with local wind data. Further, relying on an in situ understanding of wind defeats the purpose of BIKER for ungauged settings. Future work should explore the feasibility of assigning a Bayesian prior on wind speed for BIKER.

##5 Conclusions
Efforts to upscale gas exchange velocities from river networks generally do so using river channel slope and average flow velocity. Therefore, gas evasion estimates are sensitive to available data on average flow velocity. In ungauged basins, this poses a problem because a velocity~discharge relationships can not be built. To circumvent this problem, we propose using established techniques from the ungauged remote sensing of river discharge literature and applying them to gas exchange velocity in ungauged rivers. This is formalized as the BIKER algorithm and uses data from the upcoming SWOT satellite to remotely sense gas exchange velocity solely from river width and water surface height. We validate BIKER on 22 'rivers' of simulated SWOT data [@frassonCompilationHydraulicModels2019a], obtaining an RMSE of `r round(10^results_3_2_all$rmse,2)` ,/day after accounting for upscaling parameter uncertainity. When generalized to estimate bulk carbon efflux from these 22 rivers, BIKER reasonably captures the observed efflux (`r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_BIKER',]$sumFCO2, 0)` gG-C/yr versus `r round(results_3_3_bulk[results_3_3_bulk$key == 'FCO2_ulset',]$sumFCO2, 0)` gG-C/yr, respectively). Further, BIKER's $FCO_2$ estimates across the 22 rivers are either functionally the same or modestly worse than those made using a streamgauge and the HG models frequently used in the literature. This suggests that BIKER will be useful not only for upscaling in ungauged rivers, but also in potentially improving our understandings in gauged rivers too. As drainage network models of GHG evasion gain in sophistication and continue to ingest higher and higher temporal resolution data, BIKER and SWOT should prove useful in providing such information.

##6 Acknowledgements
C.B. Brinkerhoff was funded on **xxxxxxxxxxxxx**. BIKER is available at https://github.com/craigbrinkerhoff/BIKER. All code to build and generate results, figures, and the manuscript is available at https://github.com/craigbrinkerhoff/RSK600. Data used in this study was generously made available by the authors of Frasson et al. (2019), Ulseth et al. (2019), and Beaulieu et al. (2012). This manuscript benefitted extensively from the decade plus body of work generated by the SWOT Discharge Algorithm Working Group.

## References