---
title: "Exploiting hydraulic geometry to remotely sense gas exchange velocity via the SWOT satellite"
author:
  - Craig B Brinkerhoff:
      email: cbrinkerhoff@umass.edu
      institute: UMass
      correspondence: true
  - Colin J Gleason:
      institute: UMass
  - Peter A Raymond:
      institute: Yale
  - Christopher J Zappa:
      institute: Lamont
  - Merritt H Harlan:
      institute: UMass
institute:
  - UMass: Department of Civil & Environmental Engineering, University of Massachusetts-Amherst
  - Yale: School of the Environment, Yale University
  - Lamont: Lamont-Doherty Earth Observatory, Columbia University
bibliography: References.bib
csl: agu_citation_style.csl
output:
  word_document:
      pandoc_args:
        - '--lua-filter=scholarly-metadata.lua'
        - '--lua-filter=author-info-blocks.lua'
      reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Key Points
- BIKER algorithm predicts gas exchange velocity and $CO_2$ fluxes from simulated SWOT data
- BIKER is robust to measurement errors implicit in SWOT river measurements
- BIKER will allow for unprecedented study of gas exchange spatiotemporal dynamics upon SWOT's launch

## Keywords
gas exchange, fluvial geomorphology, remote sensing, open-channel flow, SWOT, biogeochemistry

## Abstract
Extensive research over the past two decades has shown that the global river network emits significant amounts of greenhouse gas via evasion. Despite much progress, there is still significant uncertainty in the temporal dynamics of gas exchange velocity (the rate of evasion) and thus carbon emissions to the atmosphere. We propose that the NASA/CNES/USKA/CSA SWOT satellite, set to usher in a new age of hydrology research at the global scale, can provide similarly transformative insights to fluvial gas exchange modeling upon launch in 2022. Here, we present work inferring gas exchange velocity from future SWOT observations without an in situ calibration. We exploit the unique geomorphology of SWOT-observable rivers to develop a physical model of gas exchange that is nearly entirely remotely sensible and explains `r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eD',]$r2,2)*100`% of variation in gas exchange. We then couple this model with established Bayesian techniques to develop BIKER, or the 'Bayesian Inference of the $k_{600}$ Exchange Rate' algorithm. We validate BIKER on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-simulated rivers and 763 discrete measurements of river gas exchange, yielding an algorithm that predicts this theoretical model solely from SWOT observations with a by-river median normalized RMSE of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==0,]$NRMSE), 2)*100`%. Like many fluvial Bayesian inference algorithms, BIKER is better at reproducing the temporal dynamics of gas exchange (median correlation coefficient of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==0,]$r), 2)`), rather than estimating the absolute rates of exchange. Finally, we show BIKER robust to measurement errors implicit in the SWOT data. With SWOT set to launch in 2022, we suggest that BIKER can be deployed to map the global-scale spatiotemporal dynamics of fluvial gas exchange in large rivers.

## 1 Introduction
Natural systems play a critical role in the budgeting and accounting of the global carbon cycle under climate change. Following @colePlumbingGlobalCarbon2007, the global river network is recognized to emit substantial amounts of carbon to the atmosphere, in addition to their long understood role of exporting carbon to the oceans. Current estimates of total carbon dioxide evasion ($FCO_2$) to the atmosphere from the global river network vary from 650-1800 Tg C/yr [@lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013] (*Liu etal in review- add number is paper is accepted in time*), with 167 Tg-C/yr coming from mountain streams alone [@horgbyUnexpectedLargeEvasion2019]. Despite its incredibly small percentage of the global land surface [0.`r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])`%- @raymondGlobalCarbonDioxide2013], this C flux is on par with the total oceanic $CO_2$ uptake rate [@gruberOceanicSinkAnthropogenic2019; @horgbyUnexpectedLargeEvasion2019] and the global forest carbon uptake rate [@panLargePersistentCarbon2011]. River $CO_2$ evasion is increasingly better constrained (as evident by these studies' reported uncertainties) and is clearly a critical component of the global carbon cycle. Equation 1 represents this flux given $\delta CO_2$ (the gas concentration gradient between the water $CO_{2_{water}}$ and the air $CO_{2_{air}}$) and the gas exchange velocity *k*. Consult Appendix A for variable nomenclature used throughout this study.

$$FCO_2=k* \delta CO_2 \mathbf{(1)}$$
The structure of equation 1 necessitates that calculations of this flux are highly sensitive to measurements/estimates of *k*. However, *k* can only be directly measured via a known gas concentration gradient, eddy-covariance measurements, or tracer additions to the stream [@hallGasExchangeStreams2020]. When trying to constrain the global fluvial $FCO_2$ flux across millions of rivers, this limitation necessitates the use of predictive models for fluvial *k* that are based on easily estimated river hydraulic properties. In that vein, there have been over 20 empirical models developed for this and similar purposes, generally using some combination of mean velocity $\bar{U}$, shear velocity $U_*$, width $W$, depth $H$, and slope $S$ as predictors [@wangPhysicallyBasedScaling2021]. Note that these models usually predict $k_{600}$, or *k* normalized by a Schmidt number of 600, to make use of additional measurements taken at different water temperatures and with different gases. For example, $k_{600}$ reflects the $k_{CO_{2}}$ at 20 degrees Celsius.

While this workflow enables estimating the global $FCO_2$ flux ($FCO_2_{upscaled}$) across millions of rivers, it also changes the base parameters that ultimately control that estimate. This functional relationship is described in equation 2. It suggests that $FCO_2$ estimates are not only at the mercy of the accuracy and spatiotemporal resolution of $\delta CO_2$ [of which an extensive literature has explored- e.g. @crawfordCO2TimeSeries2017; @peterScalesDriversTemporal2014; @ranDynamicsRiverineCO22017; @rocher-rosLandscapeProcessDomains2019; @raymondAtmosphericCO2Evasion2000], but also the accuracy and resolution of our river hydraulics estimates.

$$FCO_{2_{upscaled}}=f(k_{CO_2}, \delta CO_2)=f(\bar{U}, H, S, W, \delta CO_2) \mathbf{(2)}$$
For example, the @raymondGlobalCarbonDioxide2013, @lauerwaldSpatialPatternsCO22015, and @horgbyUnexpectedLargeEvasion2019 $FCO_2$ global upscaling studies all relied on $k_{CO_2}$ values calculated using mean annual hydraulic conditions, while @borgesGloballySignificantGreenhousegas2015 used a combination of mean annual values and a constant $k_{CO_2}$ in space and time to upscale over Africa. In all of these key studies, the temporal dynamics of the gas exchange velocity (and thus $FCO_2$) were ignored because of data limitations. As workers move towards river-reach-explicit modeling of gas exchange at the global scale with more and more elaborate models for $CO_{water}$ [@horgbyUnexpectedLargeEvasion2019; @brinkerhoffLakeMorphometryRiver2021; *Liu etal in review; Saccardi & Winnick et al in review*], they will also have to contend with the lack of direct measurements of global river hydraulics.

This lack of direct measurements also inhibits our process-level understandings of the spatiotemporal dynamics of $k_{600}$. A few field-scale studies have directly investigated these dynamics but they have been limited to individual rivers and/or limited field seasons [@hallAirWaterOxygen2012; @sand-jensenCO2DynamicsDanish2012]. For example, @wallinSpatiotemporalVariabilityGas2011 performed a preliminary analysis in northern Sweden relating cross-section specific temporal variability in gas exchange with channel slope, but they were limited to a mean of only 8 measurements per river in a single watershed. They also often focus on small rivers. More recently, @wangPhysicallyBasedScaling2021 attempted to address this problem by simulating *k* in 35 reasonably sized rivers (widths ranging from 0.23â€“349m) using a stream metabolism model [@applingOvercomingEquifinalityLeveraging2018] and in situ dissolved oxygen (DO) datasets to implicitly solve for *k*. They found that process-based models for *k* generally work well in these simulated rivers and that *k*~streamflow relationships change with river size, though they too were limited by a lack of direct hydraulic measurements and had to rely on scaling equations to estimate river depth and velocity.

In theory, the above problems could be alleviated and a global analysis of *k* spatiotemporal trends would be possible if direct hydraulics measurements were available at the global scale at a sufficient temporal resolution. Conveniently, near-daily hydraulics measurements will soon be available via the upcoming NASA/CNES/UKSA/CSA Surface Water and Ocean Topography (SWOT) satellite mission. SWOT is expected to launch in 2022 and provide the world's first direct measurements of global water surface extent and elevation at novel temporal resolutions. SWOT is a wide swath radar interferometer and will sample rivers every 1 to 7 days per 21 day repeat cycle, measuring rivers wider than 100m with a goal of expanding this to rivers at least 50m wide [@biancamariaSWOTMissionIts2016]. Via its direct hydraulics measurements, SWOT is expected to usher in a sea change in global-scale hydrology, and fluvial biogeochemsitry should be no different. We suggest that SWOT data will prove transformative to global-scale biogeochemistry if techniques are developed that can ingest SWOT data and infer the parameters of interest. Here, we focus specifically on $k_{600}$, borrowing tools from fluvial geomorphology and existing SWOT algorithms to answer the following two questions:

  - Can we leverage the unique geomorphology of the large rivers that SWOT will observe to develop a physically-based gas evasion model unique to these rivers?
  
  - Can we then exploit the findings from this analysis to develop a novel methodology that infers this physically-based $k_{600}$ model (and its uncertainty) solely using SWOT observations?

We name the RS of $k_{600}$ algorithm BIKER, or the 'Bayesian Inference of the $k_{600}$ Evasion Rate' and it requires no in situ inputs of any kind (although in situ data can be ingested and will improve results). We validate BIKER on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-observable rivers from around the world using hydraulic models to produce SWOT-like data (as SWOT has not yet launched). We also quantify BIKER's sensitivity to the expected SWOT measurement errors on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])` of those rivers: SWOT data is expected to have an approximately 10cm error in water surface elevation [@biancamariaSWOTMissionIts2016] as well as river width errors as a function of the cross-track distance [@frassonExploringFactorsControlling2021]. Finally, we use previously published dissolved $CO_2$ data to represent a hypothetical in situ $CO_2$ sensor and compare the bulk carbon efflux from the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers as calculated using BIKER and previously published in situ techniques for predicting $k_{600}$ from streamflow.

Following the description of the data used (section 2), this paper is split into two distinct parts: gas-exchange theory and model development (section 3) and BIKER algorithm development and validation (section 4). Section 4 is fundamentally dependent on the results presented in section 3. We conclude with a Discussion regarding both sections 3 and 4 (section 5). We also provide a flowchart detailing the entire study as Figure 1.

![Figure 1: Flowchart detailing entire study. Dashed lines indicate workflow to calculate the observed data that we validate against. See Appendix A for variable nomenclature used in this study.](cache/flowchart.jpg)

## 2 Data
Numerous datasets were used in this study. Please see Figure 2 for a map of the approximate locations for the data used in this study.

![Figure 2: Map of the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` hydraulic models and 1 timeseries of CO2 samples used in this study. Note that hydraulic model locations are approximate as some of the models are not geo-referenced. Not mapped here, but also used, are over 170,000 discrete measurements of river channel hydraulics from across the continental United States (Brinkerhoff et al. 2019) and 763 gas exchange velocity measurements (Table S1).](cache/maps/map_fin.jpg)

Gas exchange theory (section 3) is explored using multiple datasets where $k_{600}$ was measured directly and/or collected from the literature. In total, there are 763 measurements of stream hydraulics and $k_{600}$. This is, to our knowledge, the largest collection of field-measured river and stream $k_{600}$. 701 of these measurements were previously collected from other studies by @raymondScalingGasTransfer2012 and @ulsethDistinctAirWater2019. The remaining measurements were added by us but measured by @churchillPredictionStreamReaeration1964 and @owensReaerationStudiesStreams1964. See Table S1 for a complete list of the studies that collected these measurements.

To quantify our geomorphic assumptions for SWOT rivers (section 3.1), we additionally use a previously published compilation of field hydraulics measurements [@brinkerhoffReconcilingAtaStationAtManyStations2019]. These were originally made to calibrate United States Geological Survey (USGS) streamgauge rating curves. That dataset contains over 530,000 unique measurements of river channel velocity, width, and discharge from across the continental United States. Ultimately, this dataset was filtered down to `r sum(percs$n)` discrete measurements for this study (see Text S1 for our filtering protocol).

BIKER validation (section 4) was performed on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-simulated rivers. Because SWOT has yet to launch, it is standard practice to benchmark SWOT-related algorithms on "SWOT-like" data. These simulated rivers are simply river-reach-averaged hydraulic model outputs where the water surface heights, slopes, and widths are labelled as RS observations and are used as the sole inputs to BIKER. Here, we use `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])`/51 rivers collected by @frassonExploringFactorsControlling2021 and @durandIntercomparisonRemoteSensing2016. These are the two benchmarking studies that have explored RSQ algorithm performance for the SWOT mission. The approximate locations of these rivers are plotted in Figure 1, and please consult both of those papers for all of the hydraulic model specifications. Ultimately, the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers are spread across the United States, France, Italy, the United Kingdom, and Bangladesh. We omit three models from @durandIntercomparisonRemoteSensing2016 because they lack enough hydraulic information to calculate the mean flow depth, which is necessary for algorithm validation (section 4.1.2). These are two models for different sections of the Saint Lawrence River in Canada and one for the Tanana River in Alaska, United States.

To assess the influence of SWOT's implicit measurement error on BIKER performance, we use the error models developed by @durandHowWillRadar2020 and @frassonExploringFactorsControlling2021, which the latter implemented on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])`/`r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` of the rivers. Error in SWOT measurements will come from both the error tolerances intrinsic in the satellite data product as well as radar layover error and river width error. Layover error is the phenomenon when radar returns from different places arrive at the sensor at the same time, leading to taller landscape features appearing closer to the sensor than shorter landscape features that are the same horizontal distance from the sensor [@durandHowWillRadar2020]. Width errors due to poor water classification are ignored but width errors due to the cross-track distance are included [@frassonExploringFactorsControlling2021]. The cross-track distance, reflective of the amount of the river cross-section that falls within SWOT's swath, controls the size of the pixels **help, I on't understand cross-track distance**. @frassonExploringFactorsControlling2021 tested a suite of measurement error scenarios, however here we test only their 'full uncertainty scenario' that most closely represents the measurement errors that will be implicit in SWOT data. 

For the $CO_2$ evasion and carbon efflux calculations (section 4.1.3), we use 26 bi-weekly dissolved $CO_2$ samples collected by @beaulieuControlsGasTransfer2012 at one location in the Ohio River for one calender year from 2008-2009 (Figure S1). Note that this $CO_2$ data is for the Ohio River only but was applied to all rivers (which includes multiple sections of the Ohio River). Because we are exclusively interested in the relative differences between $FCO_2$ estimates and not the raw fluxes themselves, any $CO_2$ data representative of SWOT-observable rivers was deemed acceptable for this validation exercise.

## 3 Hydraulic geometry in large rivers and predicting fluvial gas exchange velocity
To predict *k* in the very large rivers that SWOT will observe, we start from established process-based models for *k*, impose hydraulic assumptions that are valid in large rivers, and then obtain a suite of models we can test. First, we outline these established models (section 3.1) and then step through our hydraulic assumptions to arrive at equations that can be ingested by SWOT (section 3.2). Following this model development, all models are empirically tested on the dataset described in Section 2 after filtering for measurements made in hydraulically-wide channels (section 3.3). This was defined here as those whose hydraulic radius was within 1% of their mean flow depth. All told, this amounts to 166 direct measurements of hydraulically-wide $k_{600}$ to test with.

### 3.1 Process-based modeling of river *k*
*k* should scale with near-surface turbulence in a turbulent flow [@hallGasExchangeStreams2020] and thus extensive field and laboratory experiments have converged on the 'small-eddy model' as first proposed by @lamontEddyCellModel1970 to scale *k* via the smallest-scale turbulent eddies [e.g. @lorkeUnifiedScalingRelation2006; @zappaEnvironmentalTurbulentMixing2007; @zappaVariationSurfaceTurbulence2003; @moogStreamReaerationNonuniform1999; @vachonRelationshipNearsurfaceTurbulence2010; @tokoroHighGastransferVelocity2008; @katulStructureFunctionModel2018; @wangPhysicallyBasedScaling2021]. This model is provided as equation 3, where $\epsilon$ is the dissipation rate of near-surface turbulence, $v$ is the kinematic viscosity, and *Sc* is the Schmidt number.

$$k\propto Sc^{-1/2}(v\epsilon)^{1/4} \mathbf{(3)}$$
Further, some workers have noted that laboratory and field observations suggest open channel flows with small bed roughness (generally big rivers) do not exhibit homogeneous surface dissipation at their air-water interface [@moogAirWaterGasTransfer1999; @talkeTurbulentKineticEnergy2013]. Given this observation, @moogAirWaterGasTransfer1999 proposed a 'chainsaw model' which extends the small-eddy model by limiting surface dissipation to only 'active zones' within which a homogeneous dissipation rate occurs and the small-eddy model is valid. This is equation 4 where $A_p$ is the fraction of the interface that are active zones and is proportional to the larger, depth-scale eddies [@moogAirWaterGasTransfer1999]. This means that if the entire interface is treated as an active zone, the model would simply reduce to the small-eddy model. This is hypothetically useful in low-turbulence flows where a relative lack of large-scale eddies effectively 'filter out' the number of small-eddies that actually reach the interface and lead to gas exchange [@talkeTurbulentKineticEnergy2013]. In the context of BIKER, we chose to test this model because large, SWOT-observable rivers are generally the smoothest, least-turbulent flows along the stream-to-river continuum. Further, to our knowledge the chainsaw model has never been empirically tested in predicting *k*, aside from confirming that large-scale eddies differentially move turbulence to the surface in a hydraulically-wide river [@talkeTurbulentKineticEnergy2013].

$$k \propto Sc^{-1/2}(v\epsilon)^{1/4}A_p^{3/4} \mathbf{(4)}$$
Finally, both equations rely on measurements of $\epsilon$, of which directly measuring is non-trivial. When working at large scales, a commonly used $\epsilon$ model assumes that all turbulence is generated at the bed and transported to the air-water interface via the log-law-of-the-wall such that $\epsilon = \epsilon_S = \frac{U_*^3}{H}$ [@lorkeUnifiedScalingRelation2006; @nezuTurbulenceOpenChannel1993]. Another approach models *k* via 'form-drag dissipation' ($\epsilon = \epsilon_D = gS\bar{U}$) which is equivalently the total stream power per unit mass water. This normalized stream power captures the bulk frictional resistance (and thus energy dissipation) via channel banks, meanders, bars, etc. that is unique to fluvial systems [@moogStreamReaerationNonuniform1999]. Authors have since shown that this model can reasonably predict *k* [@raymondScalingGasTransfer2012; @ulsethDistinctAirWater2019; @wangPhysicallyBasedScaling2021], however it requires estimates of mean flow velocity and does not necessarily reflect the surface dissipation rate.

### 3.2 Imposing large-river hydraulic geometry
Rivers and streams change predictably along their longitudinal profile from headwater to ocean, and we can exploit the distinct hydraulic geometry of large rivers to estimate *k* in SWOT-observable systems. In general, as river size increases, channels become more rectangular, their shapes elongate (becoming wider quicker than they become deeper) and their hydraulic radii begin to approximate their mean flow depth, i.e. $R_h \approx H$ [@leopoldHydraulicGeometryStream1953]. This is a common assumption in hydraulic and geomorphic modeling of large rivers, and occurs in `r round(percs[percs$flag_swot == 'SWOT' & percs$flag_hydraulicWide == 'Rh=H',]$perc,0)`% of our SWOT-observable river measurements but only `r round(percs_overall[percs_overall$flag_hydraulicWide == 'Rh=H',]$perc,0)`% of non-SWOT observable river measurements (see Text S1 for how we arrived at these numbers). These channels are often referred to as 'hydraulically-wide'.

Assuming that all SWOT-observable rivers are hydraulically-wide, we test the performance of four models for predicting *k* in hydraulically-wide channels: the four unique combinations of equations 3-4 and the two $\epsilon$ models already outlined. While the complete model derivations for the small-eddy models (section 3.2.1) and the chainsaw models (section 3.2.2) are provided in Text S2, the broad goal was to reduce the equations down to their fundamental parameters, identifying which terms are SWOT observable and limiting the number of terms not directly measurable via SWOT.

#### 3.2.1 'Small-eddy' model for gas evasion
We derive equations starting from the small-eddy model (equation 3) for hydraulically-wide channels. If we assume the log-law-of-the-wall model for $\epsilon$, simplify equation 2 using $R_H = H$, and finally solve for $k_{600}$ via statistical parameter $\alpha$, we eventually arrive at equation 5. If we do the same but via the form-drag model for dissipation and statistical parameter $\alpha_1$, we arrive at equation 6.

$$k_{600}=\alpha(gS)^{3/8}H^{1/8} \mathbf{(5)}$$

$$k_{600}=\alpha_1(gS\bar{U})^{1/4} \mathbf{(6)}$$
Equations 5 and 6 thus define gas exchange velocity solely as a function of slope and mean flow depth or mean flow velocity. This is theoretically valid only in a hydraulically-wide channel.

#### 3.2.2 'Chainsaw' model for gas evasion
We also impose a hydraulically-wide channel and $\epsilon_S$ on the chainsaw model just like we did in section 3.1.1 and arrive at equation 7 (with statistical coefficient $\beta$). The result is identical to the hydraulically-wide small-eddy model (equation 5), except for the exponents which are both steeper. Equation 8 reflects the same derivation, but via the form-drag model for dissipation and statistical coefficient $\beta_1$.

$$k_{600}=\beta(gS)^{9/16}H^{11/16} \mathbf{(7)}$$
$$k_{600}=\beta_1(gS)^{7/16}\bar{U}^{1/4}H^{9/16} \mathbf{(8)}$$
We now have four different models for $k_{600}$ in hydraulically-wide rivers, each with a different set of assumptions and parameters but all defined as functions of the water surface slope and other hydraulic terms that are not directly measurable via SWOT. All four models are summarized in Table 1.

*Table 1: Four physically-based models for $k_{600}$ each derived under a different set of mass transport assumptions but all valid in hydraulically-wide rivers. Their derivations are outlined in sections 3.2.1 and 3.2.2 and their empirical tests are shown in section 3.3.*

|**Description**|**Equation**|**References**|**Empirical test**|**Empirical fit via $r^2$**|
|---------------|------------|--------------|------------------|-----------------|
|Small-eddy, log-law-of-the-wall|$k_{600}=\alpha(gs)^{3/8}H^{1/8}$|@lamontEddyCellModel1970; log-law-of-the-wall|Figure 3a|`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eS',]$r2, 2)`|
|Small-eddy, form-drag dissipation|$k_{600}=\alpha_1(gS\bar{U})^{1/4}$|@lamontEddyCellModel1970; @moogStreamReaerationNonuniform1999|Figure 3c|`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eD',]$r2, 2)`|
|Chainsaw, log-law-of-the-wall|$k_{600}=\beta(gs)^{9/16}H^{11/16}$|@moogAirWaterGasTransfer1999; log-law-of-the-wall|Figure 3b|`r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eS',]$r2, 2)`|
|Chainsaw, form-drag dissipation|$k_{600}=\beta_1(gs)^{7/16}\bar{U}^{1/4}H^{9/16}$|@moogAirWaterGasTransfer1999; @moogStreamReaerationNonuniform1999|Figure 3d|`r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eD',]$r2, 2)`|

### 3.3 Model validation
With equations 5-8 defined, we now empirically test their strength of fit for hydraulically-wide channels via the coefficient of determination ($r^2$). These results are plotted in Figure 3. Note that Figure 3 axes are plotted in logarithmic space just for visualization: model fit and validation (via $r^2$) were calculated in linear space as their models dictate.

![Figure 3: Empirical testing of four models for predicting gas exchange velocity in hydraulically-wide channels: (a) Small-eddy model with log-law-of-the-wall dissipation. (b) Chainsaw model with log-law-of-the-wall dissipation. (c) Small-eddy model with form-drag dissipation. (d) Chainsaw model with form-drag dissipation. Note that axes are plotted in logarithmic space just for visualization: model fit and validation were calculated in linear space.](cache/k600_theory/k600Plot.jpg)

Despite reasonable $r^2$ scores, both small-eddy models produce clearly biased estimates (Figures 3a, 3c). They systematically underestimate lower gas exchange velocities and overestimate higher ones, with the log-law-of-the-wall model (Figure 3a) performing marginally worse both visually and via $r^2$ (`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eS',]$r2, 2)` versus `r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eD',]$r2, 2)` for Figure 3c). However, when this model is expanded to account for a differential dissipation rate at the interface via the chainsaw model [equations 6 and 7- @moogAirWaterGasTransfer1999], the dynamics are more accurately captured (Figures 3b, 3d) and $r^2$ scores go up appreciably (`r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eS',]$r2, 2)` and `r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eD',]$r2, 2)` for the log-law-of-the-wall and form-drag dissipation, respectively). Modeling dissipation via total form-drag rather than just via bed shear and the log-law-of-the-wall improves model performance. This is likely because the majority of dissipation occurring in rivers comes not just from the streambed, but from bulk form drag via channel walls, bars, and meanders [@raymondScalingGasTransfer2012; @moogStreamReaerationNonuniform1999; @wangPhysicallyBasedScaling2021; @ulsethDistinctAirWater2019].

Given the algebraic structure of the small-eddy and chainsaw models, the performance differences observed in Figure 3 are largely due to the exponents applied to the river hydraulic terms (which are described in the subplot x axis labels). While the use of the form-drag dissipation model includes a mean flow velocity term and improves performance, the primary difference between the small-eddy and chainsaw equations is the exponents. Intuitively, this exponent discrepancy indicates that in hydraulically-wide rivers where turbulence is relatively low, large-scale eddies exert a noteworthy influence on surface dissipation rates and that the small-eddy model is not sufficient. It is also worth noting that this is, to our knowledge, the first empirical confirmation that the chainsaw model is valid in rivers (at least hydraulically-wide ones). This is elaborated on in section 5.1.

The success of the chainsaw model in hydraulically-wide channels, and in particular when coupled with the form-drag dissipation model (equation 8, Figure 3d), provides us with a strong physical-model for gas evasion. The river hydraulics terms in equation 8 can either be directly measured or reasonably inferred from SWOT measurements, effectively opening the door for remotely sensing gas exchange. This is explored next.

## 4 Exploiting equation 8 to remotely sense gas exchange velocity
We have shown that scaling $k_{600}$ via equation 8 explains `r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eD',]$r2,2)*100`% of the variation in $k_{600}$ in hydraulically-wide rivers, which includes nearly all SWOT-observable rivers. Further, equation 8 has only three non-remotely-sensible terms: $k_{600}$, mean flow depth, and mean flow velocity. Conveniently, techniques to simultaneously infer hydraulic parameters from SWOT dta have been established over the last decade to infer streamflow from SWOT's measurements [e.g. @andreadisConstrainingAssimilationSWOT2020; @brinkerhoffConstrainingRemoteRiver2020; @durandEstimatingReachaveragedDischarge2014; @garamboisInferenceEffectiveRiver2015; @gleasonRetrievalRiverDischarge2014a; @garamboisVariationalEstimationEffective2020; @brissetAssimilationAltimetricData2018; @hagemannBAMBayesianAMHGManning2017; @larnierRiverDischargeBathymetry2020a; @oubanasDischargeEstimationUngauged2018]. For BIKER, we follow the work developed by @durandEstimatingReachaveragedDischarge2014, @hagemannBAMBayesianAMHGManning2017, and @brinkerhoffConstrainingRemoteRiver2020 to infer mean flow velocity and depth from SWOT observations using a modified form of the Manning's equation for mean flow velocity. First, we detail algorithm development and experimental design (section 4.1) and then we present the validation results (section 4.2).

### 4.1 Section 4 methods
#### 4.1.1 BIKER
BIKER, and Bayesian inference in general, starts from Bayes rule (equation 9), where $\Theta$ is some set of non-remotely-sensible parameters we want to solve for (including $k_{600}$), *x* is the observed data, $f(x|\Theta)$ is the sampling model where data are conditional on the parameters, and $p(\Theta)$ is the joint prior distribution of the parameters. For BIKER, *x* is the SWOT-observables: river width *W* and water surface elevation $H_e$ (which is used to calculate the water surface slope *S*), while $\Theta$ are the parameters $k_{600}$, *n*, and $A_0$. Therefore, we are interested in solving for $p(\Theta|x)$, or the 'posterior' distribution. Note that $p(x)$ is usually computationally intractable to integrate exactly, but Bayesian inference tools require only the proportionality to be specified: $p(\Theta|x) \propto f(x|\Theta)p(x)$. Sampling algorithms are then used to approximate the posterior distribution, as is done in BIKER.

$$p(\Theta|x) = \frac{f(x|\Theta)p(\Theta)}{p(x)} \mathbf{(9)}$$
The heart of BIKER is its reformulation of the $k_{600}$ model (equation 8) as a Bayesian sampling model that is conditional on the non-remotely-sensible parameters (i.e. $f(x|\Theta)$). To do this, we first conceptualize a mass-conserved river reach, where hydraulic properties vary along cross-sections *i* within the reach but the entire mass of water moving through is conserved and thus only varies with timestep *t* [@gleasonTrackingRiverFlows2017]. This means that the reach-averaged $k_{600}$, which is a function of the channel hydraulics per equations 5-8 [@wangPhysicallyBasedScaling2021], will only vary temporally as well. Under this conceptual river reach model, BIKER predicts a time-varying, reach-averaged $k_{600_t}$. Despite recent discussion on the importance of within-reach heterogeneity of *k* [@botterHeterogeneityMattersAggregation2021], reach-averaged values are suitable for the global scale where a coarser resolution must be adopted to facilitate computation.

Under this conceptual river reach, we write $k_{600_t}$ as a function of SWOT-observables $W_{i,t}$ and $S_{i,t}$. This algebra is carried out using equation 8, the fitted value for $\beta_1$ from Figure 3d (`r round(modelsWIDE[modelsWIDE$name == 'Chainsaw-eD',]$coef,2)`), and Manning's equation for mean flow velocity ($\bar{U}=\frac{1}{n}R_h^{2/3}S^{1/2}$). This algebra yields equation 10, assuming that the channel is hydraulically-wide ($R_h = H =\frac{A}{W}$). To leverage additional SWOT data, the wetted channel area *A* is further split into the SWOT-observable portion $dA_{i,t}$ and the unobservable portion $A_0_i$ following @durandEstimatingReachaveragedDischarge2014. *dA* is also readily approximated using SWOT measurements if assuming a rectangular river channel ($dA_{i,t} \approx \delta H_e_{i,t}*W_{i,t}$), which is again valid in a hydraulically-wide channel.

$$\begin{eqnarray} k_{600_t} = 62.82 g^{7/16}S_{i,t}^{9/16}\frac{1}{n_i}^{1/4}(\frac{A_0_i+dA_{i,t}}{W_{i,t}})^{35/48} \end{eqnarray} \mathbf{(10)}$$
Next, equation 10 is written as a Bayesian sampling model, in which all of the SWOT observations are sampled from the unknown model parameters ($A_0_i$, $k_{600_t}$, and $n_i$). This is equation 11 after describing them as log-normal distributions. $\sigma_{k_{600}}^2$ refers to the total uncertainty implicit in equation 10. This uncertainty is due to parameter uncertainty from equation 8, Manning's equation, and the rectangular channel assumption.

$$\left[log(62.82) + \frac{7}{16}log(g) + \frac{9}{16}log(S_{i,t}) - \frac{35}{48}log(W_{i,t})\right] \sim normal\left(\left[log(k_{600_t})+\frac{1}{4}log(n_i)-\frac{35}{48}log(A_0_i+dA_{i,t})\right], \sigma^2_{k_{600}}\right) \mathbf{(11)}$$
Equations 9 and 11 also necessitate that we specify prior distributions for the parameters $A_0_i$, $k_{600_t}$, and $n_i$. Prior distributions, described by their hyperparameters, formalize the a priori estimates (and uncertainties) for the non-remotely-sensed terms. More intuitively, BIKER priors represent our 'prior river knowledge' of what $A_0_i$, $k_{600_t}$, and $n_i$ probably are for some river since they cannot be directly remotely sensed, but educated guesses can be made using the SWOT data available to us. This is sometimes referred to as the 'empirical Bayes method'. Our goal in prior specification was to rely on absolutely no in situ information such that we could run this method on any river on Earth solely using SWOT observations. In theory, more informed priors via various a priori information about a specific river would improve BIKER performance, but here we chose to test only the fully generalized algorithm. Therefore, the validation presented here is a 'worst-case scenario', wherein BIKER performance will improve with better prior information on the river. In that context, we used a variation of the prior specification method developed by @brinkerhoffConstrainingRemoteRiver2020, who developed geomorphic 'river types' with distinct prior hyperparameter sets for $A_0_i$ and $n_i$. These hyperparameters are assigned to a river solely using SWOT observables, therefore meeting our needs for complete global implementability. Hyperparameter assignment for $k_{600_t}$ was developed similarly (all hyperparameter specifications are elaborated on in Texts S3 and S4).

With the sampling model defined ($f(x|\Theta)$ = equation 11) and hyperparameters $p(x0$) described (Texts S3 and S4), a joint posterior distribution conditional on the SWOT observations ($p(\Theta|x) \propto f(x|\Theta)p(x)$) is specified. To approximate this distribution, we use a Markov Chain Monte Carlo (MCMC) algorithm implemented using the Stan probabilistic programming language. Specifically, Stan uses a Hamiltonian Monte Carlo sampler which reduces computation time relative to other sampling algorithms [@hagemannBAMBayesianAMHGManning2017].

#### 4.1.2 BIKER validation
We validate BIKER on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-simulated rivers (section 2) using daily observed hydraulics. We also re-validate BIKER on the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])` rivers with the SWOT error model which corrupts the SWOT measurements (widths, heights, and slopes).

We do not have observed $k_{600_t}$ data for these rivers and, to our knowledge, no field dataset of $k_{600}$ exists in the type of temporal and spatial frequency that SWOT (and therefore the BIKER algorithm) provides. Thus, we take the model outlined in equation 7 and Figure 3d and use that to calculate the observed $k_{600_t}$ that BIKER is validated against (equation 12). This directly explores BIKER's ability to infer observed $A_0_i$, $k_{600_t}$, and $n_i$ simultaneously from $W_{i,t}$ and $H_{i,t}$ alone and was deemed acceptable given that the $k_{600}$ model (equation 7) has already been successfully validated in Figure 3d.

$$k_{600_{obs}}=62.82(gS_{obs})^{7/16}\bar{U}_{obs}^{1/4}H_{obs}^{9/16} \mathbf{(12)}$$
It also means that, for a fair validation scheme, the parameter specification for $\sigma^2_{k_{600}}$ in equation 11 should not include the uncertainty from equation 8. So for this validation only, $\sigma^2_{k_{600}}$ is set to 0.30 (natural-log space) to reflect uncertainty from Manning's equation and assuming a rectangular channel (Text S4). However, if BIKER is run on real SWOT observations after the satellite launches, $\sigma^2_{k_{600}}$ should reflect the total uncertainty, which is described in Text S4.

With the setup described by equations 11 and 12, validation is performed using the BIKER posterior means. Because we are most interested in BIKER's ability to correctly infer temporal dynamics in $k_{600}$, and each river's priors are described specifically for that river, we validate by river. These metrics are defined in Table S2 and consist of the correlation coefficient *r* to quantify accuracy of BIKER's temporal dynamics, the root mean square error normalized by the observed mean (NRMSE) and prediction bias normalized by the observed mean (rBIAS) to assess bias, and the Kling-Gupta Efficiency (KGE). KGE is frequently used to assess streamflow prediction and simultaneously assesses accuracy in both bias and dynamics. While a value greater than -0.41 means the model outperforms a uniform prediction of the mean [@knobenTechnicalNoteInherent2019], generally KGE scores are interpreted as being meaningful in ungauged settings if > 0.

#### 4.1.3 Carbon efflux validation
It is one thing to accurately model the temporal dynamics of $k_{600}$, but researchers are often most interested in the actual gas fluxes from rivers and ultimately the carbon emitted from river to atmosphere. Therefore, we also explore BIKER's ability to reproduce $FCO_2$ (equation 1) and the bulk carbon efflux from these `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers. To do this, we pair the 26 biweekly $CO_2$ and water temperature samples from @beaulieuControlsGasTransfer2012 (section 2, figure S1) with every 14th set of daily SWOT observations (as the $CO_2$ data is bi-weekly). Conveniently, this is very close to the nominal average sampling resolution for SWOT (11 days). Not all of the SWOT rivers have observations for a full year, and when simulation dates are not available they are assumed to start on January 1st. We then calculate $FCO_2$ using equation 1 and assuming atmospheric $CO_{2_{air}}$ is 390 uatm. Equation 13 is used to obtain a temperature and $CO_2$ specific gas exchange velocity from BIKER's output, where the Schmidt number *Sc* was estimated following @raymondScalingGasTransfer2012. We then estimate median and mean bulk carbon effluxes by multiplying the median or mean $FCO_2$ value across all rivers and timesteps (in Tg-C/yr) by the total average surface area of all 47 rivers.

$$k_{CO2, temp}=k_{600}*(Sc/600)^{-1/2} \mathbf{(13)}$$
Finally, we also compare BIKER's outputs with established in situ methods, whose specific details and parameters are provided in Table S3. Because streamflow measurements and models are vastly more frequent than measurements of river channel geometry, these in situ models are used to predict reach-averaged flow depth and flow velocity as functions of streamflow. Their outputs are in turn used to estimate *k* in upscaling workflows. Therefore, they rely on in situ streamflow records or high-quality streamflow routing outputs (unlike BIKER, which only requires a river be SWOT-observable). This allows us to assess whether BIKER's estimates (wholly ungauged) are comparable to gauged methods (all three HG models). Of the three models tested here, one is trained on the @brinkerhoffReconcilingAtaStationAtManyStations2019 dataset, and two are previously published models [@raymondGlobalCarbonDioxide2013; @raymondScalingGasTransfer2012].

### 4.2 Section 4 results
#### 4.2.1 BIKER
First, we explore whether general trends are correctly captured by BIKER, assuming no SWOT measurement error. Figure 4 plots BIKER-inferred $k_{600}$ against the $k_{600}$ calculated using in situ hydraulics across all  rivers and all timesteps. The points are the posterior means while the black lines are the 95% confidence intervals (CIs) for the predictions. Points are also colored by river. Using absolutely no in situ information, BIKER reasonably captures the magnitude of the predictions and most points fall on or near the 1:1 line across all  `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers. However, it is clear that some rivers perform better than others. Next, we look at individual river predictions, which we are most interested in.

![Figure 4. Validation of BIKER. Black bars are 95% CIs for the modeled values. The dashed grey line is 1:1 line. Colors correspond to rivers.](cache/validation/validation.jpg)

Figure 5 plots all `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` timeseries plots of predicted and observed $k_{600}$, again assuming no SWOT measurement error. Note that the y axis is normalized by maximum observed values to compare rivers. In general, temporal dynamics of $k_{600}$ are reproduced quite well by BIKER, however there is often positive bias in the estimates (e.g. Olentangy River). Some rivers are predicted nearly perfectly (e.g. Brahmaputra, Ohio Section 3, Wabash) while others perform more poorly (e.g. San Joaquin, Stanislaus), though again much of this error stems from errors in predicting the magnitude of $k_{600}$ rather than the temporal dynamics. Rivers where the temporal dynamics are more poorly inferred tend to have shorter timeseries (e.g. Merced River, Tuolumne River). **Maybe add something here comparing the k600 prior to these results?**. Next, we explicitly quantify each rivers' performance.

![Figure 5. River timeseries plots of $k_{600}$. Orange is calculated via observed hydraulics, while green is BIKER. The green ribbon indicates the 95% CIs for the predicted values. Y axis is normalized by maximum observed values to compare visually.](cache/validation/timeseries_noerr.jpg)

We calculate performance metrics following section 4.1.2 and Table S2. These are presented in Figure 6a, which plots validation metrics calculated for each river with and without SWOT measurement error (green and purple, respectively). SWOT measurement errors negligibly influence BIKER's performance across all four error metrics (Figure 6a), though caution should be used in over-interpreting boxplots with a sample size of only `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])`. Given Figure 6a, we deem that SWOT measurement error does not exert a significant influence on BIKER and so the results presented for the rest of the manuscript assume no measurement error in order to use all `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers.

![Figure 6. a: Performance metrics by river. See Table S2 for metric definitions. b: *r* versus the number of SWOT observations used in the Bayesian inversion. c) *r* versus the mean river width. As expected, performance improves with more data. Dashed lines denote scores of 0, 0.50, and 1. CIs.](cache/validation/validation_by_river.jpg)

Median river-specific $KGE$ is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$KGE, na.rm=T),2)` and median river-specific *r* is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$r, na.rm=T),2)`. This indicates very strong inference of each river's temporal $k_{600}$ dynamics. These scores are excellent given that absolutely no in situ information is being used to predict $k_{600}$. NRMSE has a median score of `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$NRMSE, na.rm=T),2)`, which is reasonable for a completely ungauged method. These are comparable to the best NRMSE scores achieved by recent versions of the SWOT RSQ algorithms [@frassonExploringFactorsControlling2021]. Median rBIAS is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`, which is again excellent. However, the shape of the rBIAS boxplot in Figure 3a highlights a large portion of rivers which have a positive bias (Figure 5 also confirms this). Taken in aggregate, Figures 4-6 indicate that BIKER is quite good at capturing temporal dynamics in $k_600$, however there is often positive bias in its estimates. This necessarily increases the NRMSE scores to be relatively worse than *r* or KGE. This is discussed in more detail in section 6.

Finally, Figure 6b highlights one benefit of using Bayesian inference to estimate $k_{600}$: because the posterior is conditional on the SWOT observations, performance should improve with more data. Figure 6b plots by-river *r* scores versus the number of SWOT observations. While performance does not directly increase from having more data, very poor performances disappearas the amount of availble data increases. The vast majority of the extremely poorly performing rivers are limited to those with only 12 days of SWOT observations. This bodes well for future SWOT implementation, which has a nominal life-cycle of three years. This relationship also exists between mean observed river width and *r* (Figure 6c), where wider rivers have better BIKER performance. However, it is impossible to say whether this is a genuine trend or an artifact of the specific rivers being tested, where the larger rivers often have longer timeseries.

#### 4.2.2 Carbon efflux
Next, we compare BIKER's estimates of carbon fluxes against established in situ techniques. It is important to remember that only BIKER is completely globally implementable, while the other three models presented necessarily rely on having a streamflow record readily available. Therefore, the HG methods reflect their 'best-case scenarios' while BIKER reflects its worst case scenario, where priors are set entirely from SWOT observations and are generally the least informative they will ever be.

Figure 7a evaluates the $FCO_2$ estimates using the same 4 error metrics as Figure 6a. BIKER, the sole remote technique, is in red while the three in situ techniques are plotted as different shades of purple. We see that BIKER performs slightly worse than all three in situ methods across all metrics except *r*, where it performs similarly to the 'Raymond 2013' model. **NEED ACTUAL NUMBERS HERE**. However, across all 47 rivers BIKER has the least overall bias in its estimates (**add number here**). In summary, BIKER performs slightly worse than the in situ tools, as expected. However, the drop in performance is not substantial and promising given that the in situ models represent their best case scenarios (perfect in situ discharge records) and these BIKER results are the worst-case scenario (relatively uninformed priors).

![Figure 7: a) FCO2 validation for BIKER and the three in situ HG models. b) Mean carbon efflux across all rivers and timesteps, accounting for surface area. d) Median carbon efflux across all rivers and timesteps, accounting for surface area. Completely remotely-sensed methods are colored in red, in situ methods in purple, and the obserevd values in orange.](cache/FCO2/FCO2_models.jpg)

Figures 7b and 7c compares the bulk carbon efflux (via $F_{CO_2}$) from the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers using BIKER posterior means and the three streamgauge-based HG models. For the means, all estimates are positively biased, with BIKER (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_BIKER',]$sumFCO2, 2)` gG-C/yr) and 'Raymond 2013' (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2013',]$sumFCO2, 2)` gG-C/yr) the most overestimated relative to the observed flux (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_obs',]$sumFCO2, 2)` gG-C/yr). However, this is evidently due to one or a few significantly biased outliers, as median fluxes are nearly perfectly captured by BIKER (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_BIKER',]$medianFCO2, 2)` gG-C/yr) and 'Raymond 2012' (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2012',]$medianFCO2, 2)` gG-C/yr) versus the observed flux (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_obs',]$medianFCO2, 2)` gG-C/yr). The two remaining models are still overestimated, though less so than for the mean flux. Thus, despite BIKER using absolutely no streamgauge or other in situ data like the other 3 methods do, it provides a reasonable upscaling estimate of the bulk carbon efflux across many rivers (Figure 6c). This is promising for BIKER's implementation within future upscaling workflows.

## 5 Discussion
### 5.1 Gas exchange in hydraulically-wide rivers
**REWRITE THIS**
Field studies of gas exchange in wide rivers have suggested that their *k* properties behave differently than in steeper and smaller rivers [@ulsethDistinctAirWater2019; @beaulieuControlsGasTransfer2012; @alinPhysicalControlsCarbon2011; @wangPhysicallyBasedScaling2021]. While much work has focused on the small-stream side of the stream-to-river continuum, @moogAirWaterGasTransfer1999 proposed a conceptual model for gas exchange in low turbulence, small roughness flows (which coincides with large rivers). Figure 3d is to our knowledge the first empirical confirmation that the chainsaw model is valid in rivers (at least hydraulically-wide ones). Future tests should be performed to explore it's feasibility in smaller streams and/or other aquatic environments where turbulence is also generally low. We are not accounting for dissipation generated via wind shear, as none of these hydraulics-driven gas exchange models do. We suspect that this model will be less representative in less-sheletered rivers where wind becomes a driving factor of gas exchange rates, however this model setup is a good start towards coupling hydraulics-driven gas exchange with wind-driven gas exchange. Such a model would likely take a form similar to the conceptual model proposed by @wangPhysicallyBasedScaling2021.

### 5.2 Towards remote sensing of global spatiotemporal dynamics of *k* in large rivers
To date, the studies exploring the spatiotemporal dynamics of riverine gas exchange have arguably been held back by a lack of data. A few studies have investigated these dynamics, but they have been limited to individual rivers and/or limited field seasons [@hallAirWaterOxygen2012; @sand-jensenCO2DynamicsDanish2012]. For example, @wallinSpatiotemporalVariabilityGas2011 performed a preliminary analysis in northern Sweden relating cross-section specific temporal variability in gas exchange with channel slope, but they were limited to a mean of only 8 measurements per river in a single watershed.

Therefore, estimating *k* from SWOT data is an attractive option, at least for exploring its spatiotemporal dynamics at fine temporal resolution and at the global-scale. Section 5 shows that BIKER successfully infers the temporal dynamics of $k_{600}$ using simulated SWOT data over a wide range of rivers and with implicit measurement errors accounted for (Figures 4-6). This bodes well for BIKER's eventual implementation on real SWOT observations, as does BIKER's improved performance with longer timeseries (Figure 6b). The nominal three-year SWOT campaign will provide hundreds of observations for most rivers, suggesting even better BIKER inversions than those presented here. All of this suggests that near-daily estimation of global riverine gas exchange and its temporal dynamics could be possible once SWOT launches.

With that said, Figures 4-7 highlight a substantial range of algorithm performances across rivers. These differences in performance are likely due to the representativeness of the priors used for that river. For SWOT discharge algorithms, authors have repeatedly shown that the 'quality' of prior hyperparameters plays a large role in the success of discharge inversions [@frassonExploringFactorsControlling2021; @andreadisConstrainingAssimilationSWOT2020; @brinkerhoffConstrainingRemoteRiver2020; @tuozzoloEstimatingRiverDischarge2019] and our results here further corroborate this finding. It should be stressed that a substantial portion of rivers from [@frassonExploringFactorsControlling2021] are canal-shaped in nature, suggesting different hydraulic properties than a natural river channel. Nearly universally, these rivers underperformed (Figure 5), however it is impossible to isolate whether that is due to channel geomorphology or the fact that these canals also usually had short timeseries (usually only 12 days).

### 5.3 Towards remotely sensing riverine carbon emissions using SWOT
Figure 7 confirms that BIKER is quite successful, without any in situ information aside from a $CO_2$ logger, at predicting both $FCO_2$ (Figure 6a) and 2) the bulk carbon efflux (Figure 7b-7c). This encouraging result has two main implications for future work coupling remote sensing via SWOT with in situ data. First, it confirms that we can couple BIKER and SWOT with in situ gas concentration loggers to produce reasonable $FCO_2$ estimates at novel temporal resolutions in SWOT-observable rivers. This is particularly useful given recent advances in in situ gas concentration loggers [e.g. @ahoHighestRatesGross2021] but no such similar advances in modeling *k* at equivalent temporal resolutions. BIKER can likely also be ran at the field scale using arrays of pressure transducers to estimate water surface slope (rather than using satellite-based altimeters like SWOT) following recent similar work for estimating streamflow [@harlanDischargeEstimationDense2021].

Secondly, it is important to again stress that unlike BIKER, the HG models in Figure 7 rely on an in situ streamgauge. This means that Figure 7 represents the best performance that those models could ever have, while BIKER represents the worse performance it could ever have. If the HG models are ran using modeled discharge, their accuracy would necessarily decrease. Thus, these results suggest that BIKER will be useful in not only assessing gas exchange velocities, but also in providing additional measurements to upscaling workflows that rely on modeled streamflow [e.g. **Liu etal in review**].

## 6 Conclusions
Gas exchange from aquatic systems has been studied for nearly a century and dozens of predictive equations have been developed to obtain *k* values from easily measured hydraulic properties rather than via direct measurement. Likewise, equation 3 has been repeatedly verified across many non-fluvial environments. However. despite renewed interest in fluvial gas exchange in the last decade or so, there are considerable uncertainties in how fluvial *k* varies with respect to time. This is generally due to a lack of direct measurements of $k_{600}$. In this paper, we propose that the soon-to-launch SWOT satellite will provide enough hydraulic measurements to analyse the temporal dynamics of $k_{600}$, given that there is a robust way to ingest SWOT measurements and infer gas exchange velocities from those measurements.

In that context, we develop the BIKER algorithm to infer $k_{600}$ from simulated SWOT measurements, showing strong recovery of rivers' temporal $k_{600}$ dynamics and relying on absolutely no on-the-ground information. We also pair BIKER with an in situ $CO_2$ logger and show strong performance in reproducing $CO_2$ evasion fluxes and bulk carbon efflux from the rivers' combined surfaces. These strong results functionally open the door for global-scale, near daily estimates of fluvial gas exchange velocity once SWOT launches in 2022. This unprecedented amount of data should allow for significant insights into the temporal dynamics of fluvial gas exchange in large rivers around the world.

## 7 Acknowledgements
C.B. Brinkerhoff was funded on **FINESST**. The version of BIKER used in this study is available at **citable code here**. BIKER remains in active development and is available for download at https://github.com/craigbrinkerhoff/BIKER. All code to build and generate results, figures, and the manuscript is available at https://github.com/craigbrinkerhoff/RSK600. We thank Renato Frasson, Michael Durand, Amber Ulseth, and Jake Beaulieu for generously making their data available for this study. We also thank the entire SWOT discharge working group for their decade-plus body of work which inspired this study.

## 8 Apendix A
*Table A1: Variable description and notation for this study. ADD THE BAYES PARAMETERS YET* 

|**Notation**|**Description**|**Calculation (if applicable)**|**Units**|
|------------|---------------|-------------------------------|---------|
|$A$|Channel cross-sectional area|NA|$[L^2]$|
|$A_0$|Median cross-sectional area|NA|$[L^2]$|
|$A_p$|Active-zone fraction|$A_p \propto (\frac{U_*H}{v})^{1/2}$ [@moogAirWaterGasTransfer1999]|unitless|
|*Bulk carbon efflux*|carbon mass transport rate from river to atmosphere|NA|$[\frac{M}{T}]$|
|$CO_{2_{water}}$|Water-side $CO_2$ concentration|NA|$[L]$|
|$CO_{2_{air}}$|Atmospheric-side $CO_2$ concentration|NA|$[L]$|
|$dA$|change in cross-sectional area|$\delta H_e*W$|$[L]$|
|$D_m$|Molecular diffusion coefficient|NA|$[\frac{L^2}{T}]$|
|$\epsilon$|Dissipation rate of near-surface turbulence|NA|$[\frac{E}{M*T}]$|
|$\epsilon_S$|Dissipation rate of bottom-generated turbulence|log-law-of-the-wall model: $\frac{U_*^3}{H}$|$[\frac{E}{M*T}]$|
|$\epsilon_D$|Dissipation rate of form-drag turbulence|form-drag model: $gS\bar{U}$ [@moogStreamReaerationNonuniform1999]||$[\frac{E}{M*T}]$
|$FCO_2$|$CO_2$ evasion flux from river to atmosphere|NA|$[\frac{M}{L^2T}]$|
|$g$|gravitational acceleration|9.8|$[\frac{L}{T^2}]$|
|$H$|Mean flow depth|$A/W$|$[L]$|
|$H_e$|Water surface elevation|NA|$[L]$|
|$i$|Spatial discretization step in mass-conserved river reach|NA|NA|
|$k$|gas exchange velocity|NA|$[\frac{L}{T}]$|
|$k_{600}$|gas exchange velocity normalized to $Sc=600$|$(\frac{600}{Sc_k})^{-0.5}k$ [@raymondScalingGasTransfer2012]|$[\frac{L}{T}]$|
|*$k_{model}$|riverine gas exchange velocity estimated by predictive models|NA|$[\frac{L}{T}]$|
|$n$|Manning's roughness coefficient|$\frac{R_h^{2/3}S^{1/2}}{\bar{U}}$|$[\frac{T}{L^3}]$|
|$\uprho$|Density of water|NA|$[\frac{M}{L^3}]$|
|$R_h$|Hydraulic radius|$\frac{AW}{2H+W}$|$[L]$|
|$S$|River slope|NA|$unitless$|
|$Sc$|Schmidt number|$\frac{v}{D_m}$|$unitless$|
|$t$|temporal discretization step in mass-conserved river reach|NA|NA|
|$\bar{U}$|Cross-sectional average velocity|NA|$[\frac{L}{T}]$|
|$U_*$|Shear velocity|$\sqrt{gSR_h}$|$[\frac{L}{T}]$|
|$\mu$|Viscosity|NA|$[P*T]$|
|$v$|kinematic viscosity|$\frac{\mu}{\uprho}$|$[\frac{L^2}{T}]$|
|$W$|Flow width|NA|$[L]$|




## References
