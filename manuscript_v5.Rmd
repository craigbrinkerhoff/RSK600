---
title: "Gas exchange in large rivers influenced by largest turbulent eddies: implications for remotely sensing gas exchange via the SWOT satellite"
author:
  - Craig B Brinkerhoff:
      email: cbrinkerhoff@umass.edu
      institute: UMass
      correspondence: true
  - Colin J Gleason:
      institute: UMass
  - Christopher J Zappa:
      institute: Lamont
  - Peter A Raymond:
      institute: Yale
  - Merritt H Harlan:
      institute: UMass
institute:
  - UMass: Department of Civil & Environmental Engineering, University of Massachusetts
  - Lamont: Lamont-Doherty Earth Observatory, Columbia University
  - Yale: School of the Environment, Yale University
bibliography: References.bib
csl: agu_citation_style.csl
output:
  word_document:
      pandoc_args:
        - '--lua-filter=scholarly-metadata.lua'
        - '--lua-filter=author-info-blocks.lua'
      reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Key Points
- Both large and small scale eddies control gas exchange in hydraulically wide rivers
- BIKER algorithm exploits this theory, predicting gas exchange velocity and $CO_2$ fluxes from simulated SWOT satellite data and in situ $CO_2$ data
- BIKER is also robust to measurement errors internal to the SWOT river measurements

## Keywords
gas exchange, fluvial geomorphology, open-channel flow, remote sensing, SWOT, biogeochemistry, ungauged basin

## Abstract
UPDATE

Extensive research over the past two decades has shown that the global river network emits significant amounts of carbon dioxide ($CO_2$) to the atmosphere via gas evasion, a diffusive flux across the air-water interface. This global flux is still relatively poorly constrained, with much ambiguity coming from mechanistic and predictive uncertainties in the gas exchange velocity (the rate of this diffusion). We propose that the NASA/CNES/USKA/CSA SWOT satellite, set to usher in a new age of river hydrology research at the global scale, will provide similarly transformative insights to fluvial gas exchange modeling. Here, we present work predicting gas exchange velocity using SWOT observations. We exploit the unique geomorphology of SWOT-observable rivers to develop a process-based model that is nearly entirely remotely sensible. We then couple this model with established Bayesian techniques to develop BIKER, or the 'Bayesian Inference/Inversion of the k600 Exchange Rat' algorithm. We validate BIKER on 47 SWOT-simulated rivers and over 700 discrete measurements of river gas exchange, yielding 1) a theoretical model that explains 64% of variation in gas exchange in SWOT-observable rivers and 2) an algorithm that predicts this theoretical model solely from SWOT observations with a median normalized RMSE of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==0,]$nrmse), 2)`. Additionally, by-river performance improves as the amount of available SWOT data increases. BIKER is also robust to measurement errors implicit in the SWOT data, with a median normalize RMSE of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==1,]$nrmse), 2)`. With SWOT set to launch in 2022, we suggest that BIKER might address the lack of data on gas exchange in large rivers and help to better constrain current and future fluvial gas evasion models at the global scale.

## Plain Language Summary
*Necessary for AGU advances (200 words)*

## 1 Introduction
Natural systems play a fundamental role in the budgeting and accounting of the global carbon cycle under climate change. Since the publication of @colePlumbingGlobalCarbon2007, the global river network is recognized to emit substantial amounts of carbon to the atmosphere, in addition to exporting it to the oceans. Current estimates of total carbon dioxide evasion ($FCO_2$) to the atmosphere from the global river network vary from 650-1800 Tg C/yr [@lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013] (*Liu etal in review*), with 167 Tg-C/yr coming from mountain streams alone [@horgbyUnexpectedLargeEvasion2019]. Despite its incredibly small percentage of the global land surface [0.47%- @raymondGlobalCarbonDioxide2013], this flux is on par with the total oceanic $CO_2$ uptake rate [@gruberOceanicSinkAnthropogenic2019; @horgbyUnexpectedLargeEvasion2019] and the global forest carbon uptake rate [@panLargePersistentCarbon2011]. It is still relatively poorly constrained but is clearly a critical component of the global carbon cycle. Equation 1 represents this flux given the gas concentration gradient between the water $CO_{2_{water}}$ and the air $CO_{2_{air}}$ and the gas exchange velocity *k*. Consult Appendix A for variable nomenclature used in this study.

$$\mathbf{(1)} FCO_2=k(CO_{2_{water}}-CO_{2_{air}})$$

The structure of equation 1 necessitates that calculations of this flux are highly sensitive to one's measurements/estimates of *k* [@hallGasExchangeStreams2020]. More broadly, fluvial *k* for various dissolved gases are of significant importance to aquatic ecologists modeling stream metabolism [e.g. @bernhardtMetabolicRegimesFlowing2018] and water quality engineers modeling river responses to pollutant loadings [among other things- @chapraSurfaceWaterQualityModeling2008]. Because of this far-reaching importance, decades of work have focused on elucidating the physical mechanisms behind *k* in oceans and lakes [@wanninkhofAdvancesQuantifyingAirSea2009 for a review] and, to a lesser extent, fluvial gas exchange [@hallGasExchangeStreams2020 for a review]. Given that *k* should scale with near-surface turbulence in a turbulent flow [@hallGasExchangeStreams2020], extensive field and labratory experiments have converged on the 'small-eddy model' as proposed by @lamontEddyCellModel1970, which scales *k* via the smallest-scale turbulent eddies [e.g. @lorkeUnifiedScalingRelation2006; @zappaEnvironmentalTurbulentMixing2007; @zappaVariationSurfaceTurbulence2003; @moogStreamReaerationNonuniform1999; @vachonRelationshipNearsurfaceTurbulence2010]. This model is provided as equation 2, where $\epsilon_S$ is the dissipation rate of near-surface turbulence, $v$ is the kinematic viscosity, *Sc* is the Schmidt number. Note that directly measuring $\epsilon_S$ is non-trivial and a frequent model is to impose the log-law-of-the-wall to scale bottom shear to the surface (Appendix A).

$$\mathbf{(2)} k\sim Sc^{-1/2}(v\epsilon_S)^{1/4}$$

While this model works reasonably well in non-fluvial environments where turbulence production is mostly limited to bottom shear or wind shear [e.g. @lorkeUnifiedScalingRelation2006; @zappaEnvironmentalTurbulentMixing2007], there is considerable uncertainity in how it applies to fluvial systems. First, 'bubble-mediated gas exchange' in whitewater might lead to substantially higher *k* in small mountain streams with very large bedload [@hallAirWaterOxygen2012; @ulsethDistinctAirWater2019]. Another approach is to model *k* via 'form-drag shear' (i.e. total stream power per unit mass water) that captures frictional resistance via river channel banks, meanders, bars, etc. [@moogStreamReaerationNonuniform1999]. Authors have since shown that this model reasonably predicts *k* in rivers [@raymondScalingGasTransfer2012; @ulsethDistinctAirWater2019], though it requires good estimates of the average flow velocity. Compared to small streams, relatively little attention has been paid to gas exchange in very large rivers. Large rivers are often conceptualized as a hybrid condition of both fluvial and non-fluvial *k* dynamics. The handful of existing field studies of large-river *k* suggest that *k* begins to be influenced by wind shear once the water surface is less protected, though little else is well-established [@alinPhysicalControlsCarbon2011; @beaulieuControlsGasTransfer2012; @wangPhysicallyBasedScaling2021]. These mechanistic uncertainties are additionally limited by a dearth of field-measured fluvial *k*. @wangPhysicallyBasedScaling2021 attempted to address this by simulating *k* in 35 rivers using a stream metabolism model [@applingOvercomingEquifinalityLeveraging2018] and in situ dissolved oxygen (DO) datasets to implicitly solve for *k*. They found that equation 2, coupled with $\epsilon$ modeled via the log-law-of-the-wall, is valid in their simulated rivers and that *k*~streamflow relationships break down in large rivers. However, their simulated rivers were limited by a lack of hydraulic measurements and had to rely on hydraulic geomtery models to estimate river depth and velocity. Further, they did not assess model fit in very steep systems [@ulsethDistinctAirWater2019] and stopped short of parsing out hydraulic explanations for their results.

These mechanistic uncertainties are then propogated through upscaling workflows when biogeochemists predict *k* across thousands of rivers [e.g @borgesGloballySignificantGreenhousegas2015; @horgbyUnexpectedLargeEvasion2019; @lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013] via equation 1 coupled with hydraulic geometry [HG: the scaling relationships between streamflow and river channel hydraulics- @leopoldHydraulicGeometryStream1953]. It is currently not well understood how sensitive global estimates of fluvial gas evasion are to the specific HG model that is employed by the worker. Further, these approaches rely on either in situ discharge records or modeled streamflow which introduces additional uncertainities. This is all exacerbated in ungauged basins that cover large areas, especially in the carbon-rich Arctic inland waters, where little in situ information is available and fieldwork is impractical [@gleasonRemoteSensingRiver2019].

A potential alternative to this upscaling approach is to directly estimate a river's hydraulic properties from remote sensing (RS) data. Remote sensing of river hydraulics is a burgeoning subfield within remote sensing of hydrology, often in service of remote sensing of river discharge [RSQ- @gleasonRemoteSensingRiver2019]. This is accomplished via two general approaches: 'gauged' methods which rely on in situ river data to calibrate one's method to the river(s) at hand and 'ungauged' techniques which focus on hydraulic generalizability in the service of merely improving existing knowledge in data-poor domains [@gleasonRemoteSensingRiver2019]. Many, but not all, of these ungauged approaches are developed in the context of the upcoming NASA/CNES/UKSA/CSA Surface Water and Ocean Topography (SWOT) satellite mission. SWOT is expected to launch in 2022 and provide the world's first global measurements of water surface extent and elevation at novel temporal resolutions. SWOT is a wide swath radar interferometer and will sample rivers every 1 to 7 days per 21 day repeat cycle and will measure rivers wider than 100m with a goal of expanding this to rivers at least 50m wide [@biancamariaSWOTMissionIts2016]. A decade of SWOT work has explored the multi-parameter problem of estimating the river hydraulic parameters of roughness and bathymetry from remote sensing to produce the SWOT discharge product [e.g. @andreadisConstrainingAssimilationSWOT2020; @brinkerhoffConstrainingRemoteRiver2020; @durandEstimatingReachaveragedDischarge2014; @garamboisInferenceEffectiveRiver2015; @gleasonRetrievalRiverDischarge2014a; @garamboisVariationalEstimationEffective2020; @brissetAssimilationAltimetricData2018; @hagemannBAMBayesianAMHGManning2017; @larnierRiverDischargeBathymetry2020a; @oubanasDischargeEstimationUngauged2018].

In this context, here we borrow tools from fluvial geomorphology and revist the fundamental mechanisms behind gas exchange in large rivers to answer the following question: does the small-eddy model work in large rivers like those that SWOT will observe? We exploit the findings from this analysis to develop a novel methodology that predicts $k_{600}$ (*k* normalized to a Schmidt number of 600) and its explicit uncertainity solely using SWOT observations. The method requires no in situ inputs of any kind (although in situ data can be ingested and will improve results). We name the RS of $k_{600}$ algorithm BIKER, or the 'Bayesian Inference/Inversion of the $k_{600}$ Evasion Rate' and validate it for 47 SWOT-observable rivers from around the world using hydraulic models to produce SWOT-like data (as SWOT has not yet launched). We also quantify BIKER's sensitivity to the expected SWOT measurement errors on 17 of those rivers: while SWOT data represent a sea change in inland water monitoring, it is expected to have an approximately 10cm error in water surface elevation [@biancamariaSWOTMissionIts2016] as well as river width errors [@frassonExploringFactorsControlling2021]. Finally, we use previously published dissolved $CO_2$ data to represent a hypothetical in situ $CO_2$ sensor and compare the bulk carbon efflux from the 47 rivers as calculated using BIKER and previously published in situ techniques for predicting $k_{600}$.

## 2 Data
Numerous datasets were used in this study. Please see Figure 1 for a map of the approximate locations for the data used in this study. We also provide a flowchart detailing the entire study as Figure S1.

![Figure 1: Map of the 47 hydraulic models and 1 timeseries of CO2 samples used in this study. Note that hydraulic model locations are approximate as some of the models are not geo-referenced. Not mapped here are over 170,000 discrete measurements of river channel hydraulics from across the continetal United States (Brinkerhoff et al. 2019) and 763 gas exchange velocity measurements (Ulseth et al. 2019; Raymond et al. 2012; Churchill et al. 1964; Owens et al. 1964).](cache/maps/map_fin.jpg)

Gas exchange theory (section 3) is explored using multiple datasets which measured and/or collected from the literature 763 measurements of stream hydraulics and $k_{600}$. This is, to our knowledge, the largest collection of field-measured river and stream $k_{600}$. 701 of these measurements were previously collected from other studies by @raymondScalingGasTransfer2012 and @ulsethDistinctAirWater2019. The remaining measurements were added by us but measured by @churchillPredictionStreamReaeration1964 and @owensReaerationStudiesStreams1964. See Table S1 for a complete list of the studies that collected these measurements. To assess general hydraulic conditions in rivers across geographic contexts, we additionally use a previously published compilation of field hydraulics measurements [@brinkerhoffReconcilingAtaStationAtManyStations2019]. These were originally made to calibrate United States Geological Survey (USGS) streamgauge rating curves. That dataset contains over 530,000 unique measurements of river channel velocity, width, and discharge from across the continental United States. This is to our knowledge the largest collection of field measurements of river channel hydraulics. Ultimately, this dataset was filtered down to 171,553 discrete measurements for this study (see Text S1 for our filtering protocol).

BIKER validation (section 4) was performed on 47 SWOT-simulated rivers. Because SWOT has yet to launch, it is standard practice to benchmark SWOT-related algorithms on "SWOT-like" data. These simulated rivers are simply river-reach-averaged hydraulic model outputs where the water surface heights and widths are labelled as RS observations and are used as the sole inputs to BIKER. Here, we use 47/51 rivers collected by @frassonExploringFactorsControlling2021 and @durandIntercomparisonRemoteSensing2016. These are the two benchmarking studies that have explored RSQ algorithm performance for the SWOT mission. The approximate locations of these rivers are plotted in Figure 1, and please consult both of those papers for all of the hydraulic model specifications. Ultimately, the 47 rivers are spread across the United States, France, Italy, the United Kingdom, and Bangladesh. We omit three models from @durandIntercomparisonRemoteSensing2016 because they lack enough hydraulic information to calculate the shear velocity $U_\star$, which is necessary for algorithm validation and is explained in section 4. These are two models for the Saint Lawrence River and one for the Tanana River.

To assess the influence of measurement error on BIKER's performance (section 4), we use the error model developed by @durandHowWillRadar2020 and implemented on 17/47 of the rivers by @frassonExploringFactorsControlling2021. Error in SWOT measurements will come from both the error tolerances intrinsic in the satellite data product as well as radar layover error. Layover error is the phenomenon when radar returns from different places arrive at the sensor at the same time, leading to taller landscape features appearing closer to the sensor than shorter landscape features that are the same horizontal distance from the sensor [@durandHowWillRadar2020]. Width errors due to poor water classification are ignored as they were in @frassonExploringFactorsControlling2021.

For the $CO_2$ evasion and carbon efflux calculations (section 5), we use 26 bi-weekly dissolved $CO_2$ samples made by @beaulieuControlsGasTransfer2012 at one location in the Ohio River for one calender year from 2008-2009 (Figure S2). Note that this $CO_2$ data is for the Ohio River only but was applied to all 47 rivers (which includes multiple sections of the Ohio River). Because we are exclusively interested in the relative differences between $FCO_2$ estimates and not the raw fluxes themselves, any $CO_2$ data representative of SWOT-observable rivers was deemed acceptable for this validation exercise.

## 3 Hydraulic geometry in large rivers and implications for scaling fluvial gas exchange velocity
Rivers and streams change predictably along their longitudinal profile from headwater to ocean. In general, as river size increases, channels become more rectangular, their shapes elongate (becoming wider quicker than they become deeper) and their hydraulic radii begin to approximate their mean flow depth (i.e. $R_h \approx H$). This is a common assumption in hydraulic and geomorphic modeling of large rivers, and occurs in `r round(percs[percs$flag_swot == 'SWOT' & percs$flag_hydraulicWide == 'Rh=H',]$perc,0)`% of our SWOT-observable river measurements but only `r round(percs_overall[percs_overall$flag_hydraulicWide == 'Rh=H',]$perc,0)`% of all `r sum(percs$n)` river measurements (see Text S1 for how we arrived at these numbers). These channels are often referred to as 'hydraulically wide'.

To model gas exchange velocity in hydraulically wide channels, we make some simplifying assumptions to equation 2. First, we impose the log-law-of-the-wall model for $\epsilon_S$ (Appendix A) on to the small-eddy model (equation 2) and simplify $R_H = H$, arriving at equation 3. Equation 4 further simplifies this for *k* normalized to a Schmidt number of 600, and with statistical parameter $\alpha$ reflecting both the scaling as well as the constant Schmidt number and viscosity [@wangPhysicallyBasedScaling2021]. Equation 4 thus defines gas exchange velocity solely as a function of water surface slope and average flow depth without a reliance on shear velocity, mean flow velocity, or $\epsilon_S$ at all. Again, this is hypothetically only valid in a wide channel.

$$\mathbf{(3)} k \sim Sc^{-1/2}v^{1/4}(gS)^{3/8}H^{1/8}$$
$$\mathbf{(4)} k_{600}=\alpha(gS)^{3/8}H^{1/8}$$

Alternatively, @moogAirWaterGasTransfer1999 noted that low-turbulence uniform channel flows often do not exhibit homogenous surface dissipation at their air-water interface. They proposed a conceptual 'chainsaw model' that relies on both small-scale eddies and large, depth-scale ones. It limits surface dissipation to only 'active zones' within which a homogenous dissipation rate occurs and the small-eddy model is valid. But, the fraction of the interface that are active zones is proportional to the larger, depth-scale eddies. This means that if the entire interface is treated as an active zone, the model would simply reduce to the small-eddy model. We chose to also test this model given that SWOT-observable rivers are generally large and low-turbulence (here, low-turbulence is realitive to the highly-turbulent water surfaces of small, steep streams with significant whitewater). Further, to our knowledge the chainsaw model has never been empirically tested, and so we explore it here. To do this, we impose a hydraulically wide channel on the chainsaw model just like we did to the small-eddy model and arrive at equation 5 (with statistical coefficient $\beta$). The result is identical to the hydraulically-wide small-eddy model (equation 4), except for the exponents, which are both steeper.

$$\mathbf{(5)} k_{600}=\beta(gS)^{9/16}H^{11/16}$$

We test the performances of equations 4 and 5 on our dataset of field-measured $k_{600}$ in Figure 3. Figure 3a fits the hydraulically-wide small-eddy model (equation 4) to hydraulically-wide measurements: only the data where $R_h$ is within 1% percent of $H$. Figure 3b fits the hydraulically wide chainsaw model (equation 5) to the same subset of data.

![Figure 3: Model development for predicting gas exchange velocity from SWOT-observable variables. (a) Empirical confirmation of the hydraulically wide small-eddy model. (b) Empirical confirmation of the hydraulically-wide chainsaw model. (c) Cummulative density function (CDF) of the hydraulic radius/mean flow depth ratios for all SWOT-observable measurements. Nearly all of these measurements would be considered hydraulically wide.](cache/k600_theory/k600Plot.jpg)

The small-eddy model in Figure 3a produces clearly biased estimates, systematically underestimating low gas exchange velocities and overestimating higher ones. However, when this model is expanded to account for a differential dissipation rate at the interface via the chainsaw model [@moogAirWaterGasTransfer1999], the dynamics are accurately captured (Figure 3b). The coefficients of variation are similar (`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy',]$r2,2)` and `r round(modelsWIDE[modelsWIDE$name == 'Chainsaw',]$r2,2)`, respectively), however the small-eddy model is clearly misrepresenting the scaling dynamics of gas exchange velocity in hydraulically-wide rivers. Given the algebraic structure of these two models, the discrepancy is in the exponents applied to the river hydraulic terms. More intuitively, this means that in hydraulically wide rivers where turbulence is generally relatively low, large-scale eddies exert a significant influence on surface dissipation rates: ultimately under the chainsaw model, gas exchange velocities are more sensitive to slope and mean depth than under the small-eddy model (Figure 3b). Figure 3c plots the cummulative density function (CDF) of all SWOT-observable measurements in our hydraulics dataset (Section 2), confirming that nearly all SWOT-observable measurements are hydraulically-wide. As stated previously, `r round(percs[percs$flag_swot == 'SWOT' & percs$flag_hydraulicWide == 'Rh=H',]$perc,0)`% of SWOT-observable measurements are within 5% of being perfectly hydraulically wide. Finally, this is to our knowledge the first empirical confirmation that the chainsaw model is valid in rivers (at least hydraulically-wide ones).

The success of the chainsaw model in hydraulically wide channels means that we can reasonably predict gas exchange velocities in hydraulically wide channels using just water surface slope and mean flow depth. These easily obtainable hydraulics parameters can also be directly measured or estimated from satellite remote sensing platforms, effectively opening the door for remotely sensing gas exhange via equation 5. This is explored next.

## 4 Exploiting the hydraulically wide channels to remotely sense gas exchange velocity
We have shown that scaling $k_{600}$ via equation 5 explains `r round(modelsWIDE[modelsWIDE$name == 'Chainsaw',]$r2,2)`% of the variation in $k_{600}$ in hydraulically wide rivers, which includes nearly all SWOT-observable rivers. This is incredibly convenient for remote sensing because there are only two non-remotely-sensible terms: $k_{600}$ and mean flow depth. By scaling *k* this way, we significantly reduce the equifinality issues that plague the more complicated SWOT discharge algorithms. Equifinality refers to an under-constrained mathematical system that has essentially infinite parameter combinations that can produce the same result: there are more unknowns than equations [@garamboisInferenceEffectiveRiver2015]. This is also a problem for the in situ tools that concurrently solve for *k* and stream metabolism [@applingOvercomingEquifinalityLeveraging2018; @graceFastProcessingDiel2015; @holtgrieveSimultaneousQuantificationAquatic2010]. In both of these domains, the other unknown parameters are often difficult to estimate (bed roughness and stream metabolism, respectively) while for BIKER, mean flow depth is relatively easy to approximate from the SWOT-observable river width [@brinkerhoffConstrainingRemoteRiver2020]. This is explained in detail later.

Taking all of this together, we develop the BIKER algorithm to remotely sense gas exchange velocities from the SWOT satellite. BIKER is informed by the @hagemannBAMBayesianAMHGManning2017 algorithm for ungauged RSQ and further explored in more recent work by @brinkerhoffConstrainingRemoteRiver2020. These papers conceptualize discharge as a Bayesian remote sensing problem, which we largely follow here to conceptualize $k_{600}$ as a Bayesian remote sensing problem that can be solved using SWOT data. BIKER, and Bayesian inference in general, starts from Bayes rule (equation 5), where $\Theta$ is some set of non-remotely-sensible parameters we want to solve for (including $k_{600}$), *x* is the observed data, $f(x|\Theta)$ is the sampling model where data are conditional on the parameters, and $p(\Theta)$ is the joint prior distribution of the parameters. Therefore, we are interested in solving for $p(\Theta|x)$, or the 'posterior' distribution. For BIKER, *x* is the SWOT-observables: river width *W* and water surface elevation $H_e$ (which is used to calculate the water surface slope $S_h$). Note that $p(x)$ is usually computationally intractable to integrate, so Bayesian inference tools require only the proportionality to be specified: $p(\Theta|x) \propto f(x|\Theta)p(x)$. Sampling algorithms are then used to approximate the posterior distribution, as is done in BIKER.

$$\mathbf{(5)} p(\Theta|x) = \frac{f(x|\Theta)p(\Theta)}{p(x)}$$

The heart of BIKER is its reformulation of the $k_{600}$ model as a Bayesian sampling model that is conditional only on the data that SWOT will provide. To do this, $k_{600}$ is first written as a function of SWOT-observables *W* and $S_h$. This algebra is carried out using equation 4 and the model parameter from Figure 3a (`r round(modelsWIDE[modelsWIDE$name == 'Chainsaw',]$coef,2)`) and yields equation 6, assuming the channel is hydraulically wide ($R_h = H =\frac{A}{W}$). Here, *A* is wetted channel area. *A* is further split into the SWOT-observable portion *dA* and the unobservable portion $A_0$ following @durandEstimatingReachaveragedDischarge2014. *dA* is estimated assuming a rectangular river channel so that $dA \approx \delta H_e*W$. Thus, there is no reliance on bed roughness, flow velocity, or any other terms that are more difficult to infer from river width.

**UPDATE**
$$\mathbf{(6)} \begin{eqnarray} k_{600} = \bigg(56.0294 S_h(\frac{A_0+dA}{W})\bigg)^{1/2} \end{eqnarray}$$

Next, equation 6 is written as a Bayesian sampling model, in which all of the SWOT observations are sampled from the unknown model parameters ($A_0$ and $k_{600}$). This is equation 7 after describing them as log-normal distributions. $\sigma_{k_{600}}^2$ refers to the uncertainty inherent in equation 6's estimates. Equation 7 also necessitate that we specify prior distributions for the parameters $A_0$ and $k_{600}$. Prior distributions, defined by their hyperparameters, formalize the a priori estimates (and uncertainties) for the non-remotely-sensed terms. More intuitively, BIKER priors represent our 'prior river knowledge' of what $A_0$ and $k_{600}$ probably are for some river since they cannot be remotely sensed. Hyperparameter specifications are detailed in Text S2, however the goal was to rely on absolutely no in situ information such that we could run this method on any river on Earth solely using SWOT observations. Priors could in theory be improved if there is available a priori information about the river. We could also assign a prior to $\beta$ in equations 4 and 6 because there is an inherent uncertainty associated with it. For the sake of the validation presented here (and elaborated on below), we assumed $\beta$ is known a priori and did not treat it as a parameter.

$$\mathbf{(7)} \left[log(56.0294) + \frac{1}{2}log(g) + \frac{1}{2}log(S_h) - \frac{1}{2}log(W)\right] \sim normal\left(\left[log(k_{600})-\frac{1}{2}log(A_0+dA)\right], \sigma^2_{k_{600}}\right)$$

With the sampling model (equation 7) and hyperparameters described (Text S2), a joint posterior distribution conditional on the SWOT observations is specified. To approximate this distribution, we use a Markov Chain Monte Carlo (MCMC) algorithm implemented using the Stan probabilistic programming language. Specifically, Stan uses a Hamiltonian Monte Carlo sampler which reduces computation time relative to other sampling algorithms [@hagemannBAMBayesianAMHGManning2017].

We validate BIKER on 47 SWOT-simulated rivers using daily observed hydraulics and the metrics described in Table S2. We also re-validate BIKER on the 17 rivers with the SWOT error model which corrupts the river width and slope. Regardless of the validation setup, we do not have observed $k_{600}$ data for these rivers, and to our knowledge no field dataset of $k_{600}$ exists in the type of temporal and spatial frequency that SWOT (and therefore the BIKER algorithm) provides. Therefore, we take the model outlined in equation 4 and Figure 3 and use that to calculate the observed $k_{600}$ that BIKER is validated against. This is why equation 3's $\beta$ is trated as known and not a parameter. With this setup, we are directly exploring BIKER's ability to infer observed $A_0$ and $k_{600}$ from *W* and *H* alone, as the *k* scaling model has already been sucessfully validated (Figure 3). This workflow is elaborated on in Text S3.

Figure 4a plots the validation results for $k_{600}$ (with no SWOT measurement error) across all  rivers and all timesteps. The points are the posterior means while the black lines are the 95% confidence intervals (CIs) for the predictions. $k_{600}$ is strongly correlated with the BIKER-predicted $k_{600}$ ($r^2$ of `r round(results_k600_all$r2, 2)`). Using absolutely no in situ information, BIKER captures the magnitude of the predictions and most points fall on or near the 1:1 line. The regression of the estimates (solid grey line) nearly recovers the 1:1 line (dashed black), but there is an over/underestimation bias in the largest/smallest $k_{600}$ values. The RMSE for the BIKER predictions is `r round(results_k600_all$rmse,2)` m/day) across all observations.

![Figure 4. a: Validation of BIKER for 47 SWOT rivers. Black bars are 95% CIs for the modeled values. Grey line is linear regression (and 95% prediction intervals are dashed) and dashed black line is 1:1 line. b-d: validation timeseries for three rivers representative of good, reasonable, and poor BIKER performance. b) was randomly selected from the upper tertile of NRMSE scores, c) was randomly selected from the middle tertile, and d) from the worst tertile. See Figure S3 for all other rivers. Model results include the posterior means and 95%.](cache/validation/validation.jpg)

Figure 4b-d are representative timeseries plots of predicted and observed $k_{600}$ for three rivers chosen randomly from those with 'good' NRMSE scores (b), 'okay' NRMSE scores (c), and 'bad' NRMSE scores (d). See Table S2 for the definition of NRMSE, the Figure 4 caption for how this was determined, and Figure S3 for the other river timeseries plots. For the Missouri Midsection River, the entire timeseries of $k_{600}$ is nearly perfectly predicted, while in the Seine River the dynamics (peaks and valleys) are reasonably captured but they are magnified to be far larger than the observed dynamics. Generally, though, mean $k_{600}$ is reasonably recovered for the Seine, as confirmed visually. In the Fresno River, there is significant positive bias in the estimates but also massive uncertainty (per the 95% CIs) in those estimates, indicating that BIKER is highly uncertain about its output (and rightfully so). Correct temporal dynamics are also largely missing from BIKER's Fresno River predicitions.

Figure 5a plots validation metrics calculated for each river with and without SWOT measurement error (green and purple, respectively). The points making up these boxplots (47 and 17, respectively) are overlain atop the boxplots. See Table S2 for metric definitions. SWOT measurement errors neglibly influence BIKER's performance across all four error metrics (Figure 5a), though caution should be used in over-interepting boxplots with a sample size of only 17. Given Figure 5a, we deem that SWOT measurement error does not exert a significant influence on BIKER and so the results presented for the rest of the manuscript assume no measurement error in order to use all 47 rivers.

![Figure 5. a: Performance metrics by river. See Table S2 for metric definitions. b: NRMSE scores (per river) versus the number of SWOT observations used in the Bayesian inversion. As expected, performance improves substantially with large amounts of data and degrades significantly with small amounts of data. Dashed lines denote scores of 0, 0.50, and 1. CIs.](cache/validation/validation_by_river.jpg)

Median river-specific $r^2$ is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$r2, na.rm=T),2)`, which is excellent given that absolutely no in situ information is being used to predict $k_{600}$. NRMSE and RRMSE have median scores of `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$nrmse, na.rm=T),2)` and `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$rrmse, na.rm=T),2)`, respectively, which are again good for a completely ungauged method. These are comparable to the best NRMSE scores achieved by the SWOT RSQ algorithms [@frassonExploringFactorsControlling2021]. Median rBIAS is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`, highlighting a  positive bias in most rivers' predictions. This further supports the visual evidence in Figure 4 that sometimes BIKER is overestimating the magnitude of $k_{600}$ and that this might be river-specific. While median $r^2$ and rBIAS scores were strong, the ranges of these scores were somewhat large (standard deviation for $r^2$ of `r round(sd(results_k600_rivs[results_k600_rivs$errFlag == 0,]$r2, na.rm=T),2)` and for rBIAS of `r round(sd(results_k600_rivs[results_k600_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`).

Figure 5b highlights one benefit of using Bayesian inference to estimate $k_{600}$: because the posterior is conditional on the SWOT observations, performance should improve with more data. Figure 5b plots by-river NRMSE scores versus the number of SWOT observations. While performance varies considerably when observations are up to ~400, the three rivers with nearly 600 observations universally show excellent BIKER performance, and the worst BIKER performance is universally in rivers with only 12 observations.

## 5 Remotely sensing carbon emissions from rivers
It is one thing to accurately predict *k*, but researchers are often most interested in the actual gas fluxes from rivers and ultimately the carbon emitted from river to atmosphere. Therefore, we also explore 1) BIKER's ability to reproduce $FCO_2$ $[M/L^2T]$ (equation 1) from these 47 rivers, and 2) a comparison of the representative carbon efflux $[M/T]$ from BIKER with established in situ methods. The details of this workflow are in Text S4, but broadly we pair the 26 biweekly $CO_2$ and water temperature samples (section 2, figure S2) from @beaulieuControlsGasTransfer2012 with a subset of SWOT observations (as the data are not daily). We then calculate $FCO_2$ using equation 1 and assuming atmospheric $CO_{2_{air}}$ is 390 uatm. Finally, we estimate a median bulk carbon efflux using BIKER's posterior means and three other in situ models for average channel depth (used to calculate $U_\star$) used for upscaling: one trained on the @brinkerhoffReconcilingAtaStationAtManyStations2019 dataset, and two previously published models [@raymondGlobalCarbonDioxide2013; @raymondScalingGasTransfer2012]. See Table S3 for their definitions. This allows us to assess whether BIKER's estimates (wholly ungauged) are comparable to gauged methods (all four HG models).

In Figure 6a, there is a very strong fit to the observed $FCO_2$ data, with an RMSE of `r round(results_fco2_all$rmse,2)` $g/m^2dy$. The performance is notably better than for $k_{600}$ alone (Figure 4a) and there is no systematic bias in the predictions across all 47 rivers. This is presumably due to the structure of the $FCO_2$ equation, which reduces the relative importance of errors in *k* given that the $CO_2$ data is measured in situ. $FCO_2$ prediction intervals are slightly narrower than those presented in Figure 4a as well.

![Figure 6: a: FCO2 via BIKER versus via equations 2 and 3 for every 11th timestep for the 49 rivers (grey lines are linear regression and 95% prediction intervals, while black dashed line is the 1:1 line). b-d: timeseries plots for the three example rivers from Figure 3b, 3c, and 3d.](cache/FCO2/FCO2_models.jpg)

Figure 6b compares the bulk carbon efflux (via $F_{CO_2}$) from the 47 rivers using BIKER posterior means and four streamgauge-based HG models. The results are largely equivalent for both the mean and median carbon efflux. Both the BIKER estimate (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_BIKER',]$sumFCO2, 2)` gG-C/yr) and the 'Raymond 2013' estimate (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2013',]$sumFCO2, 2)`) are somewhat overestimated relative to the observed flux (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_obs',]$sumFCO2, 2)`). The 'Brinkerhoff 2019' model nearly perfectly recovers the observed value (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_brinkerhoff2019',]$sumFCO2, 2)`).  Finally, the 'Raymond 2012' model slightly underestimates this bulk efflux (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2012',]$sumFCO2, 2)`). Thus, despite BIKER using absolutely no streamgauge or other in situ data like the other 3 methods do, it provides a reasonable estimate of the carbon efflux (Figure 6b).

## 6 Discussion
### 6.1 Gas exchange along the stream-to-ocean continumn
Field studies of gas exchange in wide rivers have suggested that their *k* properties behave differently than in steeper and smaller rivers [@ulsethDistinctAirWater2019; @beaulieuControlsGasTransfer2012; @alinPhysicalControlsCarbon2011; @wangPhysicallyBasedScaling2021]. While it has been shown that the small-eddy model is reasonably valid across most rivers [@wangPhysicallyBasedScaling2021], it has yet to be seen why and when form-drag dissipation is similar to near-surface dissipation in the context of *k*. In section 3 we show that the geomorphic concept of channel efficiency can explain when this is the case or not (Figure 3a). In extremely inefficient channels, the 'small-eddy' model is physically valid in flowing water environments as confirmed in Figures 3b and 3c. This has significant implications for how we understand shear and turbulence in rivers and their influence on *k*, as compared to environments where bottom-shear dominates (like lakes or oceans).

@wangPhysicallyBasedScaling2021 proposed a conceptual model for fluvial *k* where *k* is dominated by bottom shear in small streams while in large rivers *k* is also affected by wind, biota, etc. This builds on the [@ulsethDistinctAirWater2019] finding that steep, 'high-energy' streams have a fundamentally different $k_{600} \sim \epsilon_D$ relationship than less steep rivers and this may be due to the presence of bubble-mediated gas exchange and massive roughness elements in small mountain streams. Taking both of these models, along with our results, in aggregate, we suggest a combined conceptual model that follows the geomorphic concept of the 'river longitudinal profile' and is outlined in Figure 7. Small streams are steep, rough, and highly efficient channels that evacuate all but the largest sediment leaving a very rough riverbed. These small streams likely have strong *k*~hydraulics relationships and surface turbulence is dominated by their huge bed roughness. However, as one moves down the stream-to-ocean continumn, river channels get wider, flatter, relatively more frictional, and far less efficient at evacuating sediment. This means there is a concurrent fining of the riverbed and an increase in form-drag. In these largest rivers, form-drag starts dominating the *k*~hydraulics relationship rather than bed roughness. While wind certainly also plays a role in *k* in these large rivers [particuarly at higher winds- @beaulieuControlsGasTransfer2012], we show here that for maximally inefficient river channels form-drag alone can reasonably predict $k_{600}$. The relationship between form-drag dissipation and wind is left to future work.

Finally, this is to our knowledge the first empirical confirmation that the chainsaw model is valid in rivers (at least hydraulically-wide ones). Future tests should be performed to explore it's feasibility in smaller streams and/or other aquatic environments where turbulence is generally lower. We are not accounting for dissipation generated via wind shear, as none of these hydraulics-driven gas exchange models do. We suspect that this model will be less representative in less-sheletered rivers where wind becomes a driving factor of gas exchange rates, however this model setup is a good start towards coupling hydraulics-driven gas exchange with wind-driven gas exchange. Such a model would likely take a form similar to the conceptual model proposed by @wangPhysicallyBasedScaling2021.

### 6.2 Towards remote sensing of global spatiotemporal dynamics of *k* in large rivers
To date, most field-scale studies of riverine gas exchange have focused on 1) its relationship with wind speed [e.g @beaulieuControlsGasTransfer2012; @borgesVariabilityGasTransfer2004; @zappaEnvironmentalTurbulentMixing2007], 2) average flow velocity [e.g. @alinPhysicalControlsCarbon2011; @beaulieuControlsGasTransfer2012; @schelkerCO2EvasionSteep2016], or 3) discharge [e.g. @wangPhysicallyBasedScaling2021; @robertsMultipleScalesTemporal2007; @uehlingerEcosystemMetabolismDisturbance1998]. However, the spatiotemporal dynamics of riverine gas exchange are still weakly constrained. A few studies have investigated these dynamics, but they have been limited to individual rivers and/or limited field seasons [@hallAirWaterOxygen2012; @sand-jensenCO2DynamicsDanish2012]. @wallinSpatiotemporalVariabilityGas2011 performed a preliminary analysis in northern Sweden relating cross-section specific temporal variability in gas exchange with channel slope, but they were limited to an average of only 8 measurements per river in a single watershed. This limited knowledge of large-scale *k* spatiotemporal dynamics is due both to a lack of process-level understanding [@hallGasExchangeStreams2020] but also a lack of measurements.

Therefore, estimating *k* from SWOT data is an attractive option for exploring its spatiotemporal dynamics at fine temporal resolution and at the global-scale. SWOT will provide daily hydraulic measurements for a 3 month fast sampling period for calibration and validation and sampling thereafter between 1 and 7 days per 21 day repeat cycle [@biancamariaSWOTMissionIts2016]. BIKER's success in 1) infering $k_{600}$ using simulated SWOT data over a wide range of rivers (Figures 4 and 5) and 2) being robust to measurement errors internal to the SWOT data (Figure 5) bode well for BIKER's eventual implementation on real SWOT observations. Further, BIKER's improved performance with longer datasets (Figure 5b) bodes well for future SWOT implementation, as the three-year campaign will provide well north of 600 observations for many rivers, suggesting even better BIKER inversions than those presented here. All of this suggests that daily estimation of riverine gas exchange globally could be possible once SWOT launches.

### 6.3 Towards remotely sensing riverine carbon emissions using SWOT
Figure 6 confirms that BIKER is quite successful, without any in situ information aside from a $CO_2$ logger, at predicting both $FCO_2$ (Figure 6a) and 2) the bulk carbon efflux (Figure 6b). This encouraging result has two main implications for future work coupling remote sensing via SWOT with in situ data. First, it confirms that we can couple BIKER and SWOT with in situ gas concentration loggers to produce $FCO_2$ estimates at novel temporal resolutions in SWOT-observable rivers. This is particualry useful given recent advances in in situ gas concentration loggers [@ahoHighestRatesGross2021] but no such similar advances in modeling *k* at equivalent temporal resolutions. BIKER can likely also be ran at the field scale using arrays of pressure transducers to estimate water surface slope (rather than using satellite-based altimeters like SWOT) following recent work doing the same using the @hagemannBAMBayesianAMHGManning2017 RSQ algorithm [@harlanDischargeEstimationDense2021].

Secondly, it is important to stress that unlike BIKER, the HG models in Figure 6b rely on an in situ streamgauge. This means that Figure 6b represents the best performance that those models could ever have; if ran using modeled discharge their accuracy would necessarily decrease. Thus, these results suggest that BIKER will be useful in two settings: 1) upscaling in ungauged rivers as hypothesized, but also in 2) potentially improving our carbon efflux understandings at gauged sites. Future work should systematically quantify prediction error from coupling global-scope HG models with modeled discharge, as is the default workflow used in fluvial $FCO_2$ upscaling studies [e.g. @lauerwaldSpatialPatternsCO22015; @horgbyUnexpectedLargeEvasion2019; @raymondGlobalCarbonDioxide2013; **Liu et al in reivew**].

Figure 6b also confirms that the training data used for HG models exerts a significant influence on upscaled carbon emissions from rivers. In Figure 6b there is a nearly 0.5 Tg-C range between estimates, which is significant and nearly entirely a function of the data used to fit these depth HG models. In this context, the 'Brinkerhoff 2019' model likely outperforms both 'Raymond models' because the training data is orders of magnitude larger and more geomorphically varied than those used in the 'Raymond' models (530,945 measurements versus 1,026 and 10837 measurements). Meanwhile, BIKER has no similar reliance on hydraulic parameters trained on different datasets and only assumes that *dA* can be calculated by assuming a rectangular river channel. Upon SWOT's launch, the BIKER approach to estimating *k* could be coupled with ethier existing upscaling workflows or even explicit $CO_2$ transport models [@brinkerhoffLakeMorphometryRiver2021; **Saccardi & Winnick in review**] to improve riverine gas flux predictions where gauges are unavailable but SWOT measurements are. This coupling could potentially be done using data assimilation techniques, which have proven very useful for similar objectives in recent RSQ work [@ishitsukaCombiningOpticalRemote2020].

## 7 Conclusions
Gas exchange from aquatic systems has been studied for nearly a century, with a robust model (equation 2) that has been repeatedly verified across many non-fluvial environments. Despite renewed interest in fluvial gas exchange in the last decade or so, there are considerable uncertainties in how we model the gas exchange velocity in river environments and particularly in large rivers where wind increasingly influences *k*. Here, we show algebraically that TKE budgets in big rivers exist in a local equilbrium at the free surface and that we can equivalently scale *k* using any characteristic turbulence scale. We validate this using over 530,000 measurements of river channel hydraulics and over 700 discrete measurements of the normalized gas exchange velocity $k_{600}$. We then exploit this finding to remotely sense $k_{600}$ using simulated data that will be provided by the forthcoming SWOT satellite, showing good performance and relying on absoutely no on-the-ground information. Finally, we pair this algorithm (named 'BIKER') with an in situ $CO_2$ logger and show strong performance in reproducing $CO_2$ evasion fluxes and carbon efflux from the rivers' surfaces.

These strong results functionally open the door for global-scale, near daily estimates of fluvial gas exchange velocity once SWOT launches in 2022. This unprecedented amount of data should allow for significant insights into both the mechanistic and temporal dynamics of fluvial gas exchange in large rivers around the world. This, in turn, should allow us to better parameterize upscaling workflows such that the global fluvial carbon flux is better constrained.

## 8 Acknowledgements
C.B. Brinkerhoff was funded on **FINESST babyyyy**. BIKER is available at https://github.com/craigbrinkerhoff/BIKER. All code to build and generate results, figures, and the manuscript is available at https://github.com/craigbrinkerhoff/RSK600. We thank Renato Frasson, Michael Durand, Amber Ulseth, and Jake Beaulieu for generously making their data available for this study. We also thank the entire SWOT discharge working group for their decade-plus body of work which inspired this study.

## 9 Apendix A
*Table A1: Variable description and notation for this study.*

|**Notation**|**Description**|**Calculation (if applicable)**|**Units**|
|------------|---------------|-------------------------------|---------|
|*A*|Channel cross-sectional area|NA|$[L^2]$|
|*Bulk carbon efflux*|carbon mass transport rate from river to atmosphere|NA|$[\frac{M}{T}]$|
|$CO_{2_{water}}$|Water-side $CO_2$ concentration|NA|$[L]$|
|$CO_{2_{air}}$|Atmospheric-side $CO_2$ concentration|NA|$[L]$|
|$D_m$|Molecular diffusion coefficient|NA|$[\frac{L^2}{T}]$|
|$\epsilon_S$|Dissipation rate of near-surface turbulence|log-law-of-the-wall model: $\frac{U_*^3}{H}$|$[\frac{E}{M*T}]$|
|$FCO_2$|$CO_2$ evasion flux from river to atmosphere|NA|$[\frac{M}{L^2T}]$|
|$g$|gravitational acceleration|9.8|$[\frac{L}{T^2}]$|
|$H$|Mean flow depth|$A/W$|$[L]$|
|$k$|gas exchange velocity|NA|$[\frac{L}{T}]$|
|$k_{600}$|gas exchange velocity normalized to $Sc=600$|$(\frac{600}{Sc_k})^{-0.5}k$|$[\frac{L}{T}]$|
|$R_h$|Hydraulic radius|$\frac{AW}{2H+W}$|$[L]$|
|$S$|River slope|NA|$[\frac{L}{L}]$|
|$Sc$|Schmidt number|$\frac{v}{D_m}$|$unitless$|
|$T_d$|TKE turbulent diffusion rate|NA|$[\frac{E}{M*T}]$|
|$U$|Reach-averaged flow velocity|NA|$[\frac{L}{T}]$|
|$U_*$|Shear velocity|$\sqrt{gSR_h}$|$[\frac{L}{T}]$|
|$v$|kinematic viscosity|NA|$[\frac{L^2}{T}]$|
|$W$|Flow width|NA|$[L]$|




## References
