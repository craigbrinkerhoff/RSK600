---
title: "Using hydraulic geometry and the SWOT satellite to remotely sense river gas exchange velocity"
author:
  - Craig B Brinkerhoff:
      email: cbrinkerhoff@umass.edu
      institute: UMass
      correspondence: true
  - Colin J Gleason:
      institute: UMass
  - Christopher J Zappa:
      institute: Lamont
  - Peter A Raymond:
      institute: Yale
  - Merritt H Harlan:
      institute: UMass
institute:
  - UMass: Department of Civil & Environmental Engineering, University of Massachusetts-Amherst
  - Lamont: Lamont-Doherty Earth Observatory, Columbia University
  - Yale: School of the Environment, Yale University
bibliography: References.bib
csl: agu_citation_style.csl
output:
  redoc::redoc:
#output:
#  word_document:
      pandoc_args:
        - '--lua-filter=scholarly-metadata.lua'
        - '--lua-filter=author-info-blocks.lua'
      reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Key Points
- BIKER algorithm predicts gas exchange velocity and $CO_2$ fluxes from simulated SWOT data
- BIKER is robust to measurement errors implicit in SWOT river measurements
- BIKER will allow for novel study of gas exchange spatiotemporal dynamics after SWOT's launch

## Keywords
gas exchange, fluvial geomorphology, remote sensing, open-channel flow, SWOT, biogeochemistry

## Abstract
Extensive research over the past two decades has shown that the global river network emits significant amounts of greenhouse gas via evasion. Despite much progress, there is still large uncertainty in the temporal dynamics of gas exchange velocity and thus carbon emissions to the atmosphere. We propose that the NASA/CNES/USKA/CSA SWOT satellite, set to usher in a new age of hydrology research at the global scale, can provide similarly transformative insights to fluvial gas exchange modeling upon launch in 2022. Here, we present work inferring gas exchange velocity from future SWOT observations without in situ calibration. We exploit the unique geomorphology of SWOT-observable rivers to develop a physical model of gas exchange that is nearly entirely remotely sensible and explains `r round(modelsWIDE[modelsWIDE$name == 'reynolds-eD',]$r2,2)*100`% of variation in gas exchange. We then couple this model with established Bayesian inference techniques to develop BIKER, or the 'Bayesian Inference of the $k_{600}$ Exchange Rate' algorithm. We validate BIKER on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-simulated rivers and 166 discrete measurements of river gas exchange, yielding an algorithm that predicts this theoretical model solely from SWOT observations with a by-river median Kling-Gupta Efficiency of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==0,]$KGE), 2)`. Like many similar Bayesian remote sensing algorithms, BIKER is better at reproducing the temporal dynamics of gas exchange (median correlation coefficient of `r round(median(results_k600_rivs[results_k600_rivs$errFlag==0,]$r), 2)`), than the absolute rates of exchange. Finally, we show BIKER robust to measurement errors implicit in the SWOT data. With SWOT set to launch in late 2022, we suggest that BIKER will be useful in mapping the global-scale spatiotemporal dynamics of fluvial gas exchange in large rivers.

## 1 Introduction
Natural systems play a critical role in the budgeting and accounting of the global carbon cycle under climate change. Following @colePlumbingGlobalCarbon2007, the global river network is recognized to emit substantial amounts of carbon to the atmosphere via evasion (gas exchange driven by a diffusion gradient and water turbulence), in addition to their long understood role of transporting carbon to the oceans. Current estimates of total carbon dioxide evasion ($FCO_2$) to the atmosphere from the global river network vary from 650-2000 Tg C/yr [*Liu accepted*; @lauerwaldSpatialPatternsCO22015; @raymondGlobalCarbonDioxide2013], with 167 Tg-C/yr coming from mountain streams alone [@horgbyUnexpectedLargeEvasion2019]. Despite rivers' incredibly small percentage of the global land surface [0.67%- *Liu accepted*], this C flux is on par with the total oceanic $CO_2$ uptake rate [@gruberOceanicSinkAnthropogenic2019; @horgbyUnexpectedLargeEvasion2019] and the global forest carbon uptake rate [@panLargePersistentCarbon2011].

River $CO_2$ evasion is increasingly better constrained and is clearly a critical component of the global carbon cycle. Equation 1 represents this riverine flux given $\delta CO_2$ (the gas concentration gradient between the water $CO_{2_{water}}$ and the air $CO_{2_{air}}$) and the gas exchange velocity *k*. Consult Appendix A for variable nomenclature used throughout this study.

$$FCO_2=k* \delta CO_2 \mathbf{(1)}$$
The structure of equation 1 necessitates that calculations of this flux are highly sensitive to measurements/estimates of *k*. However, *k* can only be directly calculated via a known gas concentration gradient, eddy-covariance measurements, or tracer additions to the stream [@hallGasExchangeStreams2020]. In trying to constrain the global fluvial $FCO_2$ flux across millions of rivers, this calculation is impossible, and necessitates the use of predictive models for *k* that are based on easily obtained river hydraulic properties. In that vein, there have been over 20 empirical models developed to predict *k*, generally using some combination of mean velocity $\bar{U}$, shear velocity $U_*$, width $W$, depth $H$, and slope $S$ as predictors [@wangPhysicallyBasedScaling2021]. These models usually predict $k_{600}$, or *k* normalized by a Schmidt number of 600. This is to remove the effect of water temperature and gas type from predictive models, as warmer waters and lower *Sc* numbers both increase gas exchange rates [@hallGasExchangeStreams2020]. Specifically, $k_{600}$ reflects the $k_{CO_{2}}$ at 20 degrees Celsius. Through this normalization, these models exclusively perturb the geophysical controls on gas exchange [@hallGasExchangeStreams2020].

These empirical models enable estimating a global $FCO_2$ flux ($FCO_2_{upscaled}$) from millions of rivers, but they also change the base parameters that ultimately control that aggregate estimate. That is, by making *k* a function of hydraulics, $FCO_2_{upscaled}$ is now a direct function of river hydraulics. This functional relationship is described in equation 2. It suggests that $FCO_2$ estimates are not only at the mercy of the accuracy and spatiotemporal resolution of $\delta CO_2$, but also the accuracy and resolution of our river hydraulics estimates.

$$FCO_{2_{upscaled}}=f(k_{CO_2}, \delta CO_2)=f(\bar{U}, H, S, W, \delta CO_2) \mathbf{(2)}$$
For example, to upscale $FCO_2$ globally, @raymondGlobalCarbonDioxide2013, @lauerwaldSpatialPatternsCO22015, and @horgbyUnexpectedLargeEvasion2019 all relied on $k_{CO_2}$ values indirectly estimated using mean annual streamflow models and scaling equations to predict hydraulic terms, while @borgesGloballySignificantGreenhousegas2015 used a combination of the above method and a constant $k_{CO_2}$ in space and time to upscale over Africa. In all of these foundational studies, the temporal dynamics of the gas exchange velocity (and thus $FCO_2$) were ignored because of hydraulic data limitations. It has been shown at the field-scale that temporal dynamics of gas exchange can vary widely from site to site [@wallinSpatiotemporalVariabilityGas2011], but it has remained impractical to obtain temporally explicit $k_{CO_2}$ at continental-to-global scales. More recently, *Liu etal accepted* performed a first assessment of monthly temporal dynamics in the global river $CO_2$ flux, though their focus was not on *k* and they relied on modeled streamflow to achieve this. This knowledge gap is contrasted against the robust existing literature exploring spatiotemporal patterns in $CO_2_{water}$ [e.g. @ahoDistinctConcentrationdischargeDynamics2021; @ahoDifferentialResponseGreenhouse2019; @crawfordCO2TimeSeries2017; @peterScalesDriversTemporal2014; @ranDynamicsRiverineCO22017; @rocher-rosLandscapeProcessDomains2019; @raymondAtmosphericCO2Evasion2000; @liuHydrologicControlsPCO22018a].

To that end, the field has made significant progress in estimating $CO_2_{water}$, where we now have river-reach explicit modeling at monthly temporal resolutions using global hydrography datasets [@horgbyUnexpectedLargeEvasion2019; @brinkerhoffLakeMorphometryRiver2021; @saccardiImprovingPredictionsStream2021; *Liu accepetd*], but an equivalently sophisticated representation of $k_{CO_2}$ is still lacking. As equations 1 and 2 dictate, $CO_2_{water}$ and $k_{CO_2}$ share the burden of calculating $FCO_2$ and therefore these next-generation models will have to contend with this discrepancy, which is directly dictated by the lack of direct measurements of global river hydraulics.

@wangPhysicallyBasedScaling2021 recently attempted to address this problem by simulating *k* in 35 rivers of many sizes (widths ranging from 0.23â€“349m) using a stream metabolism model [@applingOvercomingEquifinalityLeveraging2018] and in situ dissolved oxygen (DO) datasets to infer what *k* must have been. They then compared this simulated dataset against direct measurements of *k*, finding similar performance and parameter values for process-based models of gas evasion. However, they were still limited by a lack of direct hydraulic measurements and had to rely on scaling equations to estimate river depth and velocity. Even though approaches like this are incredibly useful for expanding our mechanistic understanding of gas exchange, it is less useful for global upscaling purposes as it relies on highly detailed in situ DO data for every river [@hallGasExchangeStreams2020].

In theory, this discrepancy between the quality of our $CO_2_{water}$ and $k_{CO_2}$ estimates could be alleviated if direct hydraulics measurements were available at the global scale at a sufficient temporal resolution. This is turn would also address the uncertainty regarding continental-to-global scale temporal dynamics of gas exchange noted earlier. Conveniently, these data will soon be available via the upcoming NASA/CNES/UKSA/CSA Surface Water and Ocean Topography (SWOT) satellite mission. SWOT is expected to launch in 2022 and provide the world's first direct measurements of global water surface extent and elevation at novel temporal resolutions. SWOT is a wide swath radar interferometer and will sample rivers every 1 to 7 days per 21 day repeat cycle, measuring rivers wider than 100m with a goal of expanding this to rivers at least 50m wide [@biancamariaSWOTMissionIts2016]. Via its direct hydraulic measurements, SWOT is expected to usher in a sea change in global-scale hydrology, and could similarly transform fluvial biogeochemsitry if techniques are developed to ingest SWOT data and infer *k*. In this context, we borrow tools from fluvial geomorphology and existing SWOT algorithms to answer the following two questions:

  - Can we use hydraulic geometry to develop a physically-based model for $k_{600}$ unique to these rivers?
  
  - Can we exploit such a model to infer $k_{600}$ (and its uncertainty) solely from SWOT observations?

To answer this first question, we use hydraulic geometry [the fundamental geomorphic relationships between streamflow and channel shape- @leopoldHydraulicGeometryStream1953] to develop a process-based model for large-river gas exchange. We then take these findings and explore question 2 by implementing the model within an RS of $k_{600}$ algorithm named BIKER ('Bayesian Inference of the $k_{600}$ Evasion Rate'). The goal with BIKER is to require no in situ inputs of any kind (although in situ data could be ingested and should improve results) such that it is completely globally implementable on any SWOT-observable river on Earth. Finally, we also test whether BIKER can predict actual gas fluxes when paired with an in situ $CO_2$ sensor and compare it against established methods that are reliant on in situ hydraulic measurements.

This paper is split into two distinct parts: gas-exchange theory/model development (section 2) and BIKER algorithm development/validation (section 3). Section 3 is fundamentally dependent on the results presented in section 2, therefore section 2 presents both theory and results. Both sections detail the data used. We conclude with a discussion (section 4) that encompasses both gas exchange theory and remote sensing. We also provide a flowchart detailing the entire study as Figure 1.

![Figure 1: Flowchart detailing the BIKER algorithm. Dashed lines indicate workflow to calculate the observed data that we validate against. See Appendix A for variable nomenclature used in this study.](cache/flowchart.jpg)

## 2 Hydraulic geometry in large rivers and predicting fluvial gas exchange velocity
To predict *k* in the very large rivers that SWOT will observe, we start from established process-based models for *k*, impose hydraulic assumptions that are valid in SWOT-observable rivers, and obtain a suite of models we empirically test. Following a description of the data used (section 2.1), we outline these established models (section 2.2) and then step through our hydraulic assumptions to arrive at equations that can be ingested by SWOT (section 2.2). Following this model development, all models are empirically tested (section 2.3)

### 2.1 Data
We develop our gas exchange theory using multiple datasets of directly measured $k_{600}$ and directly measured stream hydraulics collected from the literature. In total, there are 763 measurements of $k_{600}$, with 701 of these measurements previously gathered by @raymondScalingGasTransfer2012 and @ulsethDistinctAirWater2019. The remaining measurements come from @churchillPredictionStreamReaeration1964 and @owensReaerationStudiesStreams1964. See Table S1 for a complete list of the studies that collected these measurements. All measurements come from tracer studies and thus define $k_{600}$ and the rivers' mean hydraulic properties at the reach scale.

To quantify how many SWOT-observable rivers meet our hydraulic assumptions, we expand our dataset of stream hydraulics (but not $k_{600}$) using a previously published compilation of in situ hydraulic measurements [@brinkerhoffReconcilingAtaStationAtManyStations2019]. That dataset contains over 530,000 unique measurements of river channel velocity, width, and discharge from across the continental United States, originally made to calibrate United States Geological Survey (USGS) streamgauge rating curves and made public by the USGS.

### 2.2 Process-based modeling of river *k*
*k* should scale with near-surface turbulence in turbulent streamflows [@hallGasExchangeStreams2020] and thus extensive field and laboratory experiments have converged on the 'small-eddy model' as derived by @lamontEddyCellModel1970 and empirically anticipated by @calderbankContinuousPhaseHeat1961. This model scales *k* via the smallest-scale turbulent eddies and has been repeatedly empirically validated in freshwater systems [e.g. @katulStructureFunctionModel2018; @lorkeUnifiedScalingRelation2006; @zappaEnvironmentalTurbulentMixing2007; @zappaVariationSurfaceTurbulence2003; @moogStreamReaerationNonuniform1999; @vachonRelationshipNearsurfaceTurbulence2010; @tokoroHighGastransferVelocity2008; @wangPhysicallyBasedScaling2021]. The small-eddy model is provided as equation 3, where $\epsilon$ is the dissipation rate of near-surface turbulence, $v$ is the kinematic viscosity, and *Sc* is the Schmidt number.

$$k\propto Sc^{-1/2}(v\epsilon)^{1/4} \mathbf{(3)}$$
Some laboratory and field observations additionally suggest that open channel flows with small bed roughness do not exhibit homogeneous surface dissipation at their air-water interface [@moogAirWaterGasTransfer1999; @talkeTurbulentKineticEnergy2013]. Given this observation, @moogAirWaterGasTransfer1999 proposed an extension to the small-eddy model, additionally scaling $k_{600}$ using a shear Reynold's number formulation. This is equation 4 and is referred to here as the 'Reynolds extension' model. The Reynolds model is hypothetically useful in low-turbulence flows where a relative lack of large-scale eddies effectively 'filter out' the number of small-eddies that actually reach the interface and initiate gas exchange [@talkeTurbulentKineticEnergy2013]. While scaling *k* via a shear Reynold's formulation is sometimes done to parameterize wave-breaking gas exchange models in the open ocean  [@brumerWaveRelatedReynoldsNumber2017; @zhaoDependenceWhitecapCoverage2001; @zhaoEffectWindWaves2003], it is infrequently done in rivers. In the context of BIKER, we chose to test this model because large, SWOT-observable rivers are generally the smoothest, least-turbulent flows along the stream-to-ocean continuum. Further, to our knowledge this Reynolds extension model has never been empirically tested in predicting river *k*, aside from confirming that large-scale eddies differentially move turbulence to the surface in a large river [@talkeTurbulentKineticEnergy2013].

$$k \propto Sc^{-1/2}(v\epsilon)^{1/4}(\frac{U_*H}{v})^{3/8} \mathbf{(4)}$$
Equations 3 and 4 both rely on $\epsilon$, of which measuring directly is non-trivial. When working at large scales, a commonly used $\epsilon$ model assumes that all turbulence is generated at the bed and transported to the air-water interface via the log-law-of-the-wall such that $\epsilon = \epsilon_S = \frac{U_*^3}{H}$ [@lorkeUnifiedScalingRelation2006; @nezuTurbulenceOpenChannel1993]. Another approach models *k* via 'form-drag dissipation' ($\epsilon = \epsilon_D = gS\bar{U}$) which is equivalently the total stream power per unit mass water. This normalized stream power captures the bulk frictional resistance (and thus energy dissipation) via channel banks, meanders, bars, etc. that is unique to fluvial systems [@moogStreamReaerationNonuniform1999]. Authors have since shown that this model can reasonably predict *k* in rivers and streams [@raymondScalingGasTransfer2012; @ulsethDistinctAirWater2019; @wangPhysicallyBasedScaling2021].

### 2.3 Imposing large-river hydraulic geometry on *k* models
Given the theoretical context provided in Section 2.2, we know turn to SWOT-observable systems specifically. Rivers and streams change predictably along their longitudinal profile from headwater to ocean, and we can exploit the hydraulic geometry of large rivers at the end of this continumn to estimate *k* in SWOT-observable systems. In general, as river size increases, channels become more rectangular, their shapes elongate (becoming wider quicker than they become deeper) and their hydraulic radii begin to approximate their mean flow depth, i.e. $R_h \approx H$. This is a common assumption in hydraulic and geomorphic modeling of large rivers, where the average SWOT-observable river flow has a $\frac{R_h}{H}$ ratio of `r HG_swot$mean * 100`% (n = `r HG_swot$n`; see Text S1 for how we built this dataset). We refer to these flows as 'hydraulically-wide'.

Assuming that all SWOT-observable rivers are hydraulically-wide, we test the performance of four models for predicting *k* in hydraulically-wide channels: the four unique combinations of equations 3-4 and the two $\epsilon$ models outlined above. While the complete model derivations for the small-eddy models (section 2.3.1) and the Reynolds-extension models (section 2.3.2) are provided in Text S2, the final equations are provided in Table 1. The overall goal was to reduce the equations down to their fundamental parameters, identifying which terms are SWOT observable and limiting the number of terms not directly measurable via SWOT.

*Table 1: Four physically-based models for $k_{600}$ each derived under a different set of mass transport assumptions but all valid in hydraulically-wide rivers. Their derivations are outlined in sections 2.3.1 and 2.3.2 and their empirical tests are shown in section 2.4.*

|**$k_{600}$ model**|**$\epsilon$ model**|**Final equation**|**Empirical test**|**Empirical fit ($r^2$)**|
|-----------|--------------------|------------------|-----------------|----------------------------|
|Small-eddy|Log-law-of-the-wall|$k_{600}=\alpha(gS)^{3/8}H^{1/8}$|Figure 3a|`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eS',]$r2, 2)`|
|Small-eddy|Form-drag dissipation|$k_{600}=\alpha_1(gS\bar{U})^{1/4}$|Figure 3c|`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eD',]$r2, 2)`|
|Reynolds-extension|Log-law-of-the-wall|$k_{600}=\beta(gS)^{9/16}H^{11/16}$|Figure 3b|`r round(modelsWIDE[modelsWIDE$name == 'reynolds-eS',]$r2, 2)`|
|Reynolds-extension|Form-drag dissipation|$k_{600}=\beta_1(gS)^{7/16}\bar{U}^{1/4}H^{9/16}$|Figure 3d|`r round(modelsWIDE[modelsWIDE$name == 'reynolds-eD',]$r2, 2)`|

#### 2.3.1 'Small-eddy' model for gas evasion
We derive equations starting from the small-eddy model (equation 3) for hydraulically-wide channels. If we assume $\epsilon=\epsilon_S$ and $R_H = H$ in equation 2, and solve for $k_{600}$ via statistical parameter $\alpha$, we eventually arrive at equation 5. If we do the same but assume $\epsilon=\epsilon_D$ and statistical parameter $\alpha_1$, we arrive at equation 6.

$$k_{600}=\alpha(gS)^{3/8}H^{1/8} \mathbf{(5)}$$

$$k_{600}=\alpha_1(gS\bar{U})^{1/4} \mathbf{(6)}$$
Equations 5 and 6 thus define gas exchange velocity solely as a function of slope and mean flow depth or mean flow velocity. This is theoretically valid only in a hydraulically-wide channel.

#### 2.3.2 'Reynolds extension' model for gas evasion
We also impose $\epsilon=\epsilon_S$ and $R_H=H$ on the Reynolds extension model just like we did in section 2.3.1 and arrive at equation 7 (with statistical coefficient $\beta$). The result is identical to the hydraulically-wide small-eddy model (equation 5), except for the exponents which are both steeper. Equation 8 reflects the same derivation, but with $\epsilon=\epsilon_D$ and statistical coefficient $\beta_1$.

$$k_{600}=\beta(gS)^{9/16}H^{11/16} \mathbf{(7)}$$
$$k_{600}=\beta_1(gS)^{7/16}\bar{U}^{1/4}H^{9/16} \mathbf{(8)}$$
We now have four different models for $k_{600}$ in hydraulically-wide rivers, each with a different set of assumptions and parameters but all defined as functions of the water surface slope and other hydraulic terms that are not directly measurable via SWOT. Again, all four models are summarized in Table 1.

### 2.4 Model validation
With equations 5-8 derived, we now empirically test their strength of fit for hydraulically-wide river flows. We validate on the dataset of in situ measurements of $k_{600}$, after filtering for measurements made in hydraulically-wide channels (n= `r n`), which was operationally defined as flows whose hydraulic radius was within 1% of their mean flow depth. All told, this amounts to `r n` direct measurements of hydraulically-wide $k_{600}$ and stream hydraulics to test with. Models were assessed via the coefficient of determination ($r^2$) and results are plotted in Figure 3. Note that Figure 3 axes are plotted in logarithmic space only for visualization: model fit and validation (via $r^2$) were calculated in linear space as their models dictate.

![Figure 2: Empirical testing of four models for predicting gas exchange velocity in hydraulically-wide channels: (a) Small-eddy model with log-law-of-the-wall dissipation. (b) Reynolds-extension model with log-law-of-the-wall dissipation. (c) Small-eddy model with form-drag dissipation. (d) Reynolds-extension model with form-drag dissipation. Note that axes are plotted in logarithmic space just for visualization: model fit and validation were calculated in linear space.](cache/k600_theory/k600Plot.jpg)

Despite reasonable $r^2$ scores, both small-eddy models produce clearly biased estimates (Figures 3a, 3c). They systematically underestimate lower gas exchange velocities and overestimate higher ones, with the log-law-of-the-wall model (Figure 3a) performing marginally worse both visually and via $r^2$ (`r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eS',]$r2, 2)` versus `r round(modelsWIDE[modelsWIDE$name == 'Small-eddy-eD',]$r2, 2)` for Figure 3c). However, when this model is expanded to further retard the dissipation rate via the Reynolds extension model [equations 6 and 7- @moogAirWaterGasTransfer1999], the dynamics are more accurately captured (Figures 3b, 3d) and $r^2$ scores increase (`r round(modelsWIDE[modelsWIDE$name == 'reynolds-eS',]$r2, 2)` and `r round(modelsWIDE[modelsWIDE$name == 'reynolds-eD',]$r2, 2)` for the log-law-of-the-wall and form-drag dissipation, respectively). Modeling dissipation via total form-drag rather than just via bed shear improves model performance regardless of $k_{600}$ equation used. This is likely because the majority of dissipation occurring in rivers comes not just from the streambed, but from bulk form drag via channel walls, bars, and meanders [@raymondScalingGasTransfer2012; @moogStreamReaerationNonuniform1999; @wangPhysicallyBasedScaling2021; @ulsethDistinctAirWater2019].

The success of the Reynolds-extension models in hydraulically-wide channels, and in particular when coupled with form-drag dissipation (equation 8, Figure 3d), provides us with a strong physical-model for gas evasion. The river hydraulics terms in equation 8 can either be directly measured or reasonably inferred from SWOT measurements, effectively opening the door for remotely sensing the gas exchange velocity. This is explored next.

## 3 Exploiting equation 8 to remotely sense gas exchange velocity
We have shown that scaling $k_{600}$ via equation 8 explains `r round(modelsWIDE[modelsWIDE$name == 'reynolds-eD',]$r2,2)*100`% of the variation in $k_{600}$ in hydraulically-wide rivers, which includes nearly all SWOT-observable rivers. Further, equation 8 has only three non-remotely-sensible terms: $k_{600}$, mean flow depth, and mean flow velocity. Conveniently, techniques to simultaneously infer hydraulic parameters from SWOT data have been established over the last decade to infer streamflow from SWOT's measurements [e.g. @andreadisConstrainingAssimilationSWOT2020; @brinkerhoffConstrainingRemoteRiver2020; @durandEstimatingReachaveragedDischarge2014; @garamboisInferenceEffectiveRiver2015; @gleasonRetrievalRiverDischarge2014a; @garamboisVariationalEstimationEffective2020; @brissetAssimilationAltimetricData2018; @hagemannBAMBayesianAMHGManning2017; @larnierRiverDischargeBathymetry2020a; @oubanasDischargeEstimationUngauged2018]. For BIKER, we follow the work developed by @hagemannBAMBayesianAMHGManning2017, @brinkerhoffConstrainingRemoteRiver2020, and @durandEstimatingReachaveragedDischarge2014 to infer $k_{600}$, channel bathymetry, and roughness from SWOT observations using a modified form of Manning's equation for mean flow velocity. Following a description of the data used (section 3.1), we detail algorithm development and experimental design (section 3.2) and then we present the validation results (section 3.3).

### 3.1 Data
![Figure 3: Map of the 47 hydraulic models and 1 timeseries of CO2 samples used in this study. Note that hydraulic model locations are approximate as some of the models are not geo-referenced. (Table S1).](cache/maps/map3.jpg)

To validate BIKER, we cannot use actual SWOT measurements as SWOT has yet to launch. In the hydrology literature, it is therefore standard practice to benchmark SWOT-related algorithms on "SWOT-like" data. We use 47 SWOT-simulated rivers for validation, where these simulated rivers are simply reach-averaged hydraulic model outputs where the water surface heights, slopes, and widths are labelled as RS observations and are used as the sole inputs to BIKER. These were published by @frassonExploringFactorsControlling2021 and @durandIntercomparisonRemoteSensing2016 and are the two benchmarking studies that explored remote sensing of discharge (RSQ) algorithm performance for the SWOT mission. They used standard hydraulic models forced with known inflows and measured bathymetry to model the hydraulic response of the rivers and then further prepared the data to mimic SWOT by adding realistic radar errors and sampling along the satelliteâ€™s future ground track. @frassonExploringFactorsControlling2021 also developed a sophisticated error model that mimics the effects of the atmosphere, topography, and water surface geometry on SWOT measurements (16/47 rivers) to add realistic radar layover errors that depend on the time and place of observation. The resulting data are the most realistic synthetic SWOT river data in the literature. The approximate locations of these rivers are plotted in Figure 1.

For the $CO_2$ evasion and carbon efflux calculations (section 3.1.3), we use 26 bi-weekly dissolved $CO_2$ samples collected by @beaulieuControlsGasTransfer2012 at one location in the Ohio River for one calender year from 2008-2009 (Figure S1). Note that this $CO_2$ data is for the Ohio River only but was applied to all rivers (which includes multiple sections of the Ohio River). Therefore, the raw carbon emissions estimates presented in this paper are largely meaningless in the context of actually measured carbon emissions from these rivers. This approach was deemed acceptable for this validation exercise because we are exclusively interested in the relative differences between methods tested and not the raw fluxes themselves.

### 3.2 Section 3 methods
#### 3.2.1 BIKER
BIKER, and Bayesian inference in general, starts from Bayes rule (equation 9), where $\Theta$ is some set of non-remotely-sensible parameters we want to solve for (including $k_{600}$), *x* is the observed data, $f(x|\Theta)$ is the sampling model where data are conditional on the parameters, and $p(\Theta)$ is the joint prior distribution of the parameters. Therefore, we are interested in solving for $p(\Theta|x)$, or the 'posterior' distribution. Note that $p(x)$ is usually computationally intractable to integrate exactly, but Bayesian inference tools require only the proportionality to be specified: $p(\Theta|x) \propto f(x|\Theta)p(x)$. Sampling algorithms are then used to approximate the posterior distribution, as is done in BIKER.

$$p(\Theta|x) = \frac{f(x|\Theta)p(\Theta)}{p(x)} \mathbf{(9)}$$
The heart of BIKER is its reformulation of the $k_{600}$ model (equation 8) as a Bayesian sampling model that is conditional on the non-remotely-sensible parameters (i.e. $f(x|\Theta)$). This is similar to the 'McFLI' ('Mass-Conserved Flow Law Inversion') logic used in some SWOT RSQ algorithms [@gleasonTrackingRiverFlows2017]. To start, we write $k_{600}$ as a function of SWOT-observables $W$ and $S$. This algebra is carried out using equation 8, the fitted value for $\beta_1$ from Figure 3d (`r round(modelsWIDE[modelsWIDE$name == 'reynolds-eD',]$coef,2)`), and Manning's equation for mean flow velocity ($\bar{U}=\frac{1}{n}R_h^{2/3}S^{1/2}$). Following section 2.3, we continue to assume that the channel is hydraulically-wide ($R_h = H =\frac{A}{W}$). To leverage additional SWOT data, the wetted channel area *A* is further split into the the SWOT-unobservable portion $A_0$ and SWOT-observable portion $dA$ following @durandEstimatingReachaveragedDischarge2014 and @hagemannBAMBayesianAMHGManning2017 where $dA_{it} = \sum_{t':W_{t'}\le W_t}{W_{t'} \delta H_{t'}}$ for cross-section *i* and timestep *t*.

All of this algebra simplifies to equation 10. Conveniently, $k_{600}$ as measured by tracer additions to a stream is inherently a reach-scale quantity (in a mass-conserved reach). Therefore, equations 8 and 10 both yield a reach-scale $k_{600}$ (i.e. $k_{600_i}=k_{600}\forall i$). This lowers the number of parameters BIKER must infer and makes the problem much better constrained.

$$\begin{eqnarray} k_{600_t} = 62.82 g^{7/16}S_{it}^{9/16}\frac{1}{n_i}^{1/4}(\frac{A_0_i+dA_{it}}{W_{it}})^{35/48} \end{eqnarray} \mathbf{(10)}$$
Next, equation 10 is written as a Bayesian sampling model, in which all of the SWOT observations are sampled from the unknown model parameters ($A_0_i$, $k_{600_t}$, and $n_i$). This is equation 11 after describing everything as normal distributions of the log-transformed terms. $\sigma_{k_{600}}^2$ refers to the total uncertainty implicit in equation 10. This uncertainty arises from parameter uncertainty in equation 8, Manning's equation, and the rectangular channel assumption.

$$\left[log(62.82) + \frac{7}{16}log(g) + \frac{9}{16}log(S_{i,t}) - \frac{35}{48}log(W_{i,t})\right] \sim normal\left(\left[log(k_{600_t})+\frac{1}{4}log(n_i)-\frac{35}{48}log(A_0_i+dA_{i,t})\right], \sigma^2_{k_{600}}\right) \mathbf{(11)}$$
Equations 9 and 11 also necessitate that we specify prior distributions for the parameters $A_0_i$, $k_{600_t}$, and $n_i$. Prior distributions, described by their hyperparameters, formalize the a priori estimates and uncertainties for the non-remotely-sensed terms. More intuitively, BIKER priors represent our 'prior river knowledge' of what $A_0_i$, $k_{600_t}$, and $n_i$ probably are for some river since they cannot be directly remotely sensed, but educated guesses can be made using the SWOT data available to us. This is equivalent to the 'empirical Bayes approach' to Bayesian inference [cite textbook]. Our goal in prior specification was to rely on absolutely no in situ information such that we could run this method on any river on Earth solely using SWOT observations. In theory, more informed priors via various a priori information about a specific river would improve BIKER performance, but here we chose to test the fully generalized algorithm. Therefore, the validation presented here is a 'worst-case scenario', wherein BIKER performance should improve with better prior information on the river. In that context, we used a variation of the prior specification method developed by @brinkerhoffConstrainingRemoteRiver2020, who developed geomorphic 'river types' with distinct prior hyperparameter sets for $A_0_i$ and $n_i$. These hyperparameters are assigned to a river solely using SWOT data *W* and *S*, therefore meeting our needs for complete global implementability. Hyperparameter assignment for $k_{600_t}$ was developed similarly (all hyperparameter specifications are elaborated on in Texts S3 and S4).

With the sampling model described ($f(x|\Theta)$ = equation 11) and hyperparameters $p(x$) specified (Texts S3 and S4), a joint posterior distribution conditional on the SWOT observations ($p(\Theta|x) \propto f(x|\Theta)p(x)$) is therefore also specified. To approximate this distribution, we use a Markov Chain Monte Carlo (MCMC) algorithm implemented using the Stan probabilistic programming language. Specifically, Stan uses a Hamiltonian Monte Carlo sampler which reduces computation time relative to other sampling algorithms [@hagemannBAMBayesianAMHGManning2017].

#### 3.2.2 BIKER validation
We validate BIKER on `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` SWOT-simulated rivers (section 3.1) using daily observed hydraulics. We also re-validate BIKER on the `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])` rivers with the SWOT error model which corrupts the SWOT measurements (widths, heights, and slopes).

We do not have observed $k_{600_t}$ data for these rivers and, to our knowledge, no field dataset of $k_{600}$ exists in the type of temporal and spatial frequency that SWOT (and therefore the BIKER algorithm) provides. Thus, we take the model outlined in equation 7 and Figure 3d and use that to calculate the observed $k_{600_t}$ that BIKER is validated against (equation 12). Here, reach-averaged flow velocity is calculated via mass conservation as discharge divided by channel area. This directly explores BIKER's ability to infer observed $A_0_i$, $k_{600_t}$, and $n_i$ simultaneously from $W_{i,t}$ and $H_{i,t}$ alone and was deemed acceptable given that the $k_{600}$ model (equation 7) has already been successfully validated in Figure 3d.

$$k_{600_{obs}}=62.82(gS)^{7/16}\bar{U}^{1/4}H^{9/16} \mathbf{(12)}$$
It also means that, for a fair validation scheme, the parameter specification for $\sigma^2_{k_{600}}$ in equation 11 should not include the uncertainty from equation 8. So for this validation only, $\sigma^2_{k_{600}}$ is set to 0.30 (natural-log space). However, if BIKER is run on real SWOT observations after the satellite launches, $\sigma^2_{k_{600}}$ should reflect the total uncertainty, which is specified in Text S4 via Monte Carlo simulations as 1.1.

With the setup described by equations 11 and 12, validation is performed for each river using the BIKER posterior means. These metrics are defined in Table S2 and consist of the following:

- Correlation coefficient *r* to quantify accuracy of BIKER's temporal dynamics
- Root mean square error normalized by the observed mean (NRMSE) and prediction bias normalized by the observed mean (rBIAS) to assess bias
- Kling-Gupta Efficiency (KGE). KGE is frequently used to assess streamflow prediction and simultaneously assesses accuracy in both bias and dynamics. While a value greater than -0.41 means the model outperforms a uniform prediction of the mean [@knobenTechnicalNoteInherent2019], generally KGE scores are interpreted as being meaningful in ungauged settings if > 0.

#### 3.2.3 Carbon efflux validation
It is one thing to accurately model the temporal dynamics of $k_{600}$, but researchers are often most interested in the actual carbon emitted from river to atmosphere. Therefore, we also explore BIKER's ability to reproduce $FCO_2$ (equation 1) and the annual carbon emission rate from these `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers. To do this, we pair the 26 biweekly $CO_2$ and water temperature samples from @beaulieuControlsGasTransfer2012 (section 2, figure S1) with every 14th set of daily SWOT observations (as the $CO_2$ data is bi-weekly). Not all of the SWOT rivers have at least 14 observations and those rivers were removed for this experiment. Similarly, not all have observations for a full year, and when simulation dates are not available they are assumed to start on January 1st. We then calculate $FCO_2$ using equation 1 and assuming atmospheric $CO_{2_{air}}$ is 390 uatm. Equation 13 is used to obtain a temperature and $CO_2$ specific gas exchange velocity from BIKER's output, where the Schmidt number *Sc* was estimated following @raymondScalingGasTransfer2012. We then estimate a yearly average carbon emission rate (via $CO_2$ evasion) by applying each river's mean $FCO_2$ over the river's surface area and then summing all of these emission rates.
$$k_{CO2, temp}=k_{600}*(Sc/600)^{-1/2} \mathbf{(13)}$$
Finally, we also compare BIKER's outputs with established in situ techniques, whose specific details and parameters are provided in Table S3. Streamflow is more readily modeled at the global scale than river channel geometry, and so these in situ models are used to predict $\bar{U}$ and *H* as functions of streamflow using hydraulic geometry (HG). Per equation 2, their outputs are in turn used to estimate *k*. Therefore, they rely on in situ streamflow records or high-quality streamflow routing outputs (unlike BIKER, which only requires a river be SWOT-observable). This allows us to assess whether BIKER's estimates (wholly ungauged) are comparable to gauged methods (all three HG models). Of the three models tested here, 'Brinkerhoff2019' is trained on the dataset described in section 2.1, and two are previously published models [@raymondGlobalCarbonDioxide2013; @raymondScalingGasTransfer2012].

### 3.3 Section 3 results
#### 3.3.1 BIKER
Figure 4 plots all `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` timeseries plots of predicted and observed $k_{600}$, again assuming no SWOT measurement error. Note that the y axis is normalized by maximum observed values to compare across rivers. In general, the temporal dynamics of $k_{600}$ are reproduced quite well by BIKER, with the highs and lows of evasion correctly inferred by BIKER. Notably, there is sometimes positive bias in the estimates (e.g. Seine River). Some rivers are inferred nearly perfectly (e.g. Kanawha, Ohio Section 2, Wabash rivers) while others perform more poorly (e.g. Ash Slough, Ohio), though again much of this error stems from errors in inferring the magnitude of $k_{600}$ rather than its temporal dynamics. For some rivers, (e.g. Mississippi Intermediate), the first timestep is **THIS MIGHT BE DUE TO TO CERTAINTY OF THE PRIOR ETHIER ON K600 OR THE LIKELIHOOD?**

![Figure 4. River timeseries plots of $k_{600}$. Orange is calculated via observed hydraulics, while green is BIKER and uses SWOT measurements as its sole input. The green ribbon indicates the 95% CIs for the BIKER predicted values. Y axis is normalized by maximum observed values to compare visually.](cache/validation/timeseries_noerr.jpg)

We calculate performance metrics following section 3.2.2 and Table S2. These are presented in Figure 5a, which plots the scores for rivers with and without SWOT measurement error (green and purple boxplots, respectively). For the no-error scenario, median river $KGE$ is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$KGE, na.rm=T),2)` and median river *r* is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$r, na.rm=T),2)`. This indicates very strong inference of each river's temporal $k_{600}$ dynamics. These scores are excellent given that absolutely no in situ information is being used to predict $k_{600}$. NRMSE has a median score of `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$NRMSE, na.rm=T),2)`, which is comparable to the better NRMSE scores achieved by recent versions of the SWOT RSQ algorithms [@frassonExploringFactorsControlling2021]. Median rBIAS is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$rBIAS, na.rm=T),2)`, highlighting a large portion of rivers which have a significant positive bias (Figure 4 also confirms this). Taken in aggregate, Figures 4-5 indicate that BIKER is quite good at capturing temporal dynamics in $k_600$, however there is sometimes positive bias in its estimates.

![Figure 5. a) Performance metrics by river. See Table S2 for metric definitions. Dashed lines denote scores of 0, 0.50, and 1. b-c) Empirical cummulative density distributions of the *KGE* (b) and *r* (c) scores for both error and no-error rivers.](cache/validation/validation_by_river.jpg)

Figure 5 also compares BIKER results under a 'no-error' and 'error' scenario: the green and purple respectively in Figure 5a-c, where b-c plot the empirical cummulative density distributions (eCDFs) for *KGE* and *r* scores. There appears to be neglibile differences between results in Figures 5a-c, suggesting that SWOT measurement errors negligibly influence BIKER's performance across all four error metrics (Figure 5a). In fact, for some metrics, the error scenario appears to improve results. For example, median KGE without error is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 0,]$KGE),2)` while with-error median KGE is `r round(median(results_k600_rivs[results_k600_rivs$errFlag == 1,]$KGE),2)`. However, caution should be used here as these purple boxplots are composed of only `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 1,])` of the rivers in the green boxplots and many of the most poorly performing rivers are not in this set. The eCDFs more clearly indicate a marginal difference in performance when measurement errors are used to corrupt the BIKER inputs (with nearly identical performance in the best-performing rivers). Given these results, we deem that SWOT measurement error does not exert a significant influence on BIKER performance and so the results presented for the rest of the manuscript assume no measurement error in order to use all `r nrow(results_k600_rivs[results_k600_rivs$errFlag == 0,])` rivers.

Given the promising results in Figure 5a and 5c, we further explore BIKER's ability to infer temporal trends in $k_{600}$. Figure 6a plots a histogram of the slopes of power-law regressions between BIKER-predicted $k_{600}$ and observed $k_{600}$. A slope of 1 indicates that BIKER correctly infers the daily flucuations in gas exchange (even if there is bias baked into the estimates), while a slope well above or below 1 indicates incorrect inference of the temporal dynamics of $k_{600}$. Figure 6a shows that the majority of rivers' slopes approximate 1 (mean slope: `r round(median(results_dynamics$Slope),2)`), indicating strong inference of temporal gas exchange trends. A handful of rivers to have slopes well above or below 1, though the vast majority are at or just below 1.

![Figure 6: a) Histogram of the slopes of power-law regressions between BIKER estimates and observed $k_{600}$. Slopes equaling 1 indicate correct inference of the temporal trends in daily $k_{600}$ (regardless of bias in the estimates). b) Empirical cummulative density distributions of the coefficient of varation of prior, posterior, and observed $k_{600}$ per river. If BIKER is correctly inferring temporal variation in $k_{600}$, the posterior eCDF will approximate the obersved eCDF (as it does).](cache/validation/validation_temporal.jpg)

Finally, we explore whether BIKER improves upon the prior with respect to temporal variation in $k_{600}$, here defined using the coefficient of variation ($CV=\frac{SD}{mean}$). Figure 6b plots eCDFs of observed, prior, and posterior $k_{600}$ *CV*, strongly showing that BIKER improves upon the prior information available to us about $k_{600}$. Posterior $k_{600}$ *CV* approximates the observed eCDF and sufficiently 'closes the gap' between our prior knowledge on $k_{600}$ temporal variation and the actually observed variation. It must be stressed that this validation was performed using a relatively uninformed prior on $k_{600}$ (Text S3) and that this gap may not be as large in many settings. However, Figure 6b certainly confirms that Bayesian techniques can be used to infer temporal variation in $k_{600}$ when in situ work is not feasible and effectively reconcile any bias between our prior knowledge of $k_{600}$ temporal variation and the observed variation.

#### 3.3.2 Carbon efflux
Finally, we carry these $FCO_2$ calculations all the way to annual carbon emissions rates. It is important to remember that only BIKER is completely globally implementable, while the other three models necessarily rely on having a streamflow record readily available. Therefore, the HG methods reflect their 'best-case scenarios' while BIKER reflects its worst case scenario, where priors are set entirely from SWOT observations and are generally the least informative they will ever be. We also stress again that the raw emissions rates here are largely meaningless as they are calculated from an identical $CO_{2_water}$ timeseries applied to every river. We are principally interested in relative differences between methods employed.

Figures 7 compares the annual carbon emissions rate (via $F_{CO_2}$) from the rivers using BIKER posterior means and the three streamgauge-based HG models. Surprisingly, BIKER outperforms the gauge-based approaches, nearly correctly inferring the annual carbon emissions rate (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_BIKER',]$yearlyCFux, 2)` gG-C/yr for BIKER versus `r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_obs',]$yearlyCFux, 2)` gG-C/yr observed). The three HG models overestimate this emissions rate (`r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2013',]$yearlyCFux, 2)`, `r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_raymond2012',]$yearlyCFux, 2)`, and `r round(results_fco2_bulk[results_fco2_bulk$key == 'FCO2_brinkerhoff2019',]$yearlyCFux, 2)`) for 'Raymond 2013', 'Raymond 2012', and 'Brinkerhoff 2019' respectively. Both 'Brinkerhoff 2019' and 'Raymond 2012' fall within the BIKER CIs. **I need to add CIs for Brink 2019. Can't calc for raymond models as only some of the parameter CIs are reported**. BIKER's realtively stronger performance in FIgure 7 compared to Figures 4-6 is likely due to the temporal averaging performed at each river, which effecively reduces the influence of positive bias sometimes seen in BIKER results.

Thus, despite BIKER using absolutely no streamgauge or other in situ data like the other 3 methods do, it provides a strong upscaling estimate of the bulk carbon efflux across many rivers (Figure 7).  Interestingly, the in situ models represent their best case scenarios (perfect in situ discharge records) while BIKER represents its worst-case scenario (relatively uninformed priors). This means that BIKER's annual carbon emission estimate can only improve.

![Figure 7: Yearly carbon emissions via CO2 evasion across all rivers and accounting for surface area. Completely remotely-sensed methods are colored in red, in situ methods in purple, and the observed in orange.](cache/FCO2/FCO2_models.jpg)

**NOTE: The swot rivers are so long (reach lengths of 100+km sometimes) that our total surface area is actually greater than Brian and I have for the northeast.... and so the total C flux is greater than we model in the northeastern US. We don't actually care about these raw numbers and I mention that earlier in the paper but worth noting**


## 4 Discussion NEEDS UPDATING READ AT OWN RISK!!
### 4.1 Gas exchange in hydraulically-wide rivers
Field studies of gas exchange in wide rivers have suggested that their *k* properties behave differently than in steeper and smaller rivers [@ulsethDistinctAirWater2019; @beaulieuControlsGasTransfer2012; @alinPhysicalControlsCarbon2011; @wangPhysicallyBasedScaling2021]. While much work has focused on the small-stream side of the stream-to-river continuum, comparitvely less work has been done in large systems. Here, we focus on the 'smooth-channel' end of the continuum, using a model for gas exchange that scales *k* by both the turbulent dissipation rate and the Shear Reynold's number specifically adapted for 'hydraulically-wide' rivers. This is empirically validated in Figure 3d. Scaling *k* this way (via a shear Reynold's number) is commonly done to parameterize wave-related gas exchange models in the open ocean [@brumerWaveRelatedReynoldsNumber2017; @zhaoDependenceWhitecapCoverage2001; @zhaoEffectWindWaves2003] and has been occasionally explored in open-channel flows [@moogAirWaterGasTransfer1999; @wangPhysicallyBasedScaling2021]. However to our knowledge, @moogAirWaterGasTransfer1999's specific model has never been empirically validated in rivers. Figure 3d provides this empirical verification. Future tests should be performed to explore the model's feasibility in smaller streams and/or other aquatic environments where turbulence is also generally low. Future tests should also explore other shear Reynold's scaling relations for gas exchange in rivers.

Given the algebraic structure of the various dissipation and gas exchange models tested (Table 1), the performance differences observed in Figure 3 are largely due to the exponents applied to the river hydraulic terms (which are described in the subplot x axis labels). While the use of the form-drag dissipation model includes a mean flow velocity term and improves performance, the primary difference between the respective small-eddy and chainsaw equations is the exponents. Intuitively, this exponent discrepancy indicates that in hydraulically-wide rivers where turbulence is relatively low, large-scale eddies exert a noteworthy influence on surface dissipation rates and that the small-eddy model is not sufficient.

Finally, we are not accounting for gas exchange facilitated by air-side wind, which exerts a significant influence on lake and ocean gas exchange. Similarly, none of the existing hydraulics-driven gas exchange models do either, assuming that the rivers are sheltered enough that wind is of less concern. We suspect that our model will be less representative in extremely wide rivers where wind becomes a driving factor of gas exchange rates [@beaulieuControlsGasTransfer2012]. In that vein, BIKER's outputs can be interpreted as the 'gas exchange velocity in low-wind conditions'. That said, BIKER's flexible implementation is a good start towards eventually coupling hydraulics-driven gas exchange with wind-driven gas exchange. Such a model would likely take a form similar to the conceptual model proposed by @wangPhysicallyBasedScaling2021 that proposes calculating both a wind-driven *k* and a hydraulics-driven *k* and then weighting each term via parameters. In the case of BIKER, this would necessitate additional parameters that would need to be known a priori for specific rivers. This is left to future work.

### 4.2 Towards remote sensing of global spatiotemporal dynamics of *k* in large rivers
To date, the studies exploring the spatiotemporal dynamics of riverine gas exchange have arguably been held back by a lack of data. A few studies have investigated these dynamics, but they have been limited to individual rivers and/or limited field seasons [@hallAirWaterOxygen2012; @sand-jensenCO2DynamicsDanish2012]. For example, @wallinSpatiotemporalVariabilityGas2011 performed a preliminary analysis in northern Sweden relating cross-section specific temporal variability in gas exchange with channel slope, but they were limited to a mean of only 8 measurements per river in a single watershed.

Therefore, estimating *k* from SWOT data is an attractive option, at least for exploring its spatiotemporal dynamics at fine temporal resolution and at the global-scale. Section 5 shows that BIKER successfully infers the temporal dynamics of $k_{600}$ using simulated SWOT data over a wide range of rivers and with implicit measurement errors accounted for (Figures 4-6). This strong result bodes well for BIKER's eventual implementation on real SWOT observations, as does BIKER's improved performance with longer timeseries (Figure 6b). The nominal three-year SWOT campaign will provide hundreds of observations for most rivers, suggesting even better BIKER inversions than those presented here. All of this suggests that near-daily estimation of the spatiotemporal trends in global riverine gas exchange will be possible once SWOT launches.

With that said, Figures 4-7 highlight a substantial range of algorithm performances across rivers. These differences in performance are likely due to the representativeness of the priors used for that river. This all makes sense as Section 2 has effectively reduced $k_{600}$ to a function of hydraulics that are nearly all directly measurable by SWOT. Any resulting bias in BIKER's predictions is therefore attributable to bias in the priors used for the non-remotely sensed terms (equations 10-11). For SWOT discharge algorithms, authors have repeatedly shown that the 'quality' of prior hyperparameters plays a large role in the success of discharge inversions [@frassonExploringFactorsControlling2021; @andreadisConstrainingAssimilationSWOT2020; @brinkerhoffConstrainingRemoteRiver2020; @tuozzoloEstimatingRiverDischarge2019] and our results here further corroborate this finding. It should be stressed that a substantial portion of rivers from [@frassonExploringFactorsControlling2021] are canal-shaped in nature with different hydraulic properties than a natural river channel. Nearly universally, these rivers underperformed (Figure 5), however it is impossible to isolate whether that is due to channel geomorphology or the fact that these canals also usually had short timeseries (around 12 days).

### 4.3 Towards remotely sensing riverine carbon emissions using SWOT
Figure 7 confirms that BIKER is quite successful, without any in situ information aside from a $CO_2$ logger, at predicting both $FCO_2$ (Figure 6a) and 2) the bulk carbon efflux (Figure 7b-7c). This encouraging result has two main implications for future work coupling remote sensing via SWOT with in situ data. First, it confirms that we can couple BIKER with in situ gas concentration loggers to produce $FCO_2$ estimates at novel temporal resolutions in SWOT-observable rivers. High temporal fidelity datasets of dissolved $CO_2$ in SWOT-observable rivers are coming online [e.g. @ahoHighestRatesGross2021] but no such similar datasets for $k_{CO_2}$ at equivalent temporal resolutions exist. For rivers unobservable by SWOT, we further suggest that BIKER could be run at the field scale (rather than via satellite-based altimeters like SWOT) using arrays of in situ pressure transducers to estimate water surface slope following recent similar work for estimating streamflow [@harlanDischargeEstimationDense2021]. Regardless, both approaches would produce $CO_2_{water}$ and $k_{CO_2}$ datasets at equivalent temporal resolution and allow us to directly calculate daily to sub-daily $CO_2$ fluxes from river reaches.

While this is all useful at the reach-scale, Figure 7 directly implies that BIKER will also be useful when coupled with large-scale $CO_{2_water}$ models [e.g. **Liu etal in review**; @saccardiImprovingPredictionsStream2021]. These two models robustly predict dissolved $CO_2$ concentrations using two different approaches: machine learning [**Liu et al in review**] and process-based reactive transport modeling [@saccardiImprovingPredictionsStream2021] but both produce reach-scale $CO_2$ concentrations that are spatially and temporally consistent. Our promising results suggest that BIKER could provide additional (and directly observed) measurements to these models, thereby better informing model results through direct observations. This is likely accomplished via data assimilation which has proven useful for similar problems across geophysical modeling applications [@carrassiDataAssimilationGeosciences2018] and specifically for assimilating remotely sensed information into river routing models [@ishitsukaCombiningOpticalRemote2020].

## 5 Conclusions
Gas exchange from aquatic systems has been studied for nearly a century and dozens of predictive equations have been developed to obtain *k* values from easily measured hydraulic properties rather than via direct measurement. Likewise, equation 3 has been repeatedly verified across many non-fluvial environments. However. despite renewed interest in fluvial gas exchange in the last decade or so, there are considerable uncertainties in how fluvial *k* varies with respect to time. This is generally due to a lack of direct measurements of $k_{600}$. In this paper, we propose that the soon-to-launch SWOT satellite will provide enough hydraulic measurements to analyse the temporal dynamics of $k_{600}$ using SWOT measurements, and therefore allow for a global-scale analysis of spatiotemporal trends in *k* once SWOT launches.

In preparation for SWOT's launch, we develop the BIKER algorithm to infer $k_{600}$ using absolutely no on-the-ground information. Validating on simulated SWOT rivers, we show show strong recovery of rivers' temporal $k_{600}$ dynamics. We also pair BIKER with an in situ $CO_2$ logger and show strong performance in reproducing $CO_2$ evasion fluxes and bulk carbon efflux from the rivers' combined surfaces. These strong results functionally open the door for global-scale, near daily estimates of fluvial gas exchange velocity once SWOT launches in 2022. This unprecedented amount of data should allow for significant insights into the temporal dynamics of fluvial gas exchange in large rivers around the world.

## 6 Acknowledgements
C.B. Brinkerhoff was funded on **FINESST**. The version of BIKER used in this study is available at **citable code here**. BIKER remains in active development and is available at https://github.com/craigbrinkerhoff/BIKER. All code to build and generate results, figures, and the manuscript is available at https://github.com/craigbrinkerhoff/RSK600. We thank Renato Frasson, Michael Durand, Amber Ulseth, and Jake Beaulieu for generously making their data available for this study. We also thank the entire SWOT discharge working group for their decade-plus body of work which inspired this study.

## 7 Apendix A
*Table A1: Variable description and notation for this study* 

|**Notation**|**Description**|**Calculation (if not directly measured)**|**Units**|
|------------|---------------|-------------------------------|---------|
|$A$|Channel cross-sectional area|NA|$[L^2]$|
|$A_0$|Non-SWOT-observable cross-sectional area|NA|$[L^2]$|
|$\alpha$|Statistical parameter for equation 5 scaling relation|NA|$\frac{m^{1/2}s^{3/4}}{dy}$|
|$\alpha_1$|Statistical parameter for equation 6 scaling relation|NA|$\frac{m^{1/2}s^{3/4}}{dy}$|
|*Bulk carbon efflux*|carbon mass transport rate from river to atmosphere|NA|$[\frac{M}{T}]$|
|$\beta$|Statistical parameter for equation 7 scaling relation|NA|$\frac{m^{-1/4}s^{9/8}}{dy}$|
|$\beta_1$|Statistical parameter for equation 8 scaling relation|NA|$\frac{m^{1/2}s^{3/4}}{dy}$|
|$CO_{2_{water}}$|Water-side $CO_2$ concentration|NA|$[L]$|
|$CO_{2_{air}}$|Atmospheric-side $CO_2$ concentration|NA|$[L]$|
|$dA$|change in cross-sectional area|$\delta H_e*W$|$[L]$|
|$D_m$|Molecular diffusion coefficient|NA|$[\frac{L^2}{T}]$|
|$\epsilon$|Dissipation rate of near-surface turbulence|NA|$[\frac{E}{M*T}]$|
|$\epsilon_S$|log-law-of-the-wall model for $\epsilon$|$\frac{U_*^3}{H}$|$[\frac{E}{M*T}]$|
|$\epsilon_D$|Form-drag model for $\epsilon$|$gS\bar{U}$|$[\frac{E}{M*T}]$
|$FCO_2$|$CO_2$ evasion flux from river to atmosphere|NA|$[\frac{M}{L^2T}]$|
|$FCO_{2_{upscaled}}$|Upscaling estimate of the  global $CO_2$ evasion flux from river to atmosphere|NA|$[\frac{M}{L^2T}]$|
|$g$|gravitational acceleration|9.8|$[\frac{L}{T^2}]$|
|$H$|Mean flow depth|$A/W$|$[L]$|
|$H_e$|Water surface elevation|NA|$[L]$|
|$i$|Cross-section discretization within river reach|NA|NA|
|$k$|gas exchange velocity|NA|$[\frac{L}{T}]$|
|$k_{600}$|gas exchange velocity normalized to $Sc=600$|$(\frac{600}{Sc_k})^{-0.5}k$|$[\frac{L}{T}]$|
|$k_{600_{obs}}$|"observed" gas exchange velocity normalized to $Sc=600$|$k_{600_{obs}}=62.82(gS)^{7/16}\bar{U}^{1/4}H^{9/16}$|$[\frac{L}{T}]$|
|$n$|Manning's roughness coefficient|$\frac{R_h^{2/3}S^{1/2}}{\bar{U}}$|$[\frac{T}{L^3}]$|
|$\uprho$|Density of water|NA|$[\frac{M}{L^3}]$|
|$Q$|River discharge|NA|$\frac{L^3}{T}$|
|$R_h$|Hydraulic radius|$\frac{AW}{2H+W}$|$[L]$|
|$S$|River slope|NA|$unitless$|
|$Sc$|Schmidt number|$\frac{v}{D_m}$|NA|
|$\sigma^2_{k_{600}}$|BIKER uncertainty (posterior distribution standard deviation)|NA|$[L/T]$|
|$t$|timestep discretization within river reach|NA|NA|
|$\Theta$|Bayesian parameter set|NA|NA
|$\bar{U}$|Cross-sectional average velocity|$\frac{Q}{A}$|$[\frac{L}{T}]$|
|$U_*$|Shear velocity|$\sqrt{gSR_h}$|$[\frac{L}{T}]$|
|$\mu$|Viscosity|NA|$[P*T]$|
|$v$|kinematic viscosity|$\frac{\mu}{\uprho}$|$[\frac{L^2}{T}]$|
|$W$|Flow width|NA|$[L]$|
|$x$|Bayesian data set|NA|NA|

## References
